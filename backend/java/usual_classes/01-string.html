<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1. 字符串相关的类 | Hedon</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/noteSite/favicon.ico">
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/noteSite/assets/css/0.styles.0f3b0cbd.css" as="style"><link rel="preload" href="/noteSite/assets/js/app.6340ad3c.js" as="script"><link rel="preload" href="/noteSite/assets/js/2.691adf44.js" as="script"><link rel="preload" href="/noteSite/assets/js/68.092dc2f9.js" as="script"><link rel="prefetch" href="/noteSite/assets/js/10.d6d7411b.js"><link rel="prefetch" href="/noteSite/assets/js/100.6bfbbd9f.js"><link rel="prefetch" href="/noteSite/assets/js/101.7ff8652d.js"><link rel="prefetch" href="/noteSite/assets/js/102.fb205867.js"><link rel="prefetch" href="/noteSite/assets/js/103.b9731527.js"><link rel="prefetch" href="/noteSite/assets/js/104.47373027.js"><link rel="prefetch" href="/noteSite/assets/js/105.adf7d971.js"><link rel="prefetch" href="/noteSite/assets/js/106.a41eb2a0.js"><link rel="prefetch" href="/noteSite/assets/js/107.5fbcc801.js"><link rel="prefetch" href="/noteSite/assets/js/108.10d4f4fb.js"><link rel="prefetch" href="/noteSite/assets/js/109.a7f4e7e8.js"><link rel="prefetch" href="/noteSite/assets/js/11.c8c52c63.js"><link rel="prefetch" href="/noteSite/assets/js/110.3a401aaa.js"><link rel="prefetch" href="/noteSite/assets/js/111.6b72b65a.js"><link rel="prefetch" href="/noteSite/assets/js/112.450de1fd.js"><link rel="prefetch" href="/noteSite/assets/js/113.bd864fad.js"><link rel="prefetch" href="/noteSite/assets/js/114.9c3bafb4.js"><link rel="prefetch" href="/noteSite/assets/js/115.492c66ca.js"><link rel="prefetch" href="/noteSite/assets/js/116.27778c0f.js"><link rel="prefetch" href="/noteSite/assets/js/117.026fec87.js"><link rel="prefetch" href="/noteSite/assets/js/118.e4695cba.js"><link rel="prefetch" href="/noteSite/assets/js/119.3349fc75.js"><link rel="prefetch" href="/noteSite/assets/js/12.18d29461.js"><link rel="prefetch" href="/noteSite/assets/js/120.d8b8e4c4.js"><link rel="prefetch" href="/noteSite/assets/js/121.7016cb87.js"><link rel="prefetch" href="/noteSite/assets/js/122.a758324e.js"><link rel="prefetch" href="/noteSite/assets/js/123.82953c9e.js"><link rel="prefetch" href="/noteSite/assets/js/124.48a56efc.js"><link rel="prefetch" href="/noteSite/assets/js/125.e3e4909f.js"><link rel="prefetch" href="/noteSite/assets/js/126.03de7492.js"><link rel="prefetch" href="/noteSite/assets/js/127.8b8cf78c.js"><link rel="prefetch" href="/noteSite/assets/js/128.f5a1fd43.js"><link rel="prefetch" href="/noteSite/assets/js/129.3030bfc9.js"><link rel="prefetch" href="/noteSite/assets/js/13.08211613.js"><link rel="prefetch" href="/noteSite/assets/js/130.1de43470.js"><link rel="prefetch" href="/noteSite/assets/js/131.835f348e.js"><link rel="prefetch" href="/noteSite/assets/js/132.1b1f6c69.js"><link rel="prefetch" href="/noteSite/assets/js/133.9d75be5e.js"><link rel="prefetch" href="/noteSite/assets/js/134.f054a786.js"><link rel="prefetch" href="/noteSite/assets/js/135.85cff704.js"><link rel="prefetch" href="/noteSite/assets/js/136.5bddf5d3.js"><link rel="prefetch" href="/noteSite/assets/js/137.301538c1.js"><link rel="prefetch" href="/noteSite/assets/js/138.70d41df2.js"><link rel="prefetch" href="/noteSite/assets/js/139.f8d512d3.js"><link rel="prefetch" href="/noteSite/assets/js/14.f11602cc.js"><link rel="prefetch" href="/noteSite/assets/js/140.ccb9ee7c.js"><link rel="prefetch" href="/noteSite/assets/js/141.9b6d5c35.js"><link rel="prefetch" href="/noteSite/assets/js/142.375bbe9f.js"><link rel="prefetch" href="/noteSite/assets/js/143.a06cf061.js"><link rel="prefetch" href="/noteSite/assets/js/144.127da4c2.js"><link rel="prefetch" href="/noteSite/assets/js/145.904d3ef1.js"><link rel="prefetch" href="/noteSite/assets/js/146.a7a111c7.js"><link rel="prefetch" href="/noteSite/assets/js/147.9d57db4d.js"><link rel="prefetch" href="/noteSite/assets/js/148.172fb7f7.js"><link rel="prefetch" href="/noteSite/assets/js/149.3d8cf726.js"><link rel="prefetch" href="/noteSite/assets/js/15.80ccce32.js"><link rel="prefetch" href="/noteSite/assets/js/150.7033b32b.js"><link rel="prefetch" href="/noteSite/assets/js/151.0ca859b2.js"><link rel="prefetch" href="/noteSite/assets/js/152.8d029e9d.js"><link rel="prefetch" href="/noteSite/assets/js/153.c7ee05d7.js"><link rel="prefetch" href="/noteSite/assets/js/154.e7e65f08.js"><link rel="prefetch" href="/noteSite/assets/js/155.e78dbc6c.js"><link rel="prefetch" href="/noteSite/assets/js/156.4c3fa35f.js"><link rel="prefetch" href="/noteSite/assets/js/157.7810d519.js"><link rel="prefetch" href="/noteSite/assets/js/158.b5272c42.js"><link rel="prefetch" href="/noteSite/assets/js/159.7ea0f216.js"><link rel="prefetch" href="/noteSite/assets/js/16.7ab703a2.js"><link rel="prefetch" href="/noteSite/assets/js/160.d2d6c859.js"><link rel="prefetch" href="/noteSite/assets/js/161.820227b3.js"><link rel="prefetch" href="/noteSite/assets/js/162.4b13c413.js"><link rel="prefetch" href="/noteSite/assets/js/163.e649c188.js"><link rel="prefetch" href="/noteSite/assets/js/164.1c10a45f.js"><link rel="prefetch" href="/noteSite/assets/js/165.57159bcc.js"><link rel="prefetch" href="/noteSite/assets/js/166.18492830.js"><link rel="prefetch" href="/noteSite/assets/js/167.3a041ed2.js"><link rel="prefetch" href="/noteSite/assets/js/168.94c9a729.js"><link rel="prefetch" href="/noteSite/assets/js/169.7f0a3aea.js"><link rel="prefetch" href="/noteSite/assets/js/17.e1f8763b.js"><link rel="prefetch" href="/noteSite/assets/js/170.62a81a3e.js"><link rel="prefetch" href="/noteSite/assets/js/171.e550ad93.js"><link rel="prefetch" href="/noteSite/assets/js/172.1b491223.js"><link rel="prefetch" href="/noteSite/assets/js/173.95d41049.js"><link rel="prefetch" href="/noteSite/assets/js/174.53907ae3.js"><link rel="prefetch" href="/noteSite/assets/js/175.e4b056c8.js"><link rel="prefetch" href="/noteSite/assets/js/176.3a15587d.js"><link rel="prefetch" href="/noteSite/assets/js/177.42ddde7c.js"><link rel="prefetch" href="/noteSite/assets/js/178.6f51f1e3.js"><link rel="prefetch" href="/noteSite/assets/js/179.9746f370.js"><link rel="prefetch" href="/noteSite/assets/js/18.bf77fb22.js"><link rel="prefetch" href="/noteSite/assets/js/180.009894b9.js"><link rel="prefetch" href="/noteSite/assets/js/181.c9853f57.js"><link rel="prefetch" href="/noteSite/assets/js/182.c4691e95.js"><link rel="prefetch" href="/noteSite/assets/js/183.8658339c.js"><link rel="prefetch" href="/noteSite/assets/js/184.c35951f8.js"><link rel="prefetch" href="/noteSite/assets/js/185.1d421add.js"><link rel="prefetch" href="/noteSite/assets/js/186.10d988de.js"><link rel="prefetch" href="/noteSite/assets/js/187.78d7c473.js"><link rel="prefetch" href="/noteSite/assets/js/188.9ec8db9c.js"><link rel="prefetch" href="/noteSite/assets/js/189.b54eb7c1.js"><link rel="prefetch" href="/noteSite/assets/js/19.a900d7ee.js"><link rel="prefetch" href="/noteSite/assets/js/190.8a2dc4f5.js"><link rel="prefetch" href="/noteSite/assets/js/191.189f0090.js"><link rel="prefetch" href="/noteSite/assets/js/192.260ae309.js"><link rel="prefetch" href="/noteSite/assets/js/193.5c2bce55.js"><link rel="prefetch" href="/noteSite/assets/js/194.af7349ec.js"><link rel="prefetch" href="/noteSite/assets/js/195.fc1263a2.js"><link rel="prefetch" href="/noteSite/assets/js/196.89fd4d1e.js"><link rel="prefetch" href="/noteSite/assets/js/197.e7ec7732.js"><link rel="prefetch" href="/noteSite/assets/js/198.b7369d7d.js"><link rel="prefetch" href="/noteSite/assets/js/199.da40f892.js"><link rel="prefetch" href="/noteSite/assets/js/20.172f3ffd.js"><link rel="prefetch" href="/noteSite/assets/js/200.08b37d44.js"><link rel="prefetch" href="/noteSite/assets/js/201.ba15c6ed.js"><link rel="prefetch" href="/noteSite/assets/js/202.db270a28.js"><link rel="prefetch" href="/noteSite/assets/js/203.fc190649.js"><link rel="prefetch" href="/noteSite/assets/js/204.cc5c736a.js"><link rel="prefetch" href="/noteSite/assets/js/205.a91d248c.js"><link rel="prefetch" href="/noteSite/assets/js/21.1f300626.js"><link rel="prefetch" href="/noteSite/assets/js/22.e83e32c9.js"><link rel="prefetch" href="/noteSite/assets/js/23.047011ef.js"><link rel="prefetch" href="/noteSite/assets/js/24.833a668b.js"><link rel="prefetch" href="/noteSite/assets/js/25.26f30d29.js"><link rel="prefetch" href="/noteSite/assets/js/26.8716506f.js"><link rel="prefetch" href="/noteSite/assets/js/27.8db1b159.js"><link rel="prefetch" href="/noteSite/assets/js/28.a662f3da.js"><link rel="prefetch" href="/noteSite/assets/js/29.9ffd706d.js"><link rel="prefetch" href="/noteSite/assets/js/3.569e38a8.js"><link rel="prefetch" href="/noteSite/assets/js/30.8ab39f0e.js"><link rel="prefetch" href="/noteSite/assets/js/31.9f2ce52a.js"><link rel="prefetch" href="/noteSite/assets/js/32.c7b09847.js"><link rel="prefetch" href="/noteSite/assets/js/33.84858f62.js"><link rel="prefetch" href="/noteSite/assets/js/34.dadeb0fc.js"><link rel="prefetch" href="/noteSite/assets/js/35.8b6e290f.js"><link rel="prefetch" href="/noteSite/assets/js/36.0d1b11ea.js"><link rel="prefetch" href="/noteSite/assets/js/37.a7df96cd.js"><link rel="prefetch" href="/noteSite/assets/js/38.5e902c68.js"><link rel="prefetch" href="/noteSite/assets/js/39.f2dd57da.js"><link rel="prefetch" href="/noteSite/assets/js/4.a61e4cea.js"><link rel="prefetch" href="/noteSite/assets/js/40.ad6358f6.js"><link rel="prefetch" href="/noteSite/assets/js/41.50af7105.js"><link rel="prefetch" href="/noteSite/assets/js/42.b2e49d19.js"><link rel="prefetch" href="/noteSite/assets/js/43.332b7bc8.js"><link rel="prefetch" href="/noteSite/assets/js/44.9007c54f.js"><link rel="prefetch" href="/noteSite/assets/js/45.a3682df9.js"><link rel="prefetch" href="/noteSite/assets/js/46.5d413aef.js"><link rel="prefetch" href="/noteSite/assets/js/47.5bfff6e6.js"><link rel="prefetch" href="/noteSite/assets/js/48.3035b015.js"><link rel="prefetch" href="/noteSite/assets/js/49.cb6a7d2d.js"><link rel="prefetch" href="/noteSite/assets/js/5.2bccd6df.js"><link rel="prefetch" href="/noteSite/assets/js/50.cbc0afdf.js"><link rel="prefetch" href="/noteSite/assets/js/51.1f20694e.js"><link rel="prefetch" href="/noteSite/assets/js/52.55b0f39a.js"><link rel="prefetch" href="/noteSite/assets/js/53.214e234c.js"><link rel="prefetch" href="/noteSite/assets/js/54.ae0d8e55.js"><link rel="prefetch" href="/noteSite/assets/js/55.73ad7f4b.js"><link rel="prefetch" href="/noteSite/assets/js/56.6029e53e.js"><link rel="prefetch" href="/noteSite/assets/js/57.66fda1d2.js"><link rel="prefetch" href="/noteSite/assets/js/58.4d7f55fa.js"><link rel="prefetch" href="/noteSite/assets/js/59.18748e2f.js"><link rel="prefetch" href="/noteSite/assets/js/6.f3d86aa7.js"><link rel="prefetch" href="/noteSite/assets/js/60.9b86f37f.js"><link rel="prefetch" href="/noteSite/assets/js/61.86646e8c.js"><link rel="prefetch" href="/noteSite/assets/js/62.2031a9f6.js"><link rel="prefetch" href="/noteSite/assets/js/63.1d76f60d.js"><link rel="prefetch" href="/noteSite/assets/js/64.b4f28835.js"><link rel="prefetch" href="/noteSite/assets/js/65.6fccd2ec.js"><link rel="prefetch" href="/noteSite/assets/js/66.ad293fae.js"><link rel="prefetch" href="/noteSite/assets/js/67.74b7eb5e.js"><link rel="prefetch" href="/noteSite/assets/js/69.3ee07814.js"><link rel="prefetch" href="/noteSite/assets/js/7.f685cce4.js"><link rel="prefetch" href="/noteSite/assets/js/70.ca0e454e.js"><link rel="prefetch" href="/noteSite/assets/js/71.5ccf6473.js"><link rel="prefetch" href="/noteSite/assets/js/72.1ec0de1b.js"><link rel="prefetch" href="/noteSite/assets/js/73.867866a4.js"><link rel="prefetch" href="/noteSite/assets/js/74.4bc19442.js"><link rel="prefetch" href="/noteSite/assets/js/75.7588f17e.js"><link rel="prefetch" href="/noteSite/assets/js/76.c2d8dffa.js"><link rel="prefetch" href="/noteSite/assets/js/77.42ded4ab.js"><link rel="prefetch" href="/noteSite/assets/js/78.4151aef2.js"><link rel="prefetch" href="/noteSite/assets/js/79.a970c333.js"><link rel="prefetch" href="/noteSite/assets/js/8.8201f3a6.js"><link rel="prefetch" href="/noteSite/assets/js/80.a80feb08.js"><link rel="prefetch" href="/noteSite/assets/js/81.034c7b6c.js"><link rel="prefetch" href="/noteSite/assets/js/82.09f3ef1a.js"><link rel="prefetch" href="/noteSite/assets/js/83.8cb89c24.js"><link rel="prefetch" href="/noteSite/assets/js/84.87941616.js"><link rel="prefetch" href="/noteSite/assets/js/85.5f8fc70c.js"><link rel="prefetch" href="/noteSite/assets/js/86.2b0447f9.js"><link rel="prefetch" href="/noteSite/assets/js/87.ccafe180.js"><link rel="prefetch" href="/noteSite/assets/js/88.e6e57e81.js"><link rel="prefetch" href="/noteSite/assets/js/89.d8920112.js"><link rel="prefetch" href="/noteSite/assets/js/9.68444ec6.js"><link rel="prefetch" href="/noteSite/assets/js/90.58e0ab8a.js"><link rel="prefetch" href="/noteSite/assets/js/91.11ade294.js"><link rel="prefetch" href="/noteSite/assets/js/92.5a9455b0.js"><link rel="prefetch" href="/noteSite/assets/js/93.17d25939.js"><link rel="prefetch" href="/noteSite/assets/js/94.d4208f70.js"><link rel="prefetch" href="/noteSite/assets/js/95.1a48d6d4.js"><link rel="prefetch" href="/noteSite/assets/js/96.2bc4b2d5.js"><link rel="prefetch" href="/noteSite/assets/js/97.b90726c1.js"><link rel="prefetch" href="/noteSite/assets/js/98.20a14228.js"><link rel="prefetch" href="/noteSite/assets/js/99.ccc3742b.js">
    <link rel="stylesheet" href="/noteSite/assets/css/0.styles.0f3b0cbd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/noteSite/" class="home-link router-link-active"><img src="/noteSite/images/hedon.png" alt="Hedon" class="logo"> <span class="site-name can-hide">Hedon</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/noteSite/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/noteSite/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CS Menu" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="CS Menu" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/noteSite/cs/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/os/" class="nav-link">
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/cn/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/component/" class="nav-link">
  计算机组成原理
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Backend Menu" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="Backend Menu" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/noteSite/backend/java/" class="nav-link router-link-active">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/golang/" class="nav-link">
  Golang
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/go-full/" class="nav-link">
  Go 开发工程师
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/middleware/" class="nav-link">
  中间件
</a></li></ul></div></div><div class="nav-item"><a href="/noteSite/frontend/" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/noteSite/linux/" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/noteSite/mac/" class="nav-link">
  Mac
</a></div><div class="nav-item"><a href="/noteSite/leetcode/" class="nav-link">
  Leetcode
</a></div><div class="nav-item"><a href="/noteSite/paper/" class="nav-link">
  Paper
</a></div><div class="nav-item"><a href="https://github.com/hedon954/noteSite" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/noteSite/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/noteSite/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CS Menu" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="CS Menu" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/noteSite/cs/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/os/" class="nav-link">
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/cn/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/component/" class="nav-link">
  计算机组成原理
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Backend Menu" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="Backend Menu" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/noteSite/backend/java/" class="nav-link router-link-active">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/golang/" class="nav-link">
  Golang
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/go-full/" class="nav-link">
  Go 开发工程师
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/middleware/" class="nav-link">
  中间件
</a></li></ul></div></div><div class="nav-item"><a href="/noteSite/frontend/" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/noteSite/linux/" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/noteSite/mac/" class="nav-link">
  Mac
</a></div><div class="nav-item"><a href="/noteSite/leetcode/" class="nav-link">
  Leetcode
</a></div><div class="nav-item"><a href="/noteSite/paper/" class="nav-link">
  Paper
</a></div><div class="nav-item"><a href="https://github.com/hedon954/noteSite" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Java 常用类</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/noteSite/backend/java/usual_classes/01-string.html" aria-current="page" class="active sidebar-link">1. 字符串相关的类</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/noteSite/backend/java/usual_classes/01-string.html#_1-1-string" class="sidebar-link">1.1 String</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/noteSite/backend/java/usual_classes/01-string.html#_1-1-1-string-对象的创建" class="sidebar-link">1.1.1 String 对象的创建</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/java/usual_classes/01-string.html#_1-1-2-问题一-string-str-abc-与-string-str-new-string-abc-的区别" class="sidebar-link">1.1.2 问题一：String str = &quot;abc&quot; 与 String str = new String(&quot;abc&quot;) 的区别</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/java/usual_classes/01-string.html#_1-1-3-问题二-对象中-string-类型的属性是如何存储的" class="sidebar-link">1.1.3 问题二：对象中 String 类型的属性是如何存储的</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/java/usual_classes/01-string.html#_1-1-4-加深对常量池的理解" class="sidebar-link">1.1.4 加深对常量池的理解</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/java/usual_classes/01-string.html#_1-1-5-神奇的-intern-方法" class="sidebar-link">1.1.5 神奇的 intern() 方法</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/java/usual_classes/01-string.html#_1-1-6-string-的传参问题" class="sidebar-link">1.1.6 String 的传参问题</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/java/usual_classes/01-string.html#_1-1-7-常用方法" class="sidebar-link">1.1.7 常用方法</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/java/usual_classes/01-string.html#_1-1-8-数据类型转换" class="sidebar-link">1.1.8  数据类型转换</a></li></ul></li><li class="sidebar-sub-header"><a href="/noteSite/backend/java/usual_classes/01-string.html#_1-2-stringbuffer" class="sidebar-link">1.2 StringBuffer</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/noteSite/backend/java/usual_classes/01-string.html#_1-2-1-简介" class="sidebar-link">1.2.1 简介</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/java/usual_classes/01-string.html#_1-2-2-stringbuffer-对象的创建" class="sidebar-link">1.2.2 StringBuffer 对象的创建</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/java/usual_classes/01-string.html#_1-2-3-常用方法" class="sidebar-link">1.2.3 常用方法</a></li></ul></li><li class="sidebar-sub-header"><a href="/noteSite/backend/java/usual_classes/01-string.html#_1-3-stringbuidler" class="sidebar-link">1.3 StringBuidler</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/java/usual_classes/01-string.html#_1-4-jvm-中字符串常量池存放位置说明" class="sidebar-link">1.4 JVM 中字符串常量池存放位置说明</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/java/usual_classes/01-string.html#△-面试题" class="sidebar-link">△ 面试题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/noteSite/backend/java/usual_classes/01-string.html#_1-string、stringbuffer、stringbuilder-的区别" class="sidebar-link">1. String、StringBuffer、StringBuilder 的区别</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/java/usual_classes/01-string.html#_2-为什么说-stringbuilder-是线程不安全的而-stringbuffer-是线程安全的" class="sidebar-link">2. 为什么说 StringBuilder 是线程不安全的而 StringBuffer 是线程安全的</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/java/usual_classes/01-string.html#_3-下列程序运行结果" class="sidebar-link">3.  下列程序运行结果</a></li></ul></li></ul></li><li><a href="/noteSite/backend/java/usual_classes/02-date7.html" class="sidebar-link">2. JDK 8 之前的日期时间 API</a></li><li><a href="/noteSite/backend/java/usual_classes/03-date8.html" class="sidebar-link">3. JDK 8 中新日期时间 API</a></li><li><a href="/noteSite/backend/java/usual_classes/04-compare.html" class="sidebar-link">4. Java 比较器</a></li><li><a href="/noteSite/backend/java/usual_classes/05-system.html" class="sidebar-link">5. System 类</a></li><li><a href="/noteSite/backend/java/usual_classes/06-math.html" class="sidebar-link">6. Math 类</a></li><li><a href="/noteSite/backend/java/usual_classes/07-bitnum.html" class="sidebar-link">7. BigInteger 与 BigDecimal</a></li><li><a href="/noteSite/backend/java/usual_classes/08-list.html" class="sidebar-link">8. Java 集合</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java 高级特性</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java 多线程</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java 并发工具类</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java 虚拟机</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Spring 5</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SpringBoot 2.x</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SpringCloud Hoxton</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SpringCloud Alibaba</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>MyBatis 3.4.5</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_1-字符串相关的类"><a href="#_1-字符串相关的类" class="header-anchor">#</a> 1. 字符串相关的类</h1> <hr> <h2 id="_1-1-string"><a href="#_1-1-string" class="header-anchor">#</a> 1.1 String</h2> <p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gtvhmwc7fcj61lk09g75u02.jpg" alt="image-20200928143038837"></p> <div class="custom-block tip"><p class="custom-block-title">说明</p> <p><strong>final</strong></p> <p>String 是一个 final 类，代表不可变的字符序列，不可以被继承。</p> <p>字符串是常量，用双引号引起来表示。它们的值在创建之后不能更改。</p> <p><strong>value[]</strong></p> <p>String 对象的字符内容是存储在一个字符数组 value[] 中的。</p> <p>当对字符串重新赋值时，需要重新向指定内存区域赋值，不能使用原有的 value[] 进行赋值（因为数组是不可变长的）。</p> <p>对现有的字符串进行拼接操作时，也需要重新分配空间。</p> <p><strong>Serializable</strong></p> <p>String 是支持序列化的。</p> <p><strong>Comparable</strong></p> <p>String 的可以比较大小的 —— 使用 String.compareTo 方法比较对应字符的大小（ASCII 码顺序）</p> <ul><li>如果字符串相等返回值 0；</li> <li>如果第一个字符和参数的第一个字符不等，结束比较，返回他们之间的差值（ASCII 码值）（负值前字符串的值小于后字符串，正值前字符串大于后字符串）；</li> <li>如果第一个字符和参数的第一个字符相等，则以第二个字符和参数的第二个字符做比较，以此类推，直至比较的字符或被比较的字符有一方全比较完，这时就比较字符的长度；</li></ul></div> <h3 id="_1-1-1-string-对象的创建"><a href="#_1-1-1-string-对象的创建" class="header-anchor">#</a> 1.1.1 String 对象的创建</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//字面上的定义，字符串常量存储在 字符串常量池，目的是共享</span>
<span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//本质上相当于 this.value = new char[0];</span>
<span class="token class-name">String</span> str1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//本质上相当于 this.value = original.value</span>
<span class="token class-name">String</span> str2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token class-name">String</span> original<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//本质上相当于 this.value = Arrays.copyOf(value,value.length)</span>
<span class="token class-name">String</span> str3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//本质上相当于 this.value = Arrays.copyOfRange(value,offset,offset+count)</span>
<span class="token class-name">String</span> str4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> startIndex<span class="token punctuation">,</span> <span class="token keyword">int</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>内存分配情况如图：</p> <img src="https://tva1.sinaimg.cn/large/008i3skNly1gtvhmsow4fj61na0u0go902.jpg" alt="image-20200928144830107" style="zoom:33%;"> <img src="https://tva1.sinaimg.cn/large/008i3skNly1gtvhmwt7j3j61uu0qoadh02.jpg" alt="image-20200928144944629" style="zoom:33%;"> <h3 id="_1-1-2-问题一-string-str-abc-与-string-str-new-string-abc-的区别"><a href="#_1-1-2-问题一-string-str-abc-与-string-str-new-string-abc-的区别" class="header-anchor">#</a> 1.1.2 问题一：String str = &quot;abc&quot; 与 String str = new String(&quot;abc&quot;) 的区别</h3> <img src="https://tva1.sinaimg.cn/large/008i3skNly1gtvhmz3quhj61bc0radiq02.jpg" alt="image-20200928145052133" style="zoom:33%;"> <div class="language-markdown extra-class"><pre class="language-markdown"><code><span class="token title important"><span class="token punctuation">#</span> 回答</span>
① 字符串常量存储为了方便共享，放在字符串常量池中；
② 字符串非常量对象放在堆中（new 出来的东西都放在堆中）;
③ String s = new String(&quot;abc&quot;) 在创建对象的时候，在内存中创建了 2 个对象，一个是堆空间中的 new 结构，另一个是 char[] 对应的常量池中的数据：“abc”。
<span class="token title important"><span class="token punctuation">#</span> 内存分配</span>
String str1 = &quot;javaEE&quot;;
String str2 = &quot;javaEE&quot;;
String str3 = new String(&quot;javaEE&quot;);
String str4 = new String(&quot;javaEE&quot;);
<span class="token title important"><span class="token punctuation">#</span> 结论</span>
str1 == str2    (创建 str2 的时候会去常量池找找看有没有等于 &quot;javaEE&quot; 的字符串，如果有就直接共用了)
str1 != str3
str3 != str4
str1.equals(str3) == true
<span class="token title important"><span class="token punctuation">#</span> 如下图</span>
</code></pre></div><img src="https://tva1.sinaimg.cn/large/008i3skNly1gtvhmumkzmj617i0u0td902.jpg" alt="image-20200928145554865" style="zoom:33%;"> <h3 id="_1-1-3-问题二-对象中-string-类型的属性是如何存储的"><a href="#_1-1-3-问题二-对象中-string-类型的属性是如何存储的" class="header-anchor">#</a> 1.1.3 问题二：对象中 String 类型的属性是如何存储的</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Person</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;hedon&quot;</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Person</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;hedon&quot;</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> p2<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;hedon&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-markdown extra-class"><pre class="language-markdown"><code><span class="token title important"><span class="token punctuation">#</span> 输出结果</span>
true
true
</code></pre></div><img src="https://tva1.sinaimg.cn/large/008i3skNly1gtvhmvxzkcj61bi0qmjuj02.jpg" alt="image-20200928154824937" style="zoom:33%;"> <div class="language-markdown extra-class"><pre class="language-markdown"><code><span class="token title important"><span class="token punctuation">#</span> 图解</span>
上述代码在为 name 属性赋值的时候，采用的是字面量的赋值方式，所以会在常量池中找是否有相同的值，如果有就指向同一个了。
但是如果是用 new String() 来进行赋值，那就会先在堆中开辟一块空间，再指向常量池中的字符串。
</code></pre></div><h3 id="_1-1-4-加深对常量池的理解"><a href="#_1-1-4-加深对常量池的理解" class="header-anchor">#</a> 1.1.4 加深对常量池的理解</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">String</span> s1 <span class="token operator">=</span> <span class="token string">&quot;javaEE&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> s2 <span class="token operator">=</span> <span class="token string">&quot;hadoop&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> s3 <span class="token operator">=</span> <span class="token string">&quot;javaEEhadoop&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> s4 <span class="token operator">=</span> <span class="token string">&quot;javaEE&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;hadoop&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> s5 <span class="token operator">=</span> s1 <span class="token operator">+</span> <span class="token string">&quot;hadoop&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> s6 <span class="token operator">=</span> <span class="token string">&quot;javaEE&quot;</span> <span class="token operator">+</span> s2<span class="token punctuation">;</span>
    <span class="token class-name">String</span> s7 <span class="token operator">=</span> s1 <span class="token operator">+</span> s2<span class="token punctuation">;</span>
    <span class="token keyword">final</span> <span class="token class-name">String</span> s8 <span class="token operator">=</span> <span class="token string">&quot;javaEE&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> s9 <span class="token operator">=</span> s8 <span class="token operator">+</span> <span class="token string">&quot;hadoop&quot;</span><span class="token punctuation">;</span>
    

    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s3 <span class="token operator">==</span> s4<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//true</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s3 <span class="token operator">==</span> s5<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//false</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s3 <span class="token operator">==</span> s6<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//false</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s5 <span class="token operator">==</span> s6<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//false</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s5 <span class="token operator">==</span> s7<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//false</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s6 <span class="token operator">==</span> s7<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//false</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s9 <span class="token operator">==</span> s4<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//true</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-markdown extra-class"><pre class="language-markdown"><code><span class="token title important"><span class="token punctuation">#</span> 结论</span>
如果只是字面量间的操作的话，那就只是在常量池玩；
如果出现了&quot;变量名&quot;，因为变量名其实就是一个引用(地址)，那么这个时候就不只是在常量池玩了，是在堆里面玩了。
<span class="token title important"><span class="token punctuation">#</span> 例外</span>
如果加了 final，那么它就是常量池里面的值。
</code></pre></div><h3 id="_1-1-5-神奇的-intern-方法"><a href="#_1-1-5-神奇的-intern-方法" class="header-anchor">#</a> 1.1.5 神奇的 intern() 方法</h3> <p>如果调用 intern() 方法，那返回值就会放在常量池中。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">String</span> s1 <span class="token operator">=</span> <span class="token string">&quot;javaEE&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> s2 <span class="token operator">=</span> <span class="token string">&quot;hadoop&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> s3 <span class="token operator">=</span> <span class="token string">&quot;javaEEhadoop&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> s4 <span class="token operator">=</span> <span class="token string">&quot;javaEE&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;hadoop&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> s5 <span class="token operator">=</span> s1 <span class="token operator">+</span> <span class="token string">&quot;hadoop&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> s6 <span class="token operator">=</span> <span class="token string">&quot;javaEE&quot;</span> <span class="token operator">+</span> s2<span class="token punctuation">;</span>
    <span class="token class-name">String</span> s7 <span class="token operator">=</span> s1 <span class="token operator">+</span> s2<span class="token punctuation">;</span>
    <span class="token class-name">String</span> s8 <span class="token operator">=</span> s7<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s8 <span class="token operator">==</span> s3<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//true</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s8 <span class="token operator">==</span> s7<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//false</span>
<span class="token punctuation">}</span>
</code></pre></div><p>再看 intern() 源码：</p> <img src="https://tva1.sinaimg.cn/large/008i3skNly1gtvhmypjulj615e05et9h02.jpg" alt="image-20200928162328967" style="zoom:50%;"> <div class="language-markdown extra-class"><pre class="language-markdown"><code><span class="token title important"><span class="token punctuation">#</span> 源码解释</span>
从上述源码的 @return 的解释就可以看出返回的值是放在常量池的了（pool）；

<span class="token title important"><span class="token punctuation">#</span> native 关键字</span>
笔者在此之前从未见过 native 关键字，这次在这里瞅到，特地查了一下，简单来说如下：
① native 主要用在方法上；
② 一个 native 方法就是一个 Java 调用非 Java 代码的接口。一个 native 方法是指该方法的实现由非 Java 语言实现，比如用 C 或 C++ 实现；
③ 在定义一个 native 方法时，并不提供实现体（比较像定义一个 Java Interface），因为其实现体是由非 Java 语言在外面实现的；
④ Java 无法对操作系统底层进行操作，但是可以通过 JNI(java native interface) 调用其他语言来实现底层的访问；
<span class="token title important"><span class="token punctuation">#</span> 参考</span>
https://www.jianshu.com/p/429dc9aa2ce4
https://www.cnblogs.com/KingIceMou/p/7239668.html
</code></pre></div><h3 id="_1-1-6-string-的传参问题"><a href="#_1-1-6-string-的传参问题" class="header-anchor">#</a> 1.1.6 String 的传参问题</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StringClass</span> <span class="token punctuation">{</span>

    <span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;java&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ch <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'t'</span><span class="token punctuation">,</span><span class="token string">'e'</span><span class="token punctuation">,</span><span class="token string">'s'</span><span class="token punctuation">,</span><span class="token string">'t'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">change</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ch<span class="token punctuation">)</span><span class="token punctuation">{</span>
        str <span class="token operator">=</span> <span class="token string">&quot;test ok&quot;</span><span class="token punctuation">;</span>
        ch<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'b'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">change1</span><span class="token punctuation">(</span><span class="token class-name">StringClass</span> stringClass<span class="token punctuation">)</span><span class="token punctuation">{</span>
        stringClass<span class="token punctuation">.</span>str <span class="token operator">=</span> <span class="token string">&quot;test ok&quot;</span><span class="token punctuation">;</span>
        stringClass<span class="token punctuation">.</span>ch<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'c'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">StringClass</span> stringClass <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
        stringClass<span class="token punctuation">.</span><span class="token function">change</span><span class="token punctuation">(</span>stringClass<span class="token punctuation">.</span>str<span class="token punctuation">,</span>stringClass<span class="token punctuation">.</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//String(基本数据类型且不可变) 在传参的时候传的是 str 的值, 方法中只是赋值给了 str 的拷贝,不会修改 str 本身</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>stringClass<span class="token punctuation">.</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//java</span>
        <span class="token comment">//char[0] 表示的是一个地址，修改的时候是修改地址指向的值，所以会变 </span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>stringClass<span class="token punctuation">.</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//best</span>

        <span class="token comment">//stringClass(引用数据类型) 传的是引用, 会修改真正的值</span>
        stringClass<span class="token punctuation">.</span><span class="token function">change1</span><span class="token punctuation">(</span>stringClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>stringClass<span class="token punctuation">.</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//test ok</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>stringClass<span class="token punctuation">.</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//cest</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_1-1-7-常用方法"><a href="#_1-1-7-常用方法" class="header-anchor">#</a> 1.1.7 常用方法</h3> <div class="language-markdown extra-class"><pre class="language-markdown"><code><span class="token title important"><span class="token punctuation">#</span> int length()</span>
返回字符串的长度: return value.length
<span class="token title important"><span class="token punctuation">#</span> char charAt(int index)</span>
返回某索引处的字符return value[index]
<span class="token title important"><span class="token punctuation">#</span> boolean isEmpty()</span>
判断是否是空字符串:return value.length == 0
<span class="token title important"><span class="token punctuation">#</span> String toLowerCase()</span>
使用默认语言环境，返回 String 中的所有字符转换为小写的字符串，原字符串不变
<span class="token title important"><span class="token punctuation">#</span> String toUpperCase()</span>
使用默认语言环境，返回 String 中的所有字符转换为大写的字符串，原字符串不变
<span class="token title important"><span class="token punctuation">#</span> String trim()</span>
返回字符串的副本，忽略前导空白和尾部空白，原字符串不变

<span class="token title important"><span class="token punctuation">#</span> boolean equals(Object obj)</span>
比较字符串的内容是否相同
<span class="token title important"><span class="token punctuation">#</span> boolean equalsIgnoreCase(String anotherString)</span>
与equals方法类似，忽略大小写
<span class="token title important"><span class="token punctuation">#</span> String concat(String str)</span>
将指定字符串连接到此字符串的结尾。 等价于用“+”
<span class="token title important"><span class="token punctuation">#</span> int compareTo(String anotherString)</span>
比较两个字符串的大小

<span class="token title important"><span class="token punctuation">#</span> String substring(int beginIndex)</span>
返回一个新的字符串，它是此字符串的从 beginIndex 开始截取到最后的一个子字符串。
<span class="token title important"><span class="token punctuation">#</span> String substring(int beginIndex, int endIndex) </span>
返回一个新字符串，它是此字符串从 beginIndex 开始截取到 endIndex (不包含)的一个子字符串

<span class="token title important"><span class="token punctuation">#</span> boolean endsWith(String suffix)</span>
测试此字符串是否以指定的后缀结束
<span class="token title important"><span class="token punctuation">#</span> boolean startsWith(String prefix)</span>
测试此字符串是否以指定的前缀开始
<span class="token title important"><span class="token punctuation">#</span> boolean startsWith(String prefix, int toffset)</span>
测试此字符串从指定索引开始的子字符串是否以指定前缀开始
<span class="token title important"><span class="token punctuation">#</span> boolean contains(CharSequence s)</span>
当且仅当此字符串包含指定的 char 值序列 时，返回 true

<span class="token title important"><span class="token punctuation">#</span> int indexOf(String str)</span>
返回指定子字符串在此字符串中第一次出现处的索引
<span class="token title important"><span class="token punctuation">#</span> int indexOf(String str, int fromIndex)</span>
返回指定子字符串在此字符串中第一次出现处的索引，从指定的索引开始
<span class="token title important"><span class="token punctuation">#</span> int lastIndexOf(String str)</span>
返回指定子字符串在此字符串中最右边出现处的索引
<span class="token title important"><span class="token punctuation">#</span> int lastIndexOf(String str, int fromIndex)</span>
返回指定子字符串在此字符串中最后一次出现处的索引，从指定的索引开始反向搜索
<span class="token code keyword">`注:indexOf和lastIndexOf方法如果未找到都是返回-1`</span>

<span class="token title important"><span class="token punctuation">#</span> String replace(char oldChar, char newChar)</span>
返回一个新的字符串，它是 通过用 newChar 替换此字符串中出现的所有 oldChar 得到的
<span class="token title important"><span class="token punctuation">#</span> String replace(CharSequence target, CharSequence replacement)</span>
使用指定的字面值替换序列替换此字符串所有匹配字面值目标序列的子字符串
<span class="token title important"><span class="token punctuation">#</span> String replaceAll(String regex, String replacement) </span>
使用给定的 replacement 替换此字符串所有匹配给定的正则表达式的子字符串
<span class="token title important"><span class="token punctuation">#</span> String replaceFirst(String regex, String replacement) </span>
使用给定的 replacement 替换此字符串匹配给定的正则表达式的第一个子字符串

<span class="token title important"><span class="token punctuation">#</span> boolean matches(String regex)</span>
告知此字符串是否匹配给定的正则表达式

<span class="token title important"><span class="token punctuation">#</span> String[] split(String regex)</span>
根据给定正则表达式的匹配拆分此字符串
<span class="token title important"><span class="token punctuation">#</span> String[] split(String regex, int limit)</span>
根据匹配给定的正则表达式来拆分此字符串，最多不超过 limit 个，如果超过了，剩下的全部都放到最后一个元素中
</code></pre></div><h3 id="_1-1-8-数据类型转换"><a href="#_1-1-8-数据类型转换" class="header-anchor">#</a> 1.1.8  数据类型转换</h3> <h5 id="string-数字"><a href="#string-数字" class="header-anchor">#</a> String -&gt; 数字</h5> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token string">&quot;134&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> d <span class="token operator">=</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">parseDouble</span><span class="token punctuation">(</span><span class="token string">&quot;134.5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">float</span> f <span class="token operator">=</span> <span class="token class-name">Float</span><span class="token punctuation">.</span><span class="token function">parseFloat</span><span class="token punctuation">(</span><span class="token string">&quot;134.5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">long</span> l <span class="token operator">=</span> <span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">parseLong</span><span class="token punctuation">(</span><span class="token string">&quot;12345&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="数字-string"><a href="#数字-string" class="header-anchor">#</a> 数字-&gt; String</h5> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> a <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> s1 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">1.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> s2 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//s2=&quot;false&quot;</span>
<span class="token class-name">String</span> s3 <span class="token operator">=</span> <span class="token string">&quot;&quot;</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="字符数组-字符串"><a href="#字符数组-字符串" class="header-anchor">#</a> 字符数组 -&gt; 字符串</h5> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="字符串-字符数组"><a href="#字符串-字符数组" class="header-anchor">#</a> 字符串 -&gt; 字符数组</h5> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//public char[] toCharArray()</span>
<span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//public void getChars(int srcBegin, int srcEnd, char[] dst,int dstBegin)</span>
<span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token string">&quot;hedon&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> c1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//参数1：从 s 的第几位开始取（包含）</span>
<span class="token comment">//参数2：到 s 的第几位停止取（不包含）</span>
<span class="token comment">//参数3：取出来的字符放到哪个字符数组中</span>
<span class="token comment">//参数4：从字符数组的第几个位置开始放从 s 取出来的字符</span>
s<span class="token punctuation">.</span><span class="token function">getChars</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>c1<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="字节数组-字符串"><a href="#字节数组-字符串" class="header-anchor">#</a> 字节数组 -&gt; 字符串</h5> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x44</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> b<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//17   34   51   68</span>
<span class="token punctuation">}</span>

<span class="token comment">//通过使用平台的默认字符集解码指定的 byte 数组，构造一个新的 String</span>
<span class="token class-name">String</span> s1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// &quot;3D</span>

<span class="token comment">//用指定的字节数组的一部分， 即从数组起始位置offset开始取length个字节构造一个字符串对象</span>
<span class="token class-name">String</span> s2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//&quot;3</span>
</code></pre></div><h5 id="字符串-字符数组-2"><a href="#字符串-字符数组-2" class="header-anchor">#</a> 字符串 -&gt; 字符数组</h5> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token string">&quot;hedon&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//使用平台的默认字符集将此 String 编码为 byte 序列，并将结果存储到一个新的 byte 数组中</span>
<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b1 <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> b1<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>b1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//-128~127  =&gt; 104 101 100 111 110</span>
<span class="token punctuation">}</span>

<span class="token class-name">String</span> s2 <span class="token operator">=</span> <span class="token string">&quot;哈哈哈哈&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//使用指定的字符集将 此 String 编码到 byte 序列，并将结果存储到新的 byte 数组</span>
<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b2 <span class="token operator">=</span> s2<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>b2<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//-128~127  =&gt;  12</span>

<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b3 <span class="token operator">=</span> s2<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;ISO8859-1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//乱码，表示不了中文</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>b3<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// [B@3581c5f3</span>
</code></pre></div><h2 id="_1-2-stringbuffer"><a href="#_1-2-stringbuffer" class="header-anchor">#</a> 1.2 StringBuffer</h2> <h3 id="_1-2-1-简介"><a href="#_1-2-1-简介" class="header-anchor">#</a> 1.2.1 简介</h3> <ul><li><p>java.lang.StringBuffer 代表可变的字符序列，在 JDK1.0 中声明，它可以对字符串内容进行增删，此时不会产生新的对象;</p> <p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gtvhmzimraj61o2092q3v02.jpg" alt="image-20200930085630846"></p></li> <li><p>很多方法与 String 相同;</p></li> <li><p><strong>作为参数传递时，方法内部可以改变值</strong>;</p></li></ul> <img src="https://tva1.sinaimg.cn/large/008i3skNly1gtvhmtifm5j617c0dg0ue02.jpg" alt="image-20200930085559408" style="zoom:50%;"> <h3 id="_1-2-2-stringbuffer-对象的创建"><a href="#_1-2-2-stringbuffer-对象的创建" class="header-anchor">#</a> 1.2.2 StringBuffer 对象的创建</h3> <p>StringBuffer 类不同于 String，其对象必须使用构造器生成。有三个构造器：</p> <ul><li><p>StringBuffer()：初始容量为 16 的字符串缓冲区</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>StringBuffer(int capacity)：构造指定容量的字符串缓冲区</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token keyword">int</span> capacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>StringBuffer(String str)：将内容初始化为指定字符串内容，容量为 str.length+16</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">append</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">StringBuffer</span> stringBuffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token string">&quot;hedon&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> capacity <span class="token operator">=</span> stringBuffer<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>capacity<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//21</span>
<span class="token keyword">int</span> length <span class="token operator">=</span> stringBuffer<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//5</span>
</code></pre></div></li></ul> <h3 id="_1-2-3-常用方法"><a href="#_1-2-3-常用方法" class="header-anchor">#</a> 1.2.3 常用方法</h3> <div class="language-markdown extra-class"><pre class="language-markdown"><code><span class="token title important"><span class="token punctuation">#</span> StringBuffer append(xxx)</span>
提供了很多的append()方法，用于进行字符串拼接 
<span class="token title important"><span class="token punctuation">#</span> StringBuffer delete(int start,int end)</span>
删除指定位置的内容
<span class="token title important"><span class="token punctuation">#</span> StringBuffer replace(int start, int end, String str)</span>
把[start,end)位置替换为str 
<span class="token title important"><span class="token punctuation">#</span> StringBuffer insert(int offset, xxx)</span>
在指定位置插入xxx
<span class="token title important"><span class="token punctuation">#</span> StringBuffer reverse() </span>
把当前字符序列逆转

<span class="token title important"><span class="token punctuation">#</span> public int indexOf(String str)</span>
返回指定子字符串首次出现在该字符串中的索引
<span class="token title important"><span class="token punctuation">#</span> public String substring(int start,int end) </span>
返回 [start,end) 子串
<span class="token title important"><span class="token punctuation">#</span> public char charAt(int n )</span>
在指定的索引处按此序列返回char值
<span class="token title important"><span class="token punctuation">#</span> public void setCharAt(int n ,char ch)</span>
将指定位置的字符替换为 ch

<span class="token title important"><span class="token punctuation">#</span> public int capaticy()</span>
返回容量
<span class="token title important"><span class="token punctuation">#</span> public int length()</span>
返回有效字符的长度
</code></pre></div><h2 id="_1-3-stringbuidler"><a href="#_1-3-stringbuidler" class="header-anchor">#</a> 1.3 StringBuidler</h2> <p>StringBuilder 和 StringBuffer 非常类似，均代表可变的字符序列。而且提供相关功能的方法也一样</p> <h2 id="_1-4-jvm-中字符串常量池存放位置说明"><a href="#_1-4-jvm-中字符串常量池存放位置说明" class="header-anchor">#</a> 1.4 JVM 中字符串常量池存放位置说明</h2> <div class="language-markdown extra-class"><pre class="language-markdown"><code><span class="token title important"><span class="token punctuation">#</span> 1.6</span>
字符串常量池存放在方法区（永久区)；
<span class="token title important"><span class="token punctuation">#</span> 1.7</span>
字符串常量池存储在堆空间；
<span class="token title important"><span class="token punctuation">#</span> 1.8</span>
字符串常量池存储在方法区（元空间）；
</code></pre></div><h2 id="△-面试题"><a href="#△-面试题" class="header-anchor">#</a> △ 面试题</h2> <h3 id="_1-string、stringbuffer、stringbuilder-的区别"><a href="#_1-string、stringbuffer、stringbuilder-的区别" class="header-anchor">#</a> 1. String、StringBuffer、StringBuilder 的区别</h3> <div class="language-markdown extra-class"><pre class="language-markdown"><code><span class="token title important"><span class="token punctuation">#</span> 可变与否</span>
String 为不可变字符序列；StringBuffer 和 StringBuilder 均为可变字符序列；
</code></pre></div><div class="language-markdown extra-class"><pre class="language-markdown"><code><span class="token title important"><span class="token punctuation">#</span> 拼接效率</span>
StringBuilder &gt; StringBuffer &gt; String
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token class-name">String</span> string <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token punctuation">;</span>
    <span class="token class-name">StringBuffer</span> stringBuffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">StringBuilder</span> stringBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">long</span> startTime1 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">100000</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        string <span class="token operator">=</span>string<span class="token operator">+</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">long</span> endTime1<span class="token operator">=</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;使用String实现循环，程序运行时间为：&quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>endTime1<span class="token operator">-</span>startTime1<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;毫秒&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//17662</span>

    <span class="token keyword">long</span> startTime2 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">100000</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        stringBuffer <span class="token operator">=</span>stringBuffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">long</span> endTime2<span class="token operator">=</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;使用StringBuffer实现循环，程序运行时间为：&quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>endTime2<span class="token operator">-</span>startTime2<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;毫秒&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//5</span>

    <span class="token keyword">long</span> startTime3 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">100000</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        stringBuilder <span class="token operator">=</span>stringBuilder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">long</span> endTime3<span class="token operator">=</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;使用stringBuilder实现循环，程序运行时间为：&quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>endTime3<span class="token operator">-</span>startTime2<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;毫秒&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//4</span>

<span class="token punctuation">}</span>
</code></pre></div><div class="language-markdown extra-class"><pre class="language-markdown"><code><span class="token title important"><span class="token punctuation">#</span> 线程安全是否</span>
String 线程安全（所有不可变类都是线程安全的）；
StringBuffer 线程安全；
StringBuilder 线程不安全。
</code></pre></div><div class="language-markdown extra-class"><pre class="language-markdown"><code><span class="token title important"><span class="token punctuation">#</span> 传参问题</span>
作为参数传递的话，方法内部 String 不会改变其值，StringBuffer 和 StringBuilder 会改变其值。
</code></pre></div><h3 id="_2-为什么说-stringbuilder-是线程不安全的而-stringbuffer-是线程安全的"><a href="#_2-为什么说-stringbuilder-是线程不安全的而-stringbuffer-是线程安全的" class="header-anchor">#</a> 2. 为什么说 StringBuilder 是线程不安全的而 StringBuffer 是线程安全的</h3> <blockquote><p>参考：https://blog.csdn.net/u010982507/article/details/102381834</p> <p>PS：上述参考的博主写的非常好，但是笔者在分析数组越界问题上与其有些许不同的见解，还请批评指导。</p></blockquote> <h4 id="stringbuilder"><a href="#stringbuilder" class="header-anchor">#</a> StringBuilder</h4> <ul><li><p>测试 StringBuilder</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	
    <span class="token class-name">StringBuilder</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  	<span class="token comment">//创建10个线程</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              	<span class="token comment">//每个线程循环1000次</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
		<span class="token comment">//按道理10*1000=10000</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;长度本来应该是10000的，现在是：&quot;</span><span class="token operator">+</span>sb<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>输出</p> <p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gtvhmy8oxxj61ku0d2whz02.jpg" alt="image-20200930092622958"></p></li></ul> <h5 id="问题1-为什么长度才-5387"><a href="#问题1-为什么长度才-5387" class="header-anchor">#</a> 问题1：为什么长度才 5387？</h5> <p>我们先来看 StringBuilder 的 append() 方法的源码：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">StringBuilder</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>显然它调用了父类的 append() 方法，我们再来看看其父类的 append() 方法：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">AbstractStringBuilder</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token function">appendNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> len <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span>count <span class="token operator">+</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    str<span class="token punctuation">.</span><span class="token function">getChars</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">,</span> value<span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
    count <span class="token operator">+=</span> len<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>它在扩容的时候，没有引入 synchronized 关键字，并且执行了一条非常危险的语句 <code>count += len</code>，这条一句实际上是 <code>count=count+len</code>，它不是原子性的。**所以当多个线程恰好同时执行该语句的话，那就会导致“实际 + 的次数少于应该 + 的次数”，**从而导致最后的 length &lt; 10000。</p> <h5 id="问题2-为什么会报-arrayindexoutofboundsexception"><a href="#问题2-为什么会报-arrayindexoutofboundsexception" class="header-anchor">#</a> 问题2：为什么会报 ArrayIndexOutOfBoundsException？</h5> <p>这是一个数组越界的问题，所以出现问题一定是在某次读取字符数组的时候，出现了问题。所以它会在哪里读字符数组呢？这里有一条语句 <code>str.getChars(0, len, value, count)</code>，我们来查查 JDK 文档看看对这个方法的说明：</p> <p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gtvhmuzcp1j61no0u0tdv02.jpg" alt="image-20200930094137778"></p> <p>也就是说这个方法会对 value 从 value[count] 开始插入 len 个来自 str 的字符，这里的 <strong>count 是指 StringBuilder 中有效的字符数</strong>。那么问题就来了，<strong>如果在插入 len 个字符的时候，超过 value[] 的容量呢？</strong> 比如 value 的长度为10，然后我们从 value[6] 开始插入数据，但是 len =10，那么在插入后面的数据肯定会发生数据越界问题，比如我们企图插入 value[12]，就发生了越界！</p> <p>回到 append() 方法，这是一个拼接字符串的方法，那么就涉及到 StringBuilder 的扩容问题了。append() 方法中的 <code>ensureCapacityInternal(count + len)</code> 语句就是扩容语句，我们再来看看 <code>ensureCapacityInternal()</code> 方法：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span><span class="token keyword">int</span> minimumCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// overflow-conscious code</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>minimumCapacity <span class="token operator">-</span> value<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        value <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span>
                <span class="token function">newCapacity</span><span class="token punctuation">(</span>minimumCapacity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>它会先尝试看看原来的 value[] 能否放下新的字符串，如果放得下就轻松了，放不下的话就调用了 <code>newCapacity()</code> 方法进行扩容：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">newCapacity</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// overflow-conscious code</span>
    <span class="token keyword">int</span> newCapacity <span class="token operator">=</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span>length <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>newCapacity <span class="token operator">-</span> minCapacity <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        newCapacity <span class="token operator">=</span> minCapacity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>newCapacity <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> MAX_ARRAY_SIZE <span class="token operator">-</span> newCapacity <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token operator">?</span> <span class="token function">hugeCapacity</span><span class="token punctuation">(</span>minCapacity<span class="token punctuation">)</span>
        <span class="token operator">:</span> newCapacity<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>扩容的时候将 value 的长度乘以2并加上2，然后再将变成后的 value[] 复制给原 value[]，<strong>这里的 value[] 和 count 都是全局变量</strong>。</p> <p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gtvhmx8zzfj61mq0dmmz002.jpg" alt="image-20200930102308538"></p> <p>那么问题就来了，假如现在有2个线程同时执行了 append() 方法中的 <code>ensureCapacityInternal(count + len)</code> 语句，第1个线程不需要扩容的（假设 count=100，capacity=150，len1=45），所以它准备继续执行 <code>str.getChars(0, len, value, count)</code> 方法。这个时候第2个线程也来执行 <code>ensureCapacityInternal(count + len)</code> 语句（这个时候count=100，capacity=150，len2=160），并且它认为需要扩容，然后调用了 <code>newCapacity()</code>方法进行扩容使得 capacity 变成了 150*2+2 = 302 ，然后第2个线程完成了 <code>count += len</code>，使得 count = 260。==关键来了！==这个时候（count=260，capacity=302，len1=45）第1个线程要执行 <code>str.getChars(0, len, value, count)</code> 方法，这个时候就出问题了，value[] 的容量只是302，而这个时候count已经变成260了，我们需要插入45个长度的字符，所以这个时候 302&lt;260+50，也就是说我们会访问到 value[302]（数组从0开始），这就发生了越界啦！</p> <p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gtvhn00jccj60s40fm40702.jpg" alt="image-20200930114240686"></p> <blockquote><p>此处如有错误（基于 JDK8.0），请批评指出！</p></blockquote> <h4 id="stringbuffer"><a href="#stringbuffer" class="header-anchor">#</a> StringBuffer</h4> <ul><li><p>测试 StringBuffer</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token class-name">StringBuffer</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//生成10个线程</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              	<span class="token comment">//每个线程执行1000次</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//让上面执行完</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  	<span class="token comment">//按道理应该 10*1000=10000</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;本来长度应该是10000，现在是：&quot;</span><span class="token operator">+</span>sb<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>结果</p> <p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gtvhmu2nlcj619o06i0tb02.jpg" alt="image-20200930101852653"></p></li></ul> <p>没有一点问题，我们来看看 StringBuffer 的扩容机制:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token class-name">StringBuffer</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    toStringCache <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>可以看出 SpringBuffer 的 append() 方法加了 <code>synchronized</code> 锁，保证的线程的安全（这也是 StringBuffer 效率比 StringBuilder 要低的原因）。</p> <hr> <h3 id="_3-下列程序运行结果"><a href="#_3-下列程序运行结果" class="header-anchor">#</a> 3.  下列程序运行结果</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testStringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token class-name">StringBuffer</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sb<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">//4</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sb<span class="token punctuation">)</span><span class="token punctuation">;</span>					<span class="token comment">//&quot;null&quot;</span>
  <span class="token class-name">StringBuffer</span> sb1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sb1<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//空指针异常</span>
<span class="token punctuation">}</span>
</code></pre></div><p>看 append() 源码：</p> <p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gtvhmvevtgj60n306ywf302.jpg" alt="image-20201018164243639"></p> <p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gtvhmxq3g3j60h107njrx02.jpg" alt="image-20201018164306462"></p> <p>看 StringBuffer(String str) 源码：</p> <p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gtvhn0hj4pj60hj04faa702.jpg" alt="image-20201018164413562"></p> <!----></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">9/8/2021, 4:11:30 PM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/noteSite/backend/java/usual_classes/02-date7.html">
        2. JDK 8 之前的日期时间 API
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/noteSite/assets/js/app.6340ad3c.js" defer></script><script src="/noteSite/assets/js/2.691adf44.js" defer></script><script src="/noteSite/assets/js/68.092dc2f9.js" defer></script>
  </body>
</html>
