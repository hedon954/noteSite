<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>三、MongoDB CRUD | Hedon</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/noteSite/favicon.ico">
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/noteSite/assets/css/0.styles.0f3b0cbd.css" as="style"><link rel="preload" href="/noteSite/assets/js/app.15b6de7e.js" as="script"><link rel="preload" href="/noteSite/assets/js/2.6ff1f0ac.js" as="script"><link rel="preload" href="/noteSite/assets/js/101.01c2d0a1.js" as="script"><link rel="prefetch" href="/noteSite/assets/js/10.75282223.js"><link rel="prefetch" href="/noteSite/assets/js/100.fa2c2384.js"><link rel="prefetch" href="/noteSite/assets/js/102.5fbda5b9.js"><link rel="prefetch" href="/noteSite/assets/js/103.3f7380a1.js"><link rel="prefetch" href="/noteSite/assets/js/104.a09deffa.js"><link rel="prefetch" href="/noteSite/assets/js/105.7bd15c0c.js"><link rel="prefetch" href="/noteSite/assets/js/106.038bcb55.js"><link rel="prefetch" href="/noteSite/assets/js/107.44add0a9.js"><link rel="prefetch" href="/noteSite/assets/js/108.b9449ed1.js"><link rel="prefetch" href="/noteSite/assets/js/109.e0380b9e.js"><link rel="prefetch" href="/noteSite/assets/js/11.0b552745.js"><link rel="prefetch" href="/noteSite/assets/js/110.a5dabe68.js"><link rel="prefetch" href="/noteSite/assets/js/111.26c3ec26.js"><link rel="prefetch" href="/noteSite/assets/js/112.5f7a1999.js"><link rel="prefetch" href="/noteSite/assets/js/113.754975cc.js"><link rel="prefetch" href="/noteSite/assets/js/114.72c208d8.js"><link rel="prefetch" href="/noteSite/assets/js/115.166d92cb.js"><link rel="prefetch" href="/noteSite/assets/js/116.d6a178ae.js"><link rel="prefetch" href="/noteSite/assets/js/117.efc1030b.js"><link rel="prefetch" href="/noteSite/assets/js/118.cde5518e.js"><link rel="prefetch" href="/noteSite/assets/js/119.f6c0df3b.js"><link rel="prefetch" href="/noteSite/assets/js/12.92824130.js"><link rel="prefetch" href="/noteSite/assets/js/120.6f697156.js"><link rel="prefetch" href="/noteSite/assets/js/121.dc6a74bb.js"><link rel="prefetch" href="/noteSite/assets/js/122.d95362ae.js"><link rel="prefetch" href="/noteSite/assets/js/123.e1d6ee99.js"><link rel="prefetch" href="/noteSite/assets/js/124.8d4acc41.js"><link rel="prefetch" href="/noteSite/assets/js/125.0d0c051c.js"><link rel="prefetch" href="/noteSite/assets/js/126.1c5c09dc.js"><link rel="prefetch" href="/noteSite/assets/js/127.1f7f8fce.js"><link rel="prefetch" href="/noteSite/assets/js/128.45469051.js"><link rel="prefetch" href="/noteSite/assets/js/129.37d826a8.js"><link rel="prefetch" href="/noteSite/assets/js/13.ebf19a2d.js"><link rel="prefetch" href="/noteSite/assets/js/130.88d6afb9.js"><link rel="prefetch" href="/noteSite/assets/js/131.774a74b7.js"><link rel="prefetch" href="/noteSite/assets/js/132.1704fcae.js"><link rel="prefetch" href="/noteSite/assets/js/133.fc3006db.js"><link rel="prefetch" href="/noteSite/assets/js/134.5716ef8b.js"><link rel="prefetch" href="/noteSite/assets/js/135.c50e9ea6.js"><link rel="prefetch" href="/noteSite/assets/js/136.20dfa2a7.js"><link rel="prefetch" href="/noteSite/assets/js/137.cb04b260.js"><link rel="prefetch" href="/noteSite/assets/js/138.19cad5d6.js"><link rel="prefetch" href="/noteSite/assets/js/139.6f2c07d8.js"><link rel="prefetch" href="/noteSite/assets/js/14.c9554d8e.js"><link rel="prefetch" href="/noteSite/assets/js/140.1b6c5422.js"><link rel="prefetch" href="/noteSite/assets/js/141.675c0f9b.js"><link rel="prefetch" href="/noteSite/assets/js/142.76209354.js"><link rel="prefetch" href="/noteSite/assets/js/143.19655c31.js"><link rel="prefetch" href="/noteSite/assets/js/144.df6e000f.js"><link rel="prefetch" href="/noteSite/assets/js/145.da6c4b93.js"><link rel="prefetch" href="/noteSite/assets/js/146.6cdb4866.js"><link rel="prefetch" href="/noteSite/assets/js/147.147e6d65.js"><link rel="prefetch" href="/noteSite/assets/js/148.0190a0de.js"><link rel="prefetch" href="/noteSite/assets/js/149.34f70845.js"><link rel="prefetch" href="/noteSite/assets/js/15.80ccce32.js"><link rel="prefetch" href="/noteSite/assets/js/150.e613dbbb.js"><link rel="prefetch" href="/noteSite/assets/js/151.5ad98d0d.js"><link rel="prefetch" href="/noteSite/assets/js/152.9d588c12.js"><link rel="prefetch" href="/noteSite/assets/js/153.b20bef21.js"><link rel="prefetch" href="/noteSite/assets/js/154.a48744d9.js"><link rel="prefetch" href="/noteSite/assets/js/155.c3ba408c.js"><link rel="prefetch" href="/noteSite/assets/js/156.4b410d86.js"><link rel="prefetch" href="/noteSite/assets/js/157.3de92249.js"><link rel="prefetch" href="/noteSite/assets/js/158.b2af571d.js"><link rel="prefetch" href="/noteSite/assets/js/159.ef85befc.js"><link rel="prefetch" href="/noteSite/assets/js/16.04c546fc.js"><link rel="prefetch" href="/noteSite/assets/js/160.d623ea16.js"><link rel="prefetch" href="/noteSite/assets/js/161.d8106190.js"><link rel="prefetch" href="/noteSite/assets/js/162.dbfa1714.js"><link rel="prefetch" href="/noteSite/assets/js/163.c24e5621.js"><link rel="prefetch" href="/noteSite/assets/js/164.b9eb66a9.js"><link rel="prefetch" href="/noteSite/assets/js/165.215f3273.js"><link rel="prefetch" href="/noteSite/assets/js/166.1c4660fa.js"><link rel="prefetch" href="/noteSite/assets/js/167.6a352d81.js"><link rel="prefetch" href="/noteSite/assets/js/168.ec322d81.js"><link rel="prefetch" href="/noteSite/assets/js/169.e770dabb.js"><link rel="prefetch" href="/noteSite/assets/js/17.931e78bb.js"><link rel="prefetch" href="/noteSite/assets/js/170.23b4c824.js"><link rel="prefetch" href="/noteSite/assets/js/171.dd1498dd.js"><link rel="prefetch" href="/noteSite/assets/js/172.8e0f461e.js"><link rel="prefetch" href="/noteSite/assets/js/173.dc35e674.js"><link rel="prefetch" href="/noteSite/assets/js/174.d2a55138.js"><link rel="prefetch" href="/noteSite/assets/js/175.f2338c25.js"><link rel="prefetch" href="/noteSite/assets/js/176.7fb42c0d.js"><link rel="prefetch" href="/noteSite/assets/js/177.7661d1d5.js"><link rel="prefetch" href="/noteSite/assets/js/178.da956398.js"><link rel="prefetch" href="/noteSite/assets/js/179.ca23bf7b.js"><link rel="prefetch" href="/noteSite/assets/js/18.920cb685.js"><link rel="prefetch" href="/noteSite/assets/js/180.9ccd5c8a.js"><link rel="prefetch" href="/noteSite/assets/js/181.8d428209.js"><link rel="prefetch" href="/noteSite/assets/js/182.34bb23ea.js"><link rel="prefetch" href="/noteSite/assets/js/183.16d76d78.js"><link rel="prefetch" href="/noteSite/assets/js/184.48340f37.js"><link rel="prefetch" href="/noteSite/assets/js/185.127bc886.js"><link rel="prefetch" href="/noteSite/assets/js/186.0edc4748.js"><link rel="prefetch" href="/noteSite/assets/js/187.0f344a00.js"><link rel="prefetch" href="/noteSite/assets/js/188.2f07742f.js"><link rel="prefetch" href="/noteSite/assets/js/189.02245f28.js"><link rel="prefetch" href="/noteSite/assets/js/19.899200c9.js"><link rel="prefetch" href="/noteSite/assets/js/190.2acf376c.js"><link rel="prefetch" href="/noteSite/assets/js/191.ae40cba3.js"><link rel="prefetch" href="/noteSite/assets/js/192.660e93fe.js"><link rel="prefetch" href="/noteSite/assets/js/193.918136eb.js"><link rel="prefetch" href="/noteSite/assets/js/194.b46b8ccf.js"><link rel="prefetch" href="/noteSite/assets/js/195.ee3473d6.js"><link rel="prefetch" href="/noteSite/assets/js/196.11e0771e.js"><link rel="prefetch" href="/noteSite/assets/js/197.1790eaff.js"><link rel="prefetch" href="/noteSite/assets/js/198.f60df26b.js"><link rel="prefetch" href="/noteSite/assets/js/199.37af66c6.js"><link rel="prefetch" href="/noteSite/assets/js/20.31cf6b87.js"><link rel="prefetch" href="/noteSite/assets/js/200.a8bf8cd4.js"><link rel="prefetch" href="/noteSite/assets/js/201.ba2c155d.js"><link rel="prefetch" href="/noteSite/assets/js/202.4c7ed5e5.js"><link rel="prefetch" href="/noteSite/assets/js/203.c013b9ae.js"><link rel="prefetch" href="/noteSite/assets/js/204.0005dab4.js"><link rel="prefetch" href="/noteSite/assets/js/205.03565aa4.js"><link rel="prefetch" href="/noteSite/assets/js/206.2faedf0d.js"><link rel="prefetch" href="/noteSite/assets/js/207.00aed5e0.js"><link rel="prefetch" href="/noteSite/assets/js/208.9ef9ebf7.js"><link rel="prefetch" href="/noteSite/assets/js/209.e3d37694.js"><link rel="prefetch" href="/noteSite/assets/js/21.16319045.js"><link rel="prefetch" href="/noteSite/assets/js/210.36a55d0a.js"><link rel="prefetch" href="/noteSite/assets/js/211.d3878160.js"><link rel="prefetch" href="/noteSite/assets/js/212.d72d3676.js"><link rel="prefetch" href="/noteSite/assets/js/213.fc33712b.js"><link rel="prefetch" href="/noteSite/assets/js/214.81ad4b34.js"><link rel="prefetch" href="/noteSite/assets/js/215.51b3c04f.js"><link rel="prefetch" href="/noteSite/assets/js/216.c1845506.js"><link rel="prefetch" href="/noteSite/assets/js/217.7964b1bd.js"><link rel="prefetch" href="/noteSite/assets/js/218.b690fe4b.js"><link rel="prefetch" href="/noteSite/assets/js/219.0608bdb7.js"><link rel="prefetch" href="/noteSite/assets/js/22.83c27518.js"><link rel="prefetch" href="/noteSite/assets/js/220.12f67b89.js"><link rel="prefetch" href="/noteSite/assets/js/221.30da5fc5.js"><link rel="prefetch" href="/noteSite/assets/js/222.42747282.js"><link rel="prefetch" href="/noteSite/assets/js/223.57ba2387.js"><link rel="prefetch" href="/noteSite/assets/js/224.e997e986.js"><link rel="prefetch" href="/noteSite/assets/js/225.4e536560.js"><link rel="prefetch" href="/noteSite/assets/js/226.ab97b466.js"><link rel="prefetch" href="/noteSite/assets/js/227.09b6f548.js"><link rel="prefetch" href="/noteSite/assets/js/228.a435f8a9.js"><link rel="prefetch" href="/noteSite/assets/js/229.b17d76a0.js"><link rel="prefetch" href="/noteSite/assets/js/23.4def1b30.js"><link rel="prefetch" href="/noteSite/assets/js/230.2467a235.js"><link rel="prefetch" href="/noteSite/assets/js/231.182c7fb6.js"><link rel="prefetch" href="/noteSite/assets/js/232.dacf767e.js"><link rel="prefetch" href="/noteSite/assets/js/233.f3af05cc.js"><link rel="prefetch" href="/noteSite/assets/js/234.5108b69a.js"><link rel="prefetch" href="/noteSite/assets/js/235.a0c3ec26.js"><link rel="prefetch" href="/noteSite/assets/js/236.a5196059.js"><link rel="prefetch" href="/noteSite/assets/js/24.833a668b.js"><link rel="prefetch" href="/noteSite/assets/js/25.0aa4ab15.js"><link rel="prefetch" href="/noteSite/assets/js/26.4bb01d00.js"><link rel="prefetch" href="/noteSite/assets/js/27.28e3df64.js"><link rel="prefetch" href="/noteSite/assets/js/28.6fd43352.js"><link rel="prefetch" href="/noteSite/assets/js/29.c7e2c8bd.js"><link rel="prefetch" href="/noteSite/assets/js/3.55ea5c47.js"><link rel="prefetch" href="/noteSite/assets/js/30.592a250a.js"><link rel="prefetch" href="/noteSite/assets/js/31.4117ddbf.js"><link rel="prefetch" href="/noteSite/assets/js/32.7dec0eab.js"><link rel="prefetch" href="/noteSite/assets/js/33.f350693e.js"><link rel="prefetch" href="/noteSite/assets/js/34.69de4dbc.js"><link rel="prefetch" href="/noteSite/assets/js/35.3c111ca9.js"><link rel="prefetch" href="/noteSite/assets/js/36.beda9626.js"><link rel="prefetch" href="/noteSite/assets/js/37.5d73cf22.js"><link rel="prefetch" href="/noteSite/assets/js/38.822c65a9.js"><link rel="prefetch" href="/noteSite/assets/js/39.108b5718.js"><link rel="prefetch" href="/noteSite/assets/js/4.a61e4cea.js"><link rel="prefetch" href="/noteSite/assets/js/40.f6a371fd.js"><link rel="prefetch" href="/noteSite/assets/js/41.4ec05a60.js"><link rel="prefetch" href="/noteSite/assets/js/42.ced4d215.js"><link rel="prefetch" href="/noteSite/assets/js/43.518f3d73.js"><link rel="prefetch" href="/noteSite/assets/js/44.2f222349.js"><link rel="prefetch" href="/noteSite/assets/js/45.3cd8ec7e.js"><link rel="prefetch" href="/noteSite/assets/js/46.c63316fe.js"><link rel="prefetch" href="/noteSite/assets/js/47.8a98effd.js"><link rel="prefetch" href="/noteSite/assets/js/48.829750fe.js"><link rel="prefetch" href="/noteSite/assets/js/49.b9adb364.js"><link rel="prefetch" href="/noteSite/assets/js/5.2bccd6df.js"><link rel="prefetch" href="/noteSite/assets/js/50.d6cd4367.js"><link rel="prefetch" href="/noteSite/assets/js/51.89c8f094.js"><link rel="prefetch" href="/noteSite/assets/js/52.a43424da.js"><link rel="prefetch" href="/noteSite/assets/js/53.85509c05.js"><link rel="prefetch" href="/noteSite/assets/js/54.57e84326.js"><link rel="prefetch" href="/noteSite/assets/js/55.d623e6e1.js"><link rel="prefetch" href="/noteSite/assets/js/56.48145fda.js"><link rel="prefetch" href="/noteSite/assets/js/57.0627ff74.js"><link rel="prefetch" href="/noteSite/assets/js/58.cb17d6f5.js"><link rel="prefetch" href="/noteSite/assets/js/59.30f9147e.js"><link rel="prefetch" href="/noteSite/assets/js/6.f3d86aa7.js"><link rel="prefetch" href="/noteSite/assets/js/60.2e516ce1.js"><link rel="prefetch" href="/noteSite/assets/js/61.fc84ae88.js"><link rel="prefetch" href="/noteSite/assets/js/62.7c3db4bc.js"><link rel="prefetch" href="/noteSite/assets/js/63.532775e5.js"><link rel="prefetch" href="/noteSite/assets/js/64.e36f0a6a.js"><link rel="prefetch" href="/noteSite/assets/js/65.ac27013a.js"><link rel="prefetch" href="/noteSite/assets/js/66.04eaaace.js"><link rel="prefetch" href="/noteSite/assets/js/67.0b9c8ac5.js"><link rel="prefetch" href="/noteSite/assets/js/68.e34d9385.js"><link rel="prefetch" href="/noteSite/assets/js/69.0f97c351.js"><link rel="prefetch" href="/noteSite/assets/js/7.da9921ea.js"><link rel="prefetch" href="/noteSite/assets/js/70.4e5c2434.js"><link rel="prefetch" href="/noteSite/assets/js/71.215c12d1.js"><link rel="prefetch" href="/noteSite/assets/js/72.e70166f6.js"><link rel="prefetch" href="/noteSite/assets/js/73.318584d8.js"><link rel="prefetch" href="/noteSite/assets/js/74.fc5edc93.js"><link rel="prefetch" href="/noteSite/assets/js/75.7dba2e9a.js"><link rel="prefetch" href="/noteSite/assets/js/76.20a748eb.js"><link rel="prefetch" href="/noteSite/assets/js/77.0e622806.js"><link rel="prefetch" href="/noteSite/assets/js/78.a3309481.js"><link rel="prefetch" href="/noteSite/assets/js/79.86216f31.js"><link rel="prefetch" href="/noteSite/assets/js/8.aeb5f827.js"><link rel="prefetch" href="/noteSite/assets/js/80.7df5c162.js"><link rel="prefetch" href="/noteSite/assets/js/81.fbfca43e.js"><link rel="prefetch" href="/noteSite/assets/js/82.574dbb1d.js"><link rel="prefetch" href="/noteSite/assets/js/83.b372cce8.js"><link rel="prefetch" href="/noteSite/assets/js/84.679ba992.js"><link rel="prefetch" href="/noteSite/assets/js/85.212e402d.js"><link rel="prefetch" href="/noteSite/assets/js/86.3290b388.js"><link rel="prefetch" href="/noteSite/assets/js/87.e0662abf.js"><link rel="prefetch" href="/noteSite/assets/js/88.a3bb83db.js"><link rel="prefetch" href="/noteSite/assets/js/89.9b166836.js"><link rel="prefetch" href="/noteSite/assets/js/9.f364677d.js"><link rel="prefetch" href="/noteSite/assets/js/90.5f4923fc.js"><link rel="prefetch" href="/noteSite/assets/js/91.5bffef3d.js"><link rel="prefetch" href="/noteSite/assets/js/92.7dfbd84c.js"><link rel="prefetch" href="/noteSite/assets/js/93.d293cff0.js"><link rel="prefetch" href="/noteSite/assets/js/94.c68b142b.js"><link rel="prefetch" href="/noteSite/assets/js/95.0cf57b3f.js"><link rel="prefetch" href="/noteSite/assets/js/96.9e11f6e1.js"><link rel="prefetch" href="/noteSite/assets/js/97.dad51d14.js"><link rel="prefetch" href="/noteSite/assets/js/98.74a1010a.js"><link rel="prefetch" href="/noteSite/assets/js/99.128d25fb.js">
    <link rel="stylesheet" href="/noteSite/assets/css/0.styles.0f3b0cbd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/noteSite/" class="home-link router-link-active"><img src="/noteSite/images/hedon.png" alt="Hedon" class="logo"> <span class="site-name can-hide">Hedon</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/noteSite/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/noteSite/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CS Menu" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="CS Menu" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/noteSite/cs/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/os/" class="nav-link">
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/cn/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/component/" class="nav-link">
  计算机组成原理
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Backend Menu" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="Backend Menu" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/noteSite/backend/java/" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/golang/" class="nav-link">
  Golang
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/go-full/" class="nav-link">
  Go 开发工程师
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/middleware/" class="nav-link router-link-active">
  中间件
</a></li></ul></div></div><div class="nav-item"><a href="/noteSite/frontend/" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/noteSite/linux/" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/noteSite/mac/" class="nav-link">
  Mac
</a></div><div class="nav-item"><a href="/noteSite/leetcode/" class="nav-link">
  Leetcode
</a></div><div class="nav-item"><a href="/noteSite/paper/" class="nav-link">
  Paper
</a></div><div class="nav-item"><a href="https://github.com/hedon954/noteSite" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/noteSite/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/noteSite/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CS Menu" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="CS Menu" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/noteSite/cs/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/os/" class="nav-link">
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/cn/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/component/" class="nav-link">
  计算机组成原理
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Backend Menu" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="Backend Menu" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/noteSite/backend/java/" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/golang/" class="nav-link">
  Golang
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/go-full/" class="nav-link">
  Go 开发工程师
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/middleware/" class="nav-link router-link-active">
  中间件
</a></li></ul></div></div><div class="nav-item"><a href="/noteSite/frontend/" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/noteSite/linux/" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/noteSite/mac/" class="nav-link">
  Mac
</a></div><div class="nav-item"><a href="/noteSite/leetcode/" class="nav-link">
  Leetcode
</a></div><div class="nav-item"><a href="/noteSite/paper/" class="nav-link">
  Paper
</a></div><div class="nav-item"><a href="https://github.com/hedon954/noteSite" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Redis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Redis 实战</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>MongoDB</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/noteSite/backend/middleware/mongodb/01-mongodb-intro.html" class="sidebar-link">一、MongoDB 快速入门</a></li><li><a href="/noteSite/backend/middleware/mongodb/02-mongodb-install.html" class="sidebar-link">二、MongoDB 单机部署</a></li><li><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html" aria-current="page" class="active sidebar-link">三、MongoDB CRUD</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_1-数据库-database" class="sidebar-link">1. 数据库 database</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_1-1-创建数据库" class="sidebar-link">1.1 创建数据库</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_1-2-删除数据库" class="sidebar-link">1.2 删除数据库</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_1-3-查看数据库" class="sidebar-link">1.3 查看数据库</a></li></ul></li><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_2-集合-collection" class="sidebar-link">2. 集合 collection</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_2-1-创建集合" class="sidebar-link">2.1 创建集合</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_2-2-删除集合" class="sidebar-link">2.2 删除集合</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_2-2-查看集合" class="sidebar-link">2.2 查看集合</a></li></ul></li><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_3-文档-document" class="sidebar-link">3. 文档 document</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_3-1-插入文档" class="sidebar-link">3.1 插入文档</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_3-2-查询文档" class="sidebar-link">3.2 查询文档</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_3-3-更新文档" class="sidebar-link">3.3 更新文档</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_3-4-删除文档" class="sidebar-link">3.4 删除文档</a></li></ul></li></ul></li><li><a href="/noteSite/backend/middleware/mongodb/04-mongodb-aggregation.html" class="sidebar-link">四、MongoDB 聚合</a></li><li><a href="/noteSite/backend/middleware/mongodb/05-mongodb-index.html" class="sidebar-link">五、MongoDB 索引</a></li><li><a href="/noteSite/backend/middleware/mongodb/06-mongodb-replicaSet.html" class="sidebar-link">六、MongoDB 复制集</a></li><li><a href="/noteSite/backend/middleware/mongodb/07-mongodb-sharding.html" class="sidebar-link">七、MongoDB 数据分片</a></li><li><a href="/noteSite/backend/middleware/mongodb/08-mongodb-auth.html" class="sidebar-link">八、MongoDB 数据安全</a></li><li><a href="/noteSite/backend/middleware/mongodb/09-mongodb-manager.html" class="sidebar-link">九、MongoDB 数据管理</a></li><li><a href="/noteSite/backend/middleware/mongodb/10-mongodb-diagnose.html" class="sidebar-link">十、MongoDB 故障诊断</a></li><li><a href="/noteSite/backend/middleware/mongodb/11-mongodb-engine.html" class="sidebar-link">十一、MongoDB 存储引擎</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ClickHouse</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="三、mongodb-crud"><a href="#三、mongodb-crud" class="header-anchor">#</a> 三、MongoDB CRUD</h1> <blockquote><p>参考：</p> <ul><li>https://docs.mongoing.com/mongodb-crud-operations</li> <li>https://docs.mongodb.com/manual/crud/</li></ul></blockquote> <h2 id="_1-数据库-database"><a href="#_1-数据库-database" class="header-anchor">#</a> 1. 数据库 database</h2> <h3 id="_1-1-创建数据库"><a href="#_1-1-创建数据库" class="header-anchor">#</a> 1.1 创建数据库</h3> <ul><li><code>use dbname</code></li></ul> <p>数据库不在则会自动创建。</p> <div class="custom-block warning"><p class="custom-block-title">数据库命名规则</p> <p>数据库名可以是满足以下条件的任意 UTF-8 字符串：</p> <ul><li>不能是空字符串</li> <li>不得含有 <code>''</code>（空格）、<code>.</code>、<code>$</code>、<code>/</code>、<code>\</code> 和 <code>\0</code>（空字符）</li> <li>应全部小写</li> <li>最多 64 字节</li></ul> <p>有一些数据库名是保留的，可以直接访问这些有特殊作用的数据库：</p> <ul><li><strong>admin</strong>：从权限的角度看，这是个 “root” 数据库。要是一个用户添加到这个数据库，这个用户自动继承所有数据库的权限。一些特定的服务器端命令也只能从这个数据库运行，比如列出所有的数据库或者关闭服务器。</li> <li><strong>local</strong>：这个数据库永远不会被复制，可以用来存储限于本地单台服务器的任意集合。</li> <li><strong>config</strong>：当 mongo 用于分片配置时，config 数据库在内部使用，用于保存分片的相关信息。</li></ul></div> <h3 id="_1-2-删除数据库"><a href="#_1-2-删除数据库" class="header-anchor">#</a> 1.2 删除数据库</h3> <ul><li><code>db.dropDatabase()</code></li></ul> <p>主要用来删除提交持久化的数据库。</p> <h3 id="_1-3-查看数据库"><a href="#_1-3-查看数据库" class="header-anchor">#</a> 1.3 查看数据库</h3> <ul><li><code>show dbs</code>：查看所有数据库，只有当 db 里面有数据了，才会被持久化到磁盘当中，否则只在内存里面的话，用 show dbs 是查不到的。</li> <li><code>db</code>：查看当前使用的数据库。</li></ul> <p>MongoDB 默认的数据库为 test，如果你没有选择数据库，集合将存放在 test 数据库中。</p> <h2 id="_2-集合-collection"><a href="#_2-集合-collection" class="header-anchor">#</a> 2. 集合 collection</h2> <h3 id="_2-1-创建集合"><a href="#_2-1-创建集合" class="header-anchor">#</a> 2.1 创建集合</h3> <h4 id="_2-1-1-显式创建"><a href="#_2-1-1-显式创建" class="header-anchor">#</a> 2.1.1 显式创建</h4> <ul><li><code>db.createCollection(name)</code></li></ul> <h4 id="_2-1-2-隐式创建"><a href="#_2-1-2-隐式创建" class="header-anchor">#</a> 2.1.2 隐式创建</h4> <ul><li>当向一个集合中插入一个文档的时候，如果集合不存在，则会自动创建集合。</li></ul> <div class="custom-block warning"><p class="custom-block-title">集合命名规范</p> <ul><li>集合名不能是空字符串&quot;&quot;。</li> <li>集合名不能含有 \0 字符（空字符），这个字符表示集合名的结尾。</li> <li>集合名不能以 &quot;system.&quot;开头，这是为系统集合保留的前缀。</li> <li>用户创建的集合名字不能含有保留字符。有些驱动程序的确支持在集名里面包含，这是因为某些系统生成的集合中包含该字符。除非你要访问这种系统创建的集合，否则千万不要在名字里出现 $。</li></ul></div> <h3 id="_2-2-删除集合"><a href="#_2-2-删除集合" class="header-anchor">#</a> 2.2 删除集合</h3> <ul><li><code>db.collectionName.drop()</code></li></ul> <p>如果成功删除选定集合，则 drop() 方法返回 true，否则返回 false。</p> <h3 id="_2-2-查看集合"><a href="#_2-2-查看集合" class="header-anchor">#</a> 2.2 查看集合</h3> <ul><li><code>show collections</code></li> <li><code>show tables</code></li></ul> <h2 id="_3-文档-document"><a href="#_3-文档-document" class="header-anchor">#</a> 3. 文档 document</h2> <h3 id="_3-1-插入文档"><a href="#_3-1-插入文档" class="header-anchor">#</a> 3.1 插入文档</h3> <ul><li><code>db.collection.insertOne()</code>：插入单个</li> <li><code>db.collection.insertMany()</code>：插入多个</li> <li><code>db.collection.insert()</code>：插入单个或多个</li> <li><code>db.collection.save()</code>: 插入，底层调用 insert</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>db.collection.insert<span class="token punctuation">(</span>
	<span class="token operator">&lt;</span>document or array of document<span class="token operator">&gt;</span>
	<span class="token punctuation">{</span>
		writeConcern: <span class="token operator">&lt;</span>document<span class="token operator">&gt;</span>,  <span class="token comment"># 写关注，可选</span>
		ordered: <span class="token operator">&lt;</span>boolean<span class="token operator">&gt;</span>         <span class="token comment"># 是否按顺序插入，默认为 true</span>
                                    <span class="token comment"># true：有一个文档出现错误，则停止插入，返回还没处理的剩余的文档</span>
                                    <span class="token comment"># false：如果出错，则继续处理后面的文档</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">补充</p> <ol><li><p>创建或插入操作会将新文档添加到集合中。 如果该集合当前不存在，则插入操作将创建该集合。</p></li> <li><p>在MongoDB中，插入操作针对单个集合。 MongoDB中的所有写操作都是单个文档级别的<a href="https://docs.mongodb.com/master/core/write-operations-atomicity/" target="_blank" rel="noopener noreferrer">原子<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>操作。</p> <p>In MongoDB, a write operation is <a href="https://docs.mongodb.com/v5.0/reference/glossary/#std-term-atomic-operation" target="_blank" rel="noopener noreferrer">atomic<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> on the level of a single document, even if the operation modifies multiple embedded documents <em>within</em> a single document.</p></li> <li><p>在 MongoDB 中，存储在集合中的每个文档都需要一个唯一的 <code>_id</code> 字段作为主键。 如果插入的文档省略 <code>_id</code> 字段，则 MongoDB 驱动程序会自动为 <code>_id</code> 字段生成 <code>ObjectId</code>。</p></li> <li><p>插入当前日期，用 <code>new Date()</code>。</p></li> <li><p>MongoDB 中的数字，默认情况下是 <code>double</code> 类型，如果要存整型，必须使用函数 <code>NumberInt(整型数字)</code>，否则取出来就有问题了。</p></li> <li><p>如果某字段没值，可以赋值为 null，或不写该字段。</p></li></ol></div> <div class="custom-block warning"><p class="custom-block-title">insertOne、insertMany、insert 的区别</p> <ol><li>三者返回的错误信息不一样；</li> <li>insertOne、insertMany 不支持 db.collection.explain() 命令。</li></ol></div> <h4 id="_3-1-1-插入一个文档"><a href="#_3-1-1-插入一个文档" class="header-anchor">#</a> 3.1.1 插入一个文档</h4> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token operator">&gt;</span> db.hedon.insertOne<span class="token punctuation">(</span><span class="token punctuation">{</span> name: <span class="token string">&quot;hedon&quot;</span>, age: <span class="token number">18</span>, address: <span class="token string">&quot;beijing&quot;</span>, tags: <span class="token punctuation">[</span><span class="token string">&quot;student&quot;</span>, <span class="token string">&quot;software developer&quot;</span><span class="token punctuation">]</span>, body: <span class="token punctuation">{</span>weight: <span class="token number">70</span>, height: <span class="token number">199</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token string">&quot;acknowledged&quot;</span> <span class="token builtin class-name">:</span> true,
	<span class="token string">&quot;insertedId&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;6115e5c33e8322a9d326c23f&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>insertOne</code> 返回一个文档，其中包含新插入的文档的 <code>_id</code> 字段值。</p> <p>查看刚刚插入的文档：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token operator">&gt;</span> db.hedon.find<span class="token punctuation">(</span><span class="token punctuation">{</span>name: <span class="token string">&quot;hedon&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;6115e5c33e8322a9d326c23f&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;name&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;hedon&quot;</span>, <span class="token string">&quot;age&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">18</span>, <span class="token string">&quot;address&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;beijing&quot;</span>, <span class="token string">&quot;tags&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;student&quot;</span>, <span class="token string">&quot;software developer&quot;</span> <span class="token punctuation">]</span>, <span class="token string">&quot;body&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;weight&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">70</span>, <span class="token string">&quot;height&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">199</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">注意</p> <ol><li>文档中的键值对是有序的。</li> <li>文档中的值不仅可以是在双引号里面的字符串，还可以是其他几种数据类型（甚至可以是整个嵌入的文档）。</li> <li>MongoDB 区分类型和大小写。</li> <li>MongoDB 的文档不能有重复的键。</li> <li>文档的键是字符串。除了少数例外情况，键可以使用任意 UTF-8 字符。</li></ol> <p>文档键命名规范:</p> <ol><li>键不能含有 <code>\0</code>（空字符），这个字符用来表示键的结尾；</li> <li><code>.</code> 和 <code>$</code> 有特别的意义，只有在特定环境下才能使用；</li> <li>以下划线 <code>&quot;_&quot;</code> 开头的键是保留的（不是严格要求的）。</li></ol></div> <h4 id="_3-1-2-插入多个文档"><a href="#_3-1-2-插入多个文档" class="header-anchor">#</a> 3.1.2 插入多个文档</h4> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token operator">&gt;</span> db.hedon.insertMany<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">..</span>. <span class="token punctuation">{</span> name: <span class="token string">&quot;jack&quot;</span><span class="token punctuation">}</span>,
<span class="token punctuation">..</span>. <span class="token punctuation">{</span> name: <span class="token string">&quot;windy&quot;</span><span class="token punctuation">}</span>,
<span class="token punctuation">..</span>. <span class="token punctuation">{</span> name: <span class="token string">&quot;wuyifan&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">..</span>. <span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token string">&quot;acknowledged&quot;</span> <span class="token builtin class-name">:</span> true,
	<span class="token string">&quot;insertedIds&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
		ObjectId<span class="token punctuation">(</span><span class="token string">&quot;6115e6633e8322a9d326c240&quot;</span><span class="token punctuation">)</span>,
		ObjectId<span class="token punctuation">(</span><span class="token string">&quot;6115e6633e8322a9d326c241&quot;</span><span class="token punctuation">)</span>,
		ObjectId<span class="token punctuation">(</span><span class="token string">&quot;6115e6633e8322a9d326c242&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_3-1-3-主键"><a href="#_3-1-3-主键" class="header-anchor">#</a> 3.1.3 主键</h4> <p><strong>ObjectId</strong></p> <p><strong>自定义主键</strong></p> <p><strong>复合主键</strong></p> <h3 id="_3-2-查询文档"><a href="#_3-2-查询文档" class="header-anchor">#</a> 3.2 查询文档</h3> <ul><li><code>db.collection.find(&lt;query&gt;, [projection])</code></li></ul> <table><thead><tr><th>Parameter</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>query</td> <td>document</td> <td>可选。使用查询运算符指定选择筛选器。若要返回集合中的所有文档，请省略此参数或传递空文档 ( {} )。</td></tr> <tr><td>projection</td> <td>document</td> <td>可选。指定要在与查询筛选器匹配的文档中返回的字段（投影）。若要返回匹配文档中的所有字段， 请省略此参数。</td></tr></tbody></table> <blockquote><p>方便下面案例，请先插入数据：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.insertMany<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">{</span> item: <span class="token string">&quot;journal&quot;</span>, qty: <span class="token number">25</span>, size: <span class="token punctuation">{</span> h: <span class="token number">14</span>, w: <span class="token number">21</span>, uom: <span class="token string">&quot;cm&quot;</span> <span class="token punctuation">}</span>, status: <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>,
<span class="token punctuation">{</span> item: <span class="token string">&quot;notebook&quot;</span>, qty: <span class="token number">50</span>, size: <span class="token punctuation">{</span> h: <span class="token number">8.5</span>, w: <span class="token number">11</span>, uom: <span class="token string">&quot;in&quot;</span> <span class="token punctuation">}</span>, status: <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>,
<span class="token punctuation">{</span> item: <span class="token string">&quot;paper&quot;</span>, qty: <span class="token number">100</span>, size: <span class="token punctuation">{</span> h: <span class="token number">8.5</span>, w: <span class="token number">11</span>, uom: <span class="token string">&quot;in&quot;</span> <span class="token punctuation">}</span>, status: <span class="token string">&quot;D&quot;</span> <span class="token punctuation">}</span>,
<span class="token punctuation">{</span> item: <span class="token string">&quot;planner&quot;</span>, qty: <span class="token number">75</span>, size: <span class="token punctuation">{</span> h: <span class="token number">22.85</span>, w: <span class="token number">30</span>, uom: <span class="token string">&quot;cm&quot;</span> <span class="token punctuation">}</span>, status: <span class="token string">&quot;D&quot;</span> <span class="token punctuation">}</span>,
<span class="token punctuation">{</span> item: <span class="token string">&quot;postcard&quot;</span>, qty: <span class="token number">45</span>, size: <span class="token punctuation">{</span> h: <span class="token number">10</span>, w: <span class="token number">15.25</span>, uom: <span class="token string">&quot;cm&quot;</span> <span class="token punctuation">}</span>, status: <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></blockquote> <h4 id="_3-2-1-查询所有"><a href="#_3-2-1-查询所有" class="header-anchor">#</a> 3.2.1 查询所有</h4> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token operator">&gt;</span> db.inventory.<span class="token function-name function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;6115ec3e3e8322a9d326c243&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;item&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;journal&quot;</span>, <span class="token string">&quot;qty&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">25</span>, <span class="token string">&quot;size&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;h&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">14</span>, <span class="token string">&quot;w&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">21</span>, <span class="token string">&quot;uom&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;cm&quot;</span> <span class="token punctuation">}</span>, <span class="token string">&quot;status&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;6115ec3e3e8322a9d326c244&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;item&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;notebook&quot;</span>, <span class="token string">&quot;qty&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">50</span>, <span class="token string">&quot;size&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;h&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">8.5</span>, <span class="token string">&quot;w&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">11</span>, <span class="token string">&quot;uom&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;in&quot;</span> <span class="token punctuation">}</span>, <span class="token string">&quot;status&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;6115ec3e3e8322a9d326c245&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;item&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;paper&quot;</span>, <span class="token string">&quot;qty&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">100</span>, <span class="token string">&quot;size&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;h&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">8.5</span>, <span class="token string">&quot;w&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">11</span>, <span class="token string">&quot;uom&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;in&quot;</span> <span class="token punctuation">}</span>, <span class="token string">&quot;status&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;D&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;6115ec3e3e8322a9d326c246&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;item&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;planner&quot;</span>, <span class="token string">&quot;qty&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">75</span>, <span class="token string">&quot;size&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;h&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">22.85</span>, <span class="token string">&quot;w&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">30</span>, <span class="token string">&quot;uom&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;cm&quot;</span> <span class="token punctuation">}</span>, <span class="token string">&quot;status&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;D&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;6115ec3e3e8322a9d326c247&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;item&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;postcard&quot;</span>, <span class="token string">&quot;qty&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">45</span>, <span class="token string">&quot;size&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;h&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">10</span>, <span class="token string">&quot;w&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">15.25</span>, <span class="token string">&quot;uom&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;cm&quot;</span> <span class="token punctuation">}</span>, <span class="token string">&quot;status&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>
</code></pre></div><h4 id="_3-2-2-条件查询"><a href="#_3-2-2-条件查询" class="header-anchor">#</a> 3.2.2 条件查询</h4> <ul><li><p>EQUAL</p> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> status: <span class="token string">&quot;D&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div></li> <li><p>GT/LT/GTE/LTE</p> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> qty: <span class="token punctuation">{</span> <span class="token variable">$lt</span><span class="token builtin class-name">:</span> <span class="token number">30</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div></li> <li><p>IN</p> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> status: <span class="token punctuation">{</span> <span class="token variable">$in</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;A&quot;</span>, <span class="token string">&quot;D&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div><blockquote><p>尽管可以使用 <code>$or</code> 操作符表示此查询，但在对同一字段执行相等性检查时，请使用 <code>$in</code> 操作符而不是 <code>$or</code> 操作符，因为 <code>$in</code> 可以走索引，查询效率更高。</p></blockquote></li> <li><p>AND</p> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> status: <span class="token string">&quot;A&quot;</span>, qty: <span class="token punctuation">{</span> <span class="token variable">$lt</span><span class="token builtin class-name">:</span> <span class="token number">30</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div></li> <li><p>OR</p> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> <span class="token variable">$or</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span> <span class="token punctuation">{</span> status: <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> qty: <span class="token punctuation">{</span> <span class="token variable">$lt</span><span class="token builtin class-name">:</span> <span class="token number">30</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div></li> <li><p>AND &amp; OR</p> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span>
     status: <span class="token string">&quot;A&quot;</span>,
     <span class="token variable">$or</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span> <span class="token punctuation">{</span> qty: <span class="token punctuation">{</span> <span class="token variable">$lt</span><span class="token builtin class-name">:</span> <span class="token number">30</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> item: <span class="token string">&quot;journal&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div></li> <li><p>REGEX</p> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span>
     status: <span class="token string">&quot;A&quot;</span>,
     <span class="token variable">$or</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span> <span class="token punctuation">{</span> qty: <span class="token punctuation">{</span> <span class="token variable">$lt</span><span class="token builtin class-name">:</span> <span class="token number">30</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> item: /^p/ <span class="token punctuation">}</span> <span class="token punctuation">]</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div><blockquote><p>MongoDB支持正则表达式 <code>$regex</code> 查询来执行字符串模式匹配。</p></blockquote></li></ul> <h4 id="_3-2-3-投影查询"><a href="#_3-2-3-投影查询" class="header-anchor">#</a> 3.2.3 投影查询</h4> <p>默认情况下，MongoDB 中的查询返回匹配文档中的所有字段。 要限制 MongoDB 发送给应用程序的数据量，可以包含一个 <code>projection</code> 文档以指定或限制要返回的字段。</p> <ul><li><code>fieldName: 1</code>：显示 <code>filedName</code> 字段，<code>_id</code> 字段默认为 1</li> <li><code>fieldName: 0</code>：不显示 <code>fieldName</code> 字段</li></ul> <p>如果 <code>projection</code> 中只有 <code>0</code>，那就是排除掉指定的 <code>field</code>。</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># 仅查询 _id, item, status</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> status: <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> item: <span class="token number">1</span>, status: <span class="token number">1</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>

<span class="token comment"># 仅查询 item, status</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> status: <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> item: <span class="token number">1</span>, status: <span class="token number">1</span>, _id: <span class="token number">0</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>

<span class="token comment"># 不要 status 和 instock 字段</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> status: <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> status: <span class="token number">0</span>, instock: <span class="token number">0</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>

<span class="token comment"># 返回嵌入式文档中的特定字段</span>
db.inventory.find<span class="token punctuation">(</span>
  <span class="token punctuation">{</span> status: <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span> item: <span class="token number">1</span>, status: <span class="token number">1</span>, <span class="token string">&quot;size.uom&quot;</span><span class="token builtin class-name">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token comment"># 禁止嵌入文档中的特定字段</span>
db.inventory.find<span class="token punctuation">(</span> 
      <span class="token punctuation">{</span> status: <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>,
      <span class="token punctuation">{</span> <span class="token string">&quot;size.uom&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token comment"># 返回数组中的项目特定数组元素，-1 表示最后一个元素</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> status: <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> item: <span class="token number">1</span>, status: <span class="token number">1</span>, instock: <span class="token punctuation">{</span> <span class="token variable">$slice</span><span class="token builtin class-name">:</span> -1 <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div><blockquote><p>对于包含数组的字段，MongoDB 提供以下用于操纵数组的投影运算符：<code>$elemMatch</code>、<code>$slice</code>、<code>$</code>。<code>$elemMatch</code>、<code>$slice</code> 和 <code>$</code>  是 projection 要包含在返回数组中的特定元素的唯一方法。 例如，您不能使用数组索引来投影特定的数组元素。 例如 <strong>{“ instock.0”: 1}</strong> 是不会返回数组的第一个元素的。</p></blockquote> <h4 id="_3-2-4-嵌入式文档查询"><a href="#_3-2-4-嵌入式文档查询" class="header-anchor">#</a> 3.2.4 嵌入式文档查询</h4> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.insertMany<span class="token punctuation">(</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> item: <span class="token string">&quot;journal&quot;</span>, instock: <span class="token punctuation">[</span> <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;A&quot;</span>, qty: <span class="token number">5</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;C&quot;</span>, qty: <span class="token number">15</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>,  
    <span class="token punctuation">{</span> item: <span class="token string">&quot;notebook&quot;</span>, instock: <span class="token punctuation">[</span> <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;C&quot;</span>, qty: <span class="token number">5</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>,
    <span class="token punctuation">{</span> item: <span class="token string">&quot;paper&quot;</span>, instock: <span class="token punctuation">[</span> <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;A&quot;</span>, qty: <span class="token number">60</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;B&quot;</span>, qty: <span class="token number">15</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>,
    <span class="token punctuation">{</span> item: <span class="token string">&quot;planner&quot;</span>, instock: <span class="token punctuation">[</span> <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;A&quot;</span>, qty: <span class="token number">40</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;B&quot;</span>, qty: <span class="token number">5</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>, 
    <span class="token punctuation">{</span> item: <span class="token string">&quot;postcard&quot;</span>, instock: <span class="token punctuation">[</span> <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;B&quot;</span>, qty: <span class="token number">15</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;C&quot;</span>, qty: <span class="token number">35</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>上面插入的结构中，<code>instock</code> 是一个数组，其中每一个元素都是一个 document。我们可以直接对数据里面的元素进行条件查询。</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> <span class="token string">&quot;instock&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;A&quot;</span>, qty: <span class="token number">5</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div><blockquote><p>整个嵌入式/嵌套文档上的相等匹配要求与指定文档（包括字段 <strong>顺序</strong>）完全匹配。 例如，以下查询与 <strong>inventory</strong> 中的任何文档都不匹配</p> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> <span class="token string">&quot;instock&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> qty: <span class="token number">5</span>, warehouse: <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div></blockquote> <h4 id="_3-2-5-数组查询"><a href="#_3-2-5-数组查询" class="header-anchor">#</a> 3.2.5 数组查询</h4> <blockquote><p>数据准备：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.insertMany<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span> item: <span class="token string">&quot;journal&quot;</span>, qty: <span class="token number">25</span>, tags: <span class="token punctuation">[</span><span class="token string">&quot;blank&quot;</span>, <span class="token string">&quot;red&quot;</span><span class="token punctuation">]</span>, dim_cm: <span class="token punctuation">[</span> <span class="token number">14</span>, <span class="token number">21</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>, 
    <span class="token punctuation">{</span> item: <span class="token string">&quot;notebook&quot;</span>, qty: <span class="token number">50</span>, tags: <span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span>, <span class="token string">&quot;blank&quot;</span><span class="token punctuation">]</span>, dim_cm: <span class="token punctuation">[</span> <span class="token number">14</span>, <span class="token number">21</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>,
    <span class="token punctuation">{</span> item: <span class="token string">&quot;paper&quot;</span>, qty: <span class="token number">100</span>, tags: <span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span>, <span class="token string">&quot;blank&quot;</span>, <span class="token string">&quot;plain&quot;</span><span class="token punctuation">]</span>, dim_cm: <span class="token punctuation">[</span> <span class="token number">14</span>, <span class="token number">21</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>,
    <span class="token punctuation">{</span> item: <span class="token string">&quot;planner&quot;</span>, qty: <span class="token number">75</span>, tags: <span class="token punctuation">[</span><span class="token string">&quot;blank&quot;</span>, <span class="token string">&quot;red&quot;</span><span class="token punctuation">]</span>, dim_cm: <span class="token punctuation">[</span> <span class="token number">22.85</span>, <span class="token number">30</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>,  
    <span class="token punctuation">{</span> item: <span class="token string">&quot;postcard&quot;</span>, qty: <span class="token number">45</span>, tags: <span class="token punctuation">[</span><span class="token string">&quot;blue&quot;</span><span class="token punctuation">]</span>, dim_cm: <span class="token punctuation">[</span> <span class="token number">10</span>, <span class="token number">15.25</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></blockquote> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># 查询 tags 值是按指定顺序恰好具有两个元素&quot;red&quot; 和&quot;blank&quot;的数组</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> tags: <span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span>, <span class="token string">&quot;blank&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>

<span class="token comment"># 查询一个同时包含元素“red”和“blank”的数组，而不考虑顺序或该数组中的其他元素，用 $all</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> tags: <span class="token punctuation">{</span> <span class="token variable">$all</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span>, <span class="token string">&quot;blank&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>

<span class="token comment"># 查询元素中的 tag 有 “red” 的数组</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> tags: <span class="token string">&quot;red&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>

<span class="token comment"># 查询数组 dim_cm 包含至少一个值大于25的元素的所有文档</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> dim_cm: <span class="token punctuation">{</span> <span class="token variable">$gt</span><span class="token builtin class-name">:</span> <span class="token number">25</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>

<span class="token comment"># 查询在 dim_cm 数组中包含至少一个同时大于 ($gt)22 和小于 ($lt) 30的元素的文档，用 $elemMatch</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> dim_cm: <span class="token punctuation">{</span> <span class="token variable">$elemMatch</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token variable">$gt</span><span class="token builtin class-name">:</span> <span class="token number">22</span>, <span class="token variable">$lt</span><span class="token builtin class-name">:</span> <span class="token number">30</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>

<span class="token comment"># 查询数组 dim_cm 中第 2 个元素大于 25 的所有文档，用数组下表</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> <span class="token string">&quot;dim_cm.1&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token variable">$gt</span><span class="token builtin class-name">:</span> <span class="token number">25</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>

<span class="token comment"># 数组 tags 具有 3 个元素的文档，用 $size</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> <span class="token string">&quot;tags&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token variable">$size</span><span class="token builtin class-name">:</span> <span class="token number">3</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div><h4 id="_3-2-6-空字段和不存在的字段查询"><a href="#_3-2-6-空字段和不存在的字段查询" class="header-anchor">#</a> 3.2.6 空字段和不存在的字段查询</h4> <ul><li><p>平等过滤器</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># {item：null} 查询匹配包含值是 null 的 item 字段或不包含 item 字段的文档</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> item: null <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div></li> <li><p>类型检查</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># {item：{$ type：10}} 查询只匹配包含 item 字段值为 null 的文档； 即 item 字段的值为 BSON Type 为 Null（类型编号 10）：</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> item <span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token variable">$type</span><span class="token builtin class-name">:</span> <span class="token number">10</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div></li> <li><p>存在检查</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># {item：{$ exists：false}} 查询与不包含 item 字段的文档匹配</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> item <span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token variable">$exists</span><span class="token builtin class-name">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div></li></ul> <h3 id="_3-3-更新文档"><a href="#_3-3-更新文档" class="header-anchor">#</a> 3.3 更新文档</h3> <ul><li><code>db.collection.updateOne(&lt;filter&gt;, &lt;update&gt;, &lt;options&gt;)</code>：更新一个，没有则创建</li> <li><code>db.collection.updateMany(&lt;filter&gt;, &lt;update&gt;, &lt;options&gt;)</code>：更新多个，没有则创建</li> <li><code>db.collection.replaceOne(&lt;filter&gt;, &lt;update&gt;, &lt;options&gt;)</code>：替换一个</li> <li><code>db.collection.update(&lt;filter&gt;, &lt;update&gt;, &lt;options&gt;)</code>：更新一个或多个或替换，默认单个</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>db.collection.update<span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>query<span class="token operator">&gt;</span>, <span class="token operator">&lt;</span>update<span class="token operator">&gt;</span>, <span class="token punctuation">{</span>
    upsert: <span class="token operator">&lt;</span>boolean<span class="token operator">&gt;</span>,
    multi: <span class="token operator">&lt;</span>boolean<span class="token operator">&gt;</span>,  <span class="token comment"># 是否更新多个</span>
    writeConcern: <span class="token operator">&lt;</span>document<span class="token operator">&gt;</span>,
    collation: <span class="token operator">&lt;</span>document<span class="token operator">&gt;</span>,
    arrayFilters: <span class="token punctuation">[</span> <span class="token operator">&lt;</span>filterdocument<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>, <span class="token punctuation">..</span>. <span class="token punctuation">]</span>,
    hint: <span class="token operator">&lt;</span>document<span class="token operator">|</span>string<span class="token operator">&gt;</span> <span class="token comment"># MongoDB 4.2 后可用</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div><p>更新示例：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.updateOne<span class="token punctuation">(</span>
   <span class="token punctuation">{</span> item: <span class="token string">&quot;paper&quot;</span> <span class="token punctuation">}</span>,
   <span class="token punctuation">{</span>
     <span class="token variable">$set</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;size.uom&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;cm&quot;</span>, status: <span class="token string">&quot;P&quot;</span> <span class="token punctuation">}</span>,
     <span class="token variable">$currentDate</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> lastModified: <span class="token boolean">true</span> <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div><ul><li><code>$set</code>：修改一个字段，如果该字段不存在，则创建该字段</li> <li><code>$currentDate</code>：将 <code>lastModified</code> 字段更改为当前时间值，如果该字段不存在，则创建</li></ul> <p>替换示例：</p> <ul><li>要替换 <code>_id</code> 字段以外的文档的全部内容，可以将一个全新的文档作为第二个参数传递给 <code>db.collection.replaceOne</code>。</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># 替换了 inventory 集合中的第一个文件，其中 item 为 &quot;paper&quot;</span>
db.inventory.replaceOne<span class="token punctuation">(</span>
   <span class="token punctuation">{</span> item: <span class="token string">&quot;paper&quot;</span> <span class="token punctuation">}</span>,
   <span class="token punctuation">{</span> item: <span class="token string">&quot;paper&quot;</span>, instock: <span class="token punctuation">[</span> <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;A&quot;</span>, qty: <span class="token number">60</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;B&quot;</span>, qty: <span class="token number">40</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">注意</p> <ul><li>替换
<ul><li>当替换一个文档时，替换文档必须只包含字段/值对，即不包括更新操作符表达式。</li> <li>替换文档可以具有与原始文档不同的字段。在替换文档中，由于 <code>_id</code> 字段是不可变的，因此可以省略 <code>_id</code> 字段。但是，如果你确实包含 <code>_id</code> 字段，则它必须与当前值具有相同的值。</li></ul></li> <li>原子性
<ul><li>MongoDB 中的所有写操作都是单个文档级别上的原子操作。</li></ul></li> <li>_id
<ul><li><code>_id</code> 值不可变，也无法将现有文档替换为具有不同 <code>_id</code> 值的文档</li></ul></li></ul></div> <h3 id="_3-4-删除文档"><a href="#_3-4-删除文档" class="header-anchor">#</a> 3.4 删除文档</h3> <ul><li><code>db.collection.deleteMany(&lt;filter&gt;)</code>：删除多个</li> <li><code>db.collection.deletOne(&lt;filter&gt;)</code>：删除单个</li> <li><code>db.collection.remover(&lt;filter&gt;, &lt;justone&gt;)</code>：删除单个或多个，用 <code>justone</code> 字段来指定是否删除单个</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.deleteOne<span class="token punctuation">(</span> <span class="token punctuation">{</span> status: <span class="token string">&quot;D&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div><!----></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">11/25/2021, 7:13:25 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/noteSite/backend/middleware/mongodb/02-mongodb-install.html" class="prev">
        二、MongoDB 单机部署
      </a></span> <span class="next"><a href="/noteSite/backend/middleware/mongodb/04-mongodb-aggregation.html">
        四、MongoDB 聚合
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/noteSite/assets/js/app.15b6de7e.js" defer></script><script src="/noteSite/assets/js/2.6ff1f0ac.js" defer></script><script src="/noteSite/assets/js/101.01c2d0a1.js" defer></script>
  </body>
</html>
