<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>三、MongoDB CRUD | Hedon</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/noteSite/favicon.ico">
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/noteSite/assets/css/0.styles.0f3b0cbd.css" as="style"><link rel="preload" href="/noteSite/assets/js/app.4a435a5c.js" as="script"><link rel="preload" href="/noteSite/assets/js/2.691adf44.js" as="script"><link rel="preload" href="/noteSite/assets/js/79.5d168739.js" as="script"><link rel="prefetch" href="/noteSite/assets/js/10.fb6e2fc9.js"><link rel="prefetch" href="/noteSite/assets/js/100.a7b269fc.js"><link rel="prefetch" href="/noteSite/assets/js/101.50808733.js"><link rel="prefetch" href="/noteSite/assets/js/102.5ad6f618.js"><link rel="prefetch" href="/noteSite/assets/js/103.de5d9945.js"><link rel="prefetch" href="/noteSite/assets/js/104.f18d292d.js"><link rel="prefetch" href="/noteSite/assets/js/105.c747f78c.js"><link rel="prefetch" href="/noteSite/assets/js/106.d566e659.js"><link rel="prefetch" href="/noteSite/assets/js/107.c1cd396f.js"><link rel="prefetch" href="/noteSite/assets/js/108.46a949ef.js"><link rel="prefetch" href="/noteSite/assets/js/109.4f03c6a5.js"><link rel="prefetch" href="/noteSite/assets/js/11.ff5808a6.js"><link rel="prefetch" href="/noteSite/assets/js/110.522ebc49.js"><link rel="prefetch" href="/noteSite/assets/js/111.156b2445.js"><link rel="prefetch" href="/noteSite/assets/js/112.ef69d800.js"><link rel="prefetch" href="/noteSite/assets/js/113.2a38a1ed.js"><link rel="prefetch" href="/noteSite/assets/js/114.d59800cd.js"><link rel="prefetch" href="/noteSite/assets/js/115.806f1c99.js"><link rel="prefetch" href="/noteSite/assets/js/116.fc05134f.js"><link rel="prefetch" href="/noteSite/assets/js/117.058d5858.js"><link rel="prefetch" href="/noteSite/assets/js/118.0a6f6702.js"><link rel="prefetch" href="/noteSite/assets/js/119.5eb34b2e.js"><link rel="prefetch" href="/noteSite/assets/js/12.18d29461.js"><link rel="prefetch" href="/noteSite/assets/js/120.a5fc9dcf.js"><link rel="prefetch" href="/noteSite/assets/js/121.6aa05c6c.js"><link rel="prefetch" href="/noteSite/assets/js/122.40f4b34d.js"><link rel="prefetch" href="/noteSite/assets/js/123.99e79746.js"><link rel="prefetch" href="/noteSite/assets/js/124.2a0b9a99.js"><link rel="prefetch" href="/noteSite/assets/js/125.ff7b10be.js"><link rel="prefetch" href="/noteSite/assets/js/126.dc600c8e.js"><link rel="prefetch" href="/noteSite/assets/js/127.7915d3f4.js"><link rel="prefetch" href="/noteSite/assets/js/128.e22abfcb.js"><link rel="prefetch" href="/noteSite/assets/js/129.432e6c4a.js"><link rel="prefetch" href="/noteSite/assets/js/13.e33281ee.js"><link rel="prefetch" href="/noteSite/assets/js/130.a399eddd.js"><link rel="prefetch" href="/noteSite/assets/js/131.db1b1ddb.js"><link rel="prefetch" href="/noteSite/assets/js/132.e624de26.js"><link rel="prefetch" href="/noteSite/assets/js/133.99da228e.js"><link rel="prefetch" href="/noteSite/assets/js/134.b02d9dca.js"><link rel="prefetch" href="/noteSite/assets/js/135.0be4521c.js"><link rel="prefetch" href="/noteSite/assets/js/136.192b1b3d.js"><link rel="prefetch" href="/noteSite/assets/js/137.46152a41.js"><link rel="prefetch" href="/noteSite/assets/js/138.4b7bd37b.js"><link rel="prefetch" href="/noteSite/assets/js/139.18b37a88.js"><link rel="prefetch" href="/noteSite/assets/js/14.6bf835d7.js"><link rel="prefetch" href="/noteSite/assets/js/140.650865fd.js"><link rel="prefetch" href="/noteSite/assets/js/141.5bf24f4c.js"><link rel="prefetch" href="/noteSite/assets/js/142.db5ce115.js"><link rel="prefetch" href="/noteSite/assets/js/143.e2ff2b01.js"><link rel="prefetch" href="/noteSite/assets/js/144.fbea0dbe.js"><link rel="prefetch" href="/noteSite/assets/js/145.3bc09fd2.js"><link rel="prefetch" href="/noteSite/assets/js/146.c32f8502.js"><link rel="prefetch" href="/noteSite/assets/js/147.55b77c1d.js"><link rel="prefetch" href="/noteSite/assets/js/148.2b1c1a4f.js"><link rel="prefetch" href="/noteSite/assets/js/149.8c45a809.js"><link rel="prefetch" href="/noteSite/assets/js/15.d1226c7d.js"><link rel="prefetch" href="/noteSite/assets/js/150.c0d9bb63.js"><link rel="prefetch" href="/noteSite/assets/js/151.4e7fba8a.js"><link rel="prefetch" href="/noteSite/assets/js/152.9800e089.js"><link rel="prefetch" href="/noteSite/assets/js/153.e8bfb1b1.js"><link rel="prefetch" href="/noteSite/assets/js/154.38e92d68.js"><link rel="prefetch" href="/noteSite/assets/js/155.ea8d2a78.js"><link rel="prefetch" href="/noteSite/assets/js/156.b28d26c9.js"><link rel="prefetch" href="/noteSite/assets/js/157.ad2728c3.js"><link rel="prefetch" href="/noteSite/assets/js/158.e907fdaa.js"><link rel="prefetch" href="/noteSite/assets/js/159.a838f3ee.js"><link rel="prefetch" href="/noteSite/assets/js/16.7ab703a2.js"><link rel="prefetch" href="/noteSite/assets/js/160.46970ec7.js"><link rel="prefetch" href="/noteSite/assets/js/161.db23f970.js"><link rel="prefetch" href="/noteSite/assets/js/162.74129e89.js"><link rel="prefetch" href="/noteSite/assets/js/163.adbc89c3.js"><link rel="prefetch" href="/noteSite/assets/js/164.8fd5c58f.js"><link rel="prefetch" href="/noteSite/assets/js/165.173cbeac.js"><link rel="prefetch" href="/noteSite/assets/js/166.f4db5f65.js"><link rel="prefetch" href="/noteSite/assets/js/167.5b4aaa93.js"><link rel="prefetch" href="/noteSite/assets/js/168.5c6ac627.js"><link rel="prefetch" href="/noteSite/assets/js/169.54307be1.js"><link rel="prefetch" href="/noteSite/assets/js/17.81bdde2d.js"><link rel="prefetch" href="/noteSite/assets/js/170.67c9f768.js"><link rel="prefetch" href="/noteSite/assets/js/171.d0858915.js"><link rel="prefetch" href="/noteSite/assets/js/172.a802b805.js"><link rel="prefetch" href="/noteSite/assets/js/173.8976f3dd.js"><link rel="prefetch" href="/noteSite/assets/js/174.6300fb6b.js"><link rel="prefetch" href="/noteSite/assets/js/175.4d4f496f.js"><link rel="prefetch" href="/noteSite/assets/js/176.fa1cd8ca.js"><link rel="prefetch" href="/noteSite/assets/js/177.d80ee417.js"><link rel="prefetch" href="/noteSite/assets/js/178.d103b868.js"><link rel="prefetch" href="/noteSite/assets/js/179.d4647c21.js"><link rel="prefetch" href="/noteSite/assets/js/18.920cb685.js"><link rel="prefetch" href="/noteSite/assets/js/180.266426d7.js"><link rel="prefetch" href="/noteSite/assets/js/181.977f8389.js"><link rel="prefetch" href="/noteSite/assets/js/182.98d3b306.js"><link rel="prefetch" href="/noteSite/assets/js/183.c4545c4e.js"><link rel="prefetch" href="/noteSite/assets/js/184.66ef30d5.js"><link rel="prefetch" href="/noteSite/assets/js/185.d7a83872.js"><link rel="prefetch" href="/noteSite/assets/js/186.0ab9a70a.js"><link rel="prefetch" href="/noteSite/assets/js/187.ad8c5721.js"><link rel="prefetch" href="/noteSite/assets/js/188.6e24755e.js"><link rel="prefetch" href="/noteSite/assets/js/189.de1c56d5.js"><link rel="prefetch" href="/noteSite/assets/js/19.a900d7ee.js"><link rel="prefetch" href="/noteSite/assets/js/190.57fd6a7d.js"><link rel="prefetch" href="/noteSite/assets/js/191.5ab42634.js"><link rel="prefetch" href="/noteSite/assets/js/192.8146c40f.js"><link rel="prefetch" href="/noteSite/assets/js/193.2056dbd4.js"><link rel="prefetch" href="/noteSite/assets/js/194.5fe89b83.js"><link rel="prefetch" href="/noteSite/assets/js/195.507a34c0.js"><link rel="prefetch" href="/noteSite/assets/js/196.f61cfc21.js"><link rel="prefetch" href="/noteSite/assets/js/197.317d4744.js"><link rel="prefetch" href="/noteSite/assets/js/198.bcdfde0e.js"><link rel="prefetch" href="/noteSite/assets/js/199.a40d0eba.js"><link rel="prefetch" href="/noteSite/assets/js/20.172f3ffd.js"><link rel="prefetch" href="/noteSite/assets/js/200.f30411a9.js"><link rel="prefetch" href="/noteSite/assets/js/201.583c2a04.js"><link rel="prefetch" href="/noteSite/assets/js/202.b217e338.js"><link rel="prefetch" href="/noteSite/assets/js/203.626ff373.js"><link rel="prefetch" href="/noteSite/assets/js/21.1f300626.js"><link rel="prefetch" href="/noteSite/assets/js/22.e83e32c9.js"><link rel="prefetch" href="/noteSite/assets/js/23.137ee52c.js"><link rel="prefetch" href="/noteSite/assets/js/24.a659ecd0.js"><link rel="prefetch" href="/noteSite/assets/js/25.0aa4ab15.js"><link rel="prefetch" href="/noteSite/assets/js/26.8716506f.js"><link rel="prefetch" href="/noteSite/assets/js/27.8db1b159.js"><link rel="prefetch" href="/noteSite/assets/js/28.eacfb905.js"><link rel="prefetch" href="/noteSite/assets/js/29.99c65d7b.js"><link rel="prefetch" href="/noteSite/assets/js/3.c370e61c.js"><link rel="prefetch" href="/noteSite/assets/js/30.1b456f51.js"><link rel="prefetch" href="/noteSite/assets/js/31.4612eb08.js"><link rel="prefetch" href="/noteSite/assets/js/32.e91b24e8.js"><link rel="prefetch" href="/noteSite/assets/js/33.4ed7131d.js"><link rel="prefetch" href="/noteSite/assets/js/34.ccc912bd.js"><link rel="prefetch" href="/noteSite/assets/js/35.01e59039.js"><link rel="prefetch" href="/noteSite/assets/js/36.4eec506d.js"><link rel="prefetch" href="/noteSite/assets/js/37.22cb6c0d.js"><link rel="prefetch" href="/noteSite/assets/js/38.5e902c68.js"><link rel="prefetch" href="/noteSite/assets/js/39.5436193a.js"><link rel="prefetch" href="/noteSite/assets/js/4.a61e4cea.js"><link rel="prefetch" href="/noteSite/assets/js/40.97578d32.js"><link rel="prefetch" href="/noteSite/assets/js/41.edc1ac35.js"><link rel="prefetch" href="/noteSite/assets/js/42.b2e49d19.js"><link rel="prefetch" href="/noteSite/assets/js/43.a3af1d2d.js"><link rel="prefetch" href="/noteSite/assets/js/44.9007c54f.js"><link rel="prefetch" href="/noteSite/assets/js/45.a3682df9.js"><link rel="prefetch" href="/noteSite/assets/js/46.5d413aef.js"><link rel="prefetch" href="/noteSite/assets/js/47.349e1fdd.js"><link rel="prefetch" href="/noteSite/assets/js/48.4c140d1a.js"><link rel="prefetch" href="/noteSite/assets/js/49.8e71b00d.js"><link rel="prefetch" href="/noteSite/assets/js/5.2bccd6df.js"><link rel="prefetch" href="/noteSite/assets/js/50.cbc0afdf.js"><link rel="prefetch" href="/noteSite/assets/js/51.1f20694e.js"><link rel="prefetch" href="/noteSite/assets/js/52.55b0f39a.js"><link rel="prefetch" href="/noteSite/assets/js/53.214e234c.js"><link rel="prefetch" href="/noteSite/assets/js/54.0d3733a7.js"><link rel="prefetch" href="/noteSite/assets/js/55.a028b0eb.js"><link rel="prefetch" href="/noteSite/assets/js/56.09eaf09c.js"><link rel="prefetch" href="/noteSite/assets/js/57.5565c022.js"><link rel="prefetch" href="/noteSite/assets/js/58.04aaae7d.js"><link rel="prefetch" href="/noteSite/assets/js/59.30328433.js"><link rel="prefetch" href="/noteSite/assets/js/6.f3d86aa7.js"><link rel="prefetch" href="/noteSite/assets/js/60.f8597732.js"><link rel="prefetch" href="/noteSite/assets/js/61.86646e8c.js"><link rel="prefetch" href="/noteSite/assets/js/62.2024f25d.js"><link rel="prefetch" href="/noteSite/assets/js/63.8e1cfd74.js"><link rel="prefetch" href="/noteSite/assets/js/64.fdfb3fca.js"><link rel="prefetch" href="/noteSite/assets/js/65.6fccd2ec.js"><link rel="prefetch" href="/noteSite/assets/js/66.8ce588e2.js"><link rel="prefetch" href="/noteSite/assets/js/67.8cd4341b.js"><link rel="prefetch" href="/noteSite/assets/js/68.3ae24817.js"><link rel="prefetch" href="/noteSite/assets/js/69.dde052f6.js"><link rel="prefetch" href="/noteSite/assets/js/7.da9921ea.js"><link rel="prefetch" href="/noteSite/assets/js/70.cd3550c3.js"><link rel="prefetch" href="/noteSite/assets/js/71.a66ab6d5.js"><link rel="prefetch" href="/noteSite/assets/js/72.413dbd19.js"><link rel="prefetch" href="/noteSite/assets/js/73.61831cac.js"><link rel="prefetch" href="/noteSite/assets/js/74.23725827.js"><link rel="prefetch" href="/noteSite/assets/js/75.e6b1b3e0.js"><link rel="prefetch" href="/noteSite/assets/js/76.ffe84321.js"><link rel="prefetch" href="/noteSite/assets/js/77.42ded4ab.js"><link rel="prefetch" href="/noteSite/assets/js/78.ad069196.js"><link rel="prefetch" href="/noteSite/assets/js/8.8a4cb7ae.js"><link rel="prefetch" href="/noteSite/assets/js/80.e7007199.js"><link rel="prefetch" href="/noteSite/assets/js/81.2ab36e12.js"><link rel="prefetch" href="/noteSite/assets/js/82.55cef0d0.js"><link rel="prefetch" href="/noteSite/assets/js/83.50f36e23.js"><link rel="prefetch" href="/noteSite/assets/js/84.457b69ed.js"><link rel="prefetch" href="/noteSite/assets/js/85.2d3931ed.js"><link rel="prefetch" href="/noteSite/assets/js/86.0a161c7d.js"><link rel="prefetch" href="/noteSite/assets/js/87.2db622d5.js"><link rel="prefetch" href="/noteSite/assets/js/88.02c9e493.js"><link rel="prefetch" href="/noteSite/assets/js/89.f0b40af0.js"><link rel="prefetch" href="/noteSite/assets/js/9.29464c48.js"><link rel="prefetch" href="/noteSite/assets/js/90.73cf2570.js"><link rel="prefetch" href="/noteSite/assets/js/91.1c7b39f8.js"><link rel="prefetch" href="/noteSite/assets/js/92.94889d3b.js"><link rel="prefetch" href="/noteSite/assets/js/93.45a0b559.js"><link rel="prefetch" href="/noteSite/assets/js/94.24c4b7ef.js"><link rel="prefetch" href="/noteSite/assets/js/95.9c8b22bf.js"><link rel="prefetch" href="/noteSite/assets/js/96.51b296d3.js"><link rel="prefetch" href="/noteSite/assets/js/97.35cfd4e9.js"><link rel="prefetch" href="/noteSite/assets/js/98.fc967c32.js"><link rel="prefetch" href="/noteSite/assets/js/99.c1c5857c.js">
    <link rel="stylesheet" href="/noteSite/assets/css/0.styles.0f3b0cbd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/noteSite/" class="home-link router-link-active"><img src="/noteSite/images/hedon.png" alt="Hedon" class="logo"> <span class="site-name can-hide">Hedon</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/noteSite/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/noteSite/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CS Menu" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="CS Menu" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/noteSite/cs/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/os/" class="nav-link">
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/cn/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/component/" class="nav-link">
  计算机组成原理
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Backend Menu" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="Backend Menu" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/noteSite/backend/java/" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/golang/" class="nav-link">
  Golang
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/go-full/" class="nav-link">
  Go 开发工程师
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/middleware/" class="nav-link router-link-active">
  中间件
</a></li></ul></div></div><div class="nav-item"><a href="/noteSite/frontend/" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/noteSite/linux/" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/noteSite/mac/" class="nav-link">
  Mac
</a></div><div class="nav-item"><a href="/noteSite/leetcode/" class="nav-link">
  Leetcode
</a></div><div class="nav-item"><a href="/noteSite/paper/" class="nav-link">
  Paper
</a></div><div class="nav-item"><a href="https://github.com/hedon954/noteSite" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/noteSite/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/noteSite/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CS Menu" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="CS Menu" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/noteSite/cs/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/os/" class="nav-link">
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/cn/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/component/" class="nav-link">
  计算机组成原理
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Backend Menu" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="Backend Menu" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/noteSite/backend/java/" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/golang/" class="nav-link">
  Golang
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/go-full/" class="nav-link">
  Go 开发工程师
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/middleware/" class="nav-link router-link-active">
  中间件
</a></li></ul></div></div><div class="nav-item"><a href="/noteSite/frontend/" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/noteSite/linux/" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/noteSite/mac/" class="nav-link">
  Mac
</a></div><div class="nav-item"><a href="/noteSite/leetcode/" class="nav-link">
  Leetcode
</a></div><div class="nav-item"><a href="/noteSite/paper/" class="nav-link">
  Paper
</a></div><div class="nav-item"><a href="https://github.com/hedon954/noteSite" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Redis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Redis 实战</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>MongoDB</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/noteSite/backend/middleware/mongodb/01-mongodb-intro.html" class="sidebar-link">一、MongoDB 快速入门</a></li><li><a href="/noteSite/backend/middleware/mongodb/02-mongodb-install.html" class="sidebar-link">二、MongoDB 单机部署</a></li><li><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html" aria-current="page" class="active sidebar-link">三、MongoDB CRUD</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_1-数据库-database" class="sidebar-link">1. 数据库 database</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_1-1-创建数据库" class="sidebar-link">1.1 创建数据库</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_1-2-删除数据库" class="sidebar-link">1.2 删除数据库</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_1-3-查看数据库" class="sidebar-link">1.3 查看数据库</a></li></ul></li><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_2-集合-collection" class="sidebar-link">2. 集合 collection</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_2-1-创建集合" class="sidebar-link">2.1 创建集合</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_2-2-删除集合" class="sidebar-link">2.2 删除集合</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_2-2-查看集合" class="sidebar-link">2.2 查看集合</a></li></ul></li><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_3-文档-document" class="sidebar-link">3. 文档 document</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_3-1-插入文档" class="sidebar-link">3.1 插入文档</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_3-2-查询文档" class="sidebar-link">3.2 查询文档</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_3-3-更新文档" class="sidebar-link">3.3 更新文档</a></li><li class="sidebar-sub-header"><a href="/noteSite/backend/middleware/mongodb/03-mongodb-crud.html#_3-4-删除文档" class="sidebar-link">3.4 删除文档</a></li></ul></li></ul></li><li><a href="/noteSite/backend/middleware/mongodb/04-mongodb-aggregation.html" class="sidebar-link">四、MongoDB 聚合</a></li><li><a href="/noteSite/backend/middleware/mongodb/05-mongodb-index.html" class="sidebar-link">五、MongoDB 索引</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="三、mongodb-crud"><a href="#三、mongodb-crud" class="header-anchor">#</a> 三、MongoDB CRUD</h1> <blockquote><p>参考：</p> <ul><li>https://docs.mongoing.com/mongodb-crud-operations</li> <li>https://docs.mongodb.com/manual/crud/</li></ul></blockquote> <h2 id="_1-数据库-database"><a href="#_1-数据库-database" class="header-anchor">#</a> 1. 数据库 database</h2> <h3 id="_1-1-创建数据库"><a href="#_1-1-创建数据库" class="header-anchor">#</a> 1.1 创建数据库</h3> <ul><li><code>use dbname</code></li></ul> <p>数据库不在则会自动创建。</p> <div class="custom-block warning"><p class="custom-block-title">数据库命名规则</p> <p>数据库名可以是满足以下条件的任意 UTF-8 字符串：</p> <ul><li>不能是空字符串</li> <li>不得含有 <code>''</code>（空格）、<code>.</code>、<code>$</code>、<code>/</code>、<code>\</code> 和 <code>\0</code>（空字符）</li> <li>应全部小写</li> <li>最多 64 字节</li></ul> <p>有一些数据库名是保留的，可以直接访问这些有特殊作用的数据库：</p> <ul><li><strong>admin</strong>：从权限的角度看，这是个 “root” 数据库。要是一个用户添加到这个数据库，这个用户自动继承所有数据库的权限。一些特定的服务器端命令也只能从这个数据库运行，比如列出所有的数据库或者关闭服务器。</li> <li><strong>local</strong>：这个数据库永远不会被复制，可以用来存储限于本地单台服务器的任意集合。</li> <li><strong>config</strong>：当 mongo 用于分片配置时，config 数据库在内部使用，用于保存分片的相关信息。</li></ul></div> <h3 id="_1-2-删除数据库"><a href="#_1-2-删除数据库" class="header-anchor">#</a> 1.2 删除数据库</h3> <ul><li><code>db.dropDatabase()</code></li></ul> <p>主要用来删除提交持久化的数据库。</p> <h3 id="_1-3-查看数据库"><a href="#_1-3-查看数据库" class="header-anchor">#</a> 1.3 查看数据库</h3> <ul><li><code>show dbs</code>：查看所有数据库，只有当 db 里面有数据了，才会被持久化到磁盘当中，否则只在内存里面的话，用 show dbs 是查不到的。</li> <li><code>db</code>：查看当前使用的数据库。</li></ul> <p>MongoDB 默认的数据库为 test，如果你没有选择数据库，集合将存放在 test 数据库中。</p> <h2 id="_2-集合-collection"><a href="#_2-集合-collection" class="header-anchor">#</a> 2. 集合 collection</h2> <h3 id="_2-1-创建集合"><a href="#_2-1-创建集合" class="header-anchor">#</a> 2.1 创建集合</h3> <h4 id="_2-1-1-显式创建"><a href="#_2-1-1-显式创建" class="header-anchor">#</a> 2.1.1 显式创建</h4> <ul><li><code>db.createCollection(name)</code></li></ul> <h4 id="_2-1-2-隐式创建"><a href="#_2-1-2-隐式创建" class="header-anchor">#</a> 2.1.2 隐式创建</h4> <ul><li>当向一个集合中插入一个文档的时候，如果集合不存在，则会自动创建集合。</li></ul> <div class="custom-block warning"><p class="custom-block-title">集合命名规范</p> <ul><li>集合名不能是空字符串&quot;&quot;。</li> <li>集合名不能含有 \0 字符（空字符），这个字符表示集合名的结尾。</li> <li>集合名不能以 &quot;system.&quot;开头，这是为系统集合保留的前缀。</li> <li>用户创建的集合名字不能含有保留字符。有些驱动程序的确支持在集名里面包含，这是因为某些系统生成的集合中包含该字符。除非你要访问这种系统创建的集合，否则千万不要在名字里出现 $。</li></ul></div> <h3 id="_2-2-删除集合"><a href="#_2-2-删除集合" class="header-anchor">#</a> 2.2 删除集合</h3> <ul><li><code>db.collectionName.drop()</code></li></ul> <p>如果成功删除选定集合，则 drop() 方法返回 true，否则返回 false。</p> <h3 id="_2-2-查看集合"><a href="#_2-2-查看集合" class="header-anchor">#</a> 2.2 查看集合</h3> <ul><li><code>show collections</code></li> <li><code>show tables</code></li></ul> <h2 id="_3-文档-document"><a href="#_3-文档-document" class="header-anchor">#</a> 3. 文档 document</h2> <h3 id="_3-1-插入文档"><a href="#_3-1-插入文档" class="header-anchor">#</a> 3.1 插入文档</h3> <ul><li><code>db.collection.insertOne()</code>：插入单个</li> <li><code>db.collection.insertMany()</code>：插入多个</li> <li><code>db.collection.insert()</code>：插入单个或多个</li> <li><code>db.collection.save()</code>: 插入，底层调用 insert</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>db.collection.insert<span class="token punctuation">(</span>
	<span class="token operator">&lt;</span>document or array of document<span class="token operator">&gt;</span>
	<span class="token punctuation">{</span>
		writeConcern: <span class="token operator">&lt;</span>document<span class="token operator">&gt;</span>,  <span class="token comment"># 写关注，可选</span>
		ordered: <span class="token operator">&lt;</span>boolean<span class="token operator">&gt;</span>         <span class="token comment"># 是否按顺序插入，默认为 true</span>
                                    <span class="token comment"># true：有一个文档出现错误，则停止插入，返回还没处理的剩余的文档</span>
                                    <span class="token comment"># false：如果出错，则继续处理后面的文档</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">补充</p> <ol><li><p>创建或插入操作会将新文档添加到集合中。 如果该集合当前不存在，则插入操作将创建该集合。</p></li> <li><p>在MongoDB中，插入操作针对单个集合。 MongoDB中的所有写操作都是单个文档级别的<a href="https://docs.mongodb.com/master/core/write-operations-atomicity/" target="_blank" rel="noopener noreferrer">原子<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>操作。</p> <p>In MongoDB, a write operation is <a href="https://docs.mongodb.com/v5.0/reference/glossary/#std-term-atomic-operation" target="_blank" rel="noopener noreferrer">atomic<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> on the level of a single document, even if the operation modifies multiple embedded documents <em>within</em> a single document.</p></li> <li><p>在 MongoDB 中，存储在集合中的每个文档都需要一个唯一的 <code>_id</code> 字段作为主键。 如果插入的文档省略 <code>_id</code> 字段，则 MongoDB 驱动程序会自动为 <code>_id</code> 字段生成 <code>ObjectId</code>。</p></li> <li><p>插入当前日期，用 <code>new Date()</code>。</p></li> <li><p>MongoDB 中的数字，默认情况下是 <code>double</code> 类型，如果要存整型，必须使用函数 <code>NumberInt(整型数字)</code>，否则取出来就有问题了。</p></li> <li><p>如果某字段没值，可以赋值为 null，或不写该字段。</p></li></ol></div> <div class="custom-block warning"><p class="custom-block-title">insertOne、insertMany、insert 的区别</p> <ol><li>三者返回的错误信息不一样；</li> <li>insertOne、insertMany 不支持 db.collection.explain() 命令。</li></ol></div> <h4 id="_3-1-1-插入一个文档"><a href="#_3-1-1-插入一个文档" class="header-anchor">#</a> 3.1.1 插入一个文档</h4> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token operator">&gt;</span> db.hedon.insertOne<span class="token punctuation">(</span><span class="token punctuation">{</span> name: <span class="token string">&quot;hedon&quot;</span>, age: <span class="token number">18</span>, address: <span class="token string">&quot;beijing&quot;</span>, tags: <span class="token punctuation">[</span><span class="token string">&quot;student&quot;</span>, <span class="token string">&quot;software developer&quot;</span><span class="token punctuation">]</span>, body: <span class="token punctuation">{</span>weight: <span class="token number">70</span>, height: <span class="token number">199</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token string">&quot;acknowledged&quot;</span> <span class="token builtin class-name">:</span> true,
	<span class="token string">&quot;insertedId&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;6115e5c33e8322a9d326c23f&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>insertOne</code> 返回一个文档，其中包含新插入的文档的 <code>_id</code> 字段值。</p> <p>查看刚刚插入的文档：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token operator">&gt;</span> db.hedon.find<span class="token punctuation">(</span><span class="token punctuation">{</span>name: <span class="token string">&quot;hedon&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;6115e5c33e8322a9d326c23f&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;name&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;hedon&quot;</span>, <span class="token string">&quot;age&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">18</span>, <span class="token string">&quot;address&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;beijing&quot;</span>, <span class="token string">&quot;tags&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;student&quot;</span>, <span class="token string">&quot;software developer&quot;</span> <span class="token punctuation">]</span>, <span class="token string">&quot;body&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;weight&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">70</span>, <span class="token string">&quot;height&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">199</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">注意</p> <ol><li>文档中的键值对是有序的。</li> <li>文档中的值不仅可以是在双引号里面的字符串，还可以是其他几种数据类型（甚至可以是整个嵌入的文档）。</li> <li>MongoDB 区分类型和大小写。</li> <li>MongoDB 的文档不能有重复的键。</li> <li>文档的键是字符串。除了少数例外情况，键可以使用任意 UTF-8 字符。</li></ol> <p>文档键命名规范:</p> <ol><li>键不能含有 <code>\0</code>（空字符），这个字符用来表示键的结尾；</li> <li><code>.</code> 和 <code>$</code> 有特别的意义，只有在特定环境下才能使用；</li> <li>以下划线 <code>&quot;_&quot;</code> 开头的键是保留的（不是严格要求的）。</li></ol></div> <h4 id="_3-1-2-插入多个文档"><a href="#_3-1-2-插入多个文档" class="header-anchor">#</a> 3.1.2 插入多个文档</h4> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token operator">&gt;</span> db.hedon.insertMany<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">..</span>. <span class="token punctuation">{</span> name: <span class="token string">&quot;jack&quot;</span><span class="token punctuation">}</span>,
<span class="token punctuation">..</span>. <span class="token punctuation">{</span> name: <span class="token string">&quot;windy&quot;</span><span class="token punctuation">}</span>,
<span class="token punctuation">..</span>. <span class="token punctuation">{</span> name: <span class="token string">&quot;wuyifan&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">..</span>. <span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token string">&quot;acknowledged&quot;</span> <span class="token builtin class-name">:</span> true,
	<span class="token string">&quot;insertedIds&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
		ObjectId<span class="token punctuation">(</span><span class="token string">&quot;6115e6633e8322a9d326c240&quot;</span><span class="token punctuation">)</span>,
		ObjectId<span class="token punctuation">(</span><span class="token string">&quot;6115e6633e8322a9d326c241&quot;</span><span class="token punctuation">)</span>,
		ObjectId<span class="token punctuation">(</span><span class="token string">&quot;6115e6633e8322a9d326c242&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_3-1-3-主键"><a href="#_3-1-3-主键" class="header-anchor">#</a> 3.1.3 主键</h4> <p><strong>ObjectId</strong></p> <p><strong>自定义主键</strong></p> <p><strong>复合主键</strong></p> <h3 id="_3-2-查询文档"><a href="#_3-2-查询文档" class="header-anchor">#</a> 3.2 查询文档</h3> <ul><li><code>db.collection.find(&lt;query&gt;, [projection])</code></li></ul> <table><thead><tr><th>Parameter</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>query</td> <td>document</td> <td>可选。使用查询运算符指定选择筛选器。若要返回集合中的所有文档，请省略此参数或传递空文档 ( {} )。</td></tr> <tr><td>projection</td> <td>document</td> <td>可选。指定要在与查询筛选器匹配的文档中返回的字段（投影）。若要返回匹配文档中的所有字段， 请省略此参数。</td></tr></tbody></table> <blockquote><p>方便下面案例，请先插入数据：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.insertMany<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">{</span> item: <span class="token string">&quot;journal&quot;</span>, qty: <span class="token number">25</span>, size: <span class="token punctuation">{</span> h: <span class="token number">14</span>, w: <span class="token number">21</span>, uom: <span class="token string">&quot;cm&quot;</span> <span class="token punctuation">}</span>, status: <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>,
<span class="token punctuation">{</span> item: <span class="token string">&quot;notebook&quot;</span>, qty: <span class="token number">50</span>, size: <span class="token punctuation">{</span> h: <span class="token number">8.5</span>, w: <span class="token number">11</span>, uom: <span class="token string">&quot;in&quot;</span> <span class="token punctuation">}</span>, status: <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>,
<span class="token punctuation">{</span> item: <span class="token string">&quot;paper&quot;</span>, qty: <span class="token number">100</span>, size: <span class="token punctuation">{</span> h: <span class="token number">8.5</span>, w: <span class="token number">11</span>, uom: <span class="token string">&quot;in&quot;</span> <span class="token punctuation">}</span>, status: <span class="token string">&quot;D&quot;</span> <span class="token punctuation">}</span>,
<span class="token punctuation">{</span> item: <span class="token string">&quot;planner&quot;</span>, qty: <span class="token number">75</span>, size: <span class="token punctuation">{</span> h: <span class="token number">22.85</span>, w: <span class="token number">30</span>, uom: <span class="token string">&quot;cm&quot;</span> <span class="token punctuation">}</span>, status: <span class="token string">&quot;D&quot;</span> <span class="token punctuation">}</span>,
<span class="token punctuation">{</span> item: <span class="token string">&quot;postcard&quot;</span>, qty: <span class="token number">45</span>, size: <span class="token punctuation">{</span> h: <span class="token number">10</span>, w: <span class="token number">15.25</span>, uom: <span class="token string">&quot;cm&quot;</span> <span class="token punctuation">}</span>, status: <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></blockquote> <h4 id="_3-2-1-查询所有"><a href="#_3-2-1-查询所有" class="header-anchor">#</a> 3.2.1 查询所有</h4> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token operator">&gt;</span> db.inventory.<span class="token function-name function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;6115ec3e3e8322a9d326c243&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;item&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;journal&quot;</span>, <span class="token string">&quot;qty&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">25</span>, <span class="token string">&quot;size&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;h&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">14</span>, <span class="token string">&quot;w&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">21</span>, <span class="token string">&quot;uom&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;cm&quot;</span> <span class="token punctuation">}</span>, <span class="token string">&quot;status&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;6115ec3e3e8322a9d326c244&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;item&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;notebook&quot;</span>, <span class="token string">&quot;qty&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">50</span>, <span class="token string">&quot;size&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;h&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">8.5</span>, <span class="token string">&quot;w&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">11</span>, <span class="token string">&quot;uom&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;in&quot;</span> <span class="token punctuation">}</span>, <span class="token string">&quot;status&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;6115ec3e3e8322a9d326c245&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;item&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;paper&quot;</span>, <span class="token string">&quot;qty&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">100</span>, <span class="token string">&quot;size&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;h&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">8.5</span>, <span class="token string">&quot;w&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">11</span>, <span class="token string">&quot;uom&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;in&quot;</span> <span class="token punctuation">}</span>, <span class="token string">&quot;status&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;D&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;6115ec3e3e8322a9d326c246&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;item&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;planner&quot;</span>, <span class="token string">&quot;qty&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">75</span>, <span class="token string">&quot;size&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;h&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">22.85</span>, <span class="token string">&quot;w&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">30</span>, <span class="token string">&quot;uom&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;cm&quot;</span> <span class="token punctuation">}</span>, <span class="token string">&quot;status&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;D&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;6115ec3e3e8322a9d326c247&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;item&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;postcard&quot;</span>, <span class="token string">&quot;qty&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">45</span>, <span class="token string">&quot;size&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;h&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">10</span>, <span class="token string">&quot;w&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">15.25</span>, <span class="token string">&quot;uom&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;cm&quot;</span> <span class="token punctuation">}</span>, <span class="token string">&quot;status&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>
</code></pre></div><h4 id="_3-2-2-条件查询"><a href="#_3-2-2-条件查询" class="header-anchor">#</a> 3.2.2 条件查询</h4> <ul><li><p>EQUAL</p> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> status: <span class="token string">&quot;D&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div></li> <li><p>GT/LT/GTE/LTE</p> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> qty: <span class="token punctuation">{</span> <span class="token variable">$lt</span><span class="token builtin class-name">:</span> <span class="token number">30</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div></li> <li><p>IN</p> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> status: <span class="token punctuation">{</span> <span class="token variable">$in</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;A&quot;</span>, <span class="token string">&quot;D&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div><blockquote><p>尽管可以使用 <code>$or</code> 操作符表示此查询，但在对同一字段执行相等性检查时，请使用 <code>$in</code> 操作符而不是 <code>$or</code> 操作符，因为 <code>$in</code> 可以走索引，查询效率更高。</p></blockquote></li> <li><p>AND</p> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> status: <span class="token string">&quot;A&quot;</span>, qty: <span class="token punctuation">{</span> <span class="token variable">$lt</span><span class="token builtin class-name">:</span> <span class="token number">30</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div></li> <li><p>OR</p> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> <span class="token variable">$or</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span> <span class="token punctuation">{</span> status: <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> qty: <span class="token punctuation">{</span> <span class="token variable">$lt</span><span class="token builtin class-name">:</span> <span class="token number">30</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div></li> <li><p>AND &amp; OR</p> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span>
     status: <span class="token string">&quot;A&quot;</span>,
     <span class="token variable">$or</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span> <span class="token punctuation">{</span> qty: <span class="token punctuation">{</span> <span class="token variable">$lt</span><span class="token builtin class-name">:</span> <span class="token number">30</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> item: <span class="token string">&quot;journal&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div></li> <li><p>REGEX</p> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span>
     status: <span class="token string">&quot;A&quot;</span>,
     <span class="token variable">$or</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span> <span class="token punctuation">{</span> qty: <span class="token punctuation">{</span> <span class="token variable">$lt</span><span class="token builtin class-name">:</span> <span class="token number">30</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> item: /^p/ <span class="token punctuation">}</span> <span class="token punctuation">]</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div><blockquote><p>MongoDB支持正则表达式 <code>$regex</code> 查询来执行字符串模式匹配。</p></blockquote></li></ul> <h4 id="_3-2-3-投影查询"><a href="#_3-2-3-投影查询" class="header-anchor">#</a> 3.2.3 投影查询</h4> <p>默认情况下，MongoDB 中的查询返回匹配文档中的所有字段。 要限制 MongoDB 发送给应用程序的数据量，可以包含一个 <code>projection</code> 文档以指定或限制要返回的字段。</p> <ul><li><code>fieldName: 1</code>：显示 <code>filedName</code> 字段，<code>_id</code> 字段默认为 1</li> <li><code>fieldName: 0</code>：不显示 <code>fieldName</code> 字段</li></ul> <p>如果 <code>projection</code> 中只有 <code>0</code>，那就是排除掉指定的 <code>field</code>。</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># 仅查询 _id, item, status</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> status: <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> item: <span class="token number">1</span>, status: <span class="token number">1</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>

<span class="token comment"># 仅查询 item, status</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> status: <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> item: <span class="token number">1</span>, status: <span class="token number">1</span>, _id: <span class="token number">0</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>

<span class="token comment"># 不要 status 和 instock 字段</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> status: <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> status: <span class="token number">0</span>, instock: <span class="token number">0</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>

<span class="token comment"># 返回嵌入式文档中的特定字段</span>
db.inventory.find<span class="token punctuation">(</span>
  <span class="token punctuation">{</span> status: <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span> item: <span class="token number">1</span>, status: <span class="token number">1</span>, <span class="token string">&quot;size.uom&quot;</span><span class="token builtin class-name">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token comment"># 禁止嵌入文档中的特定字段</span>
db.inventory.find<span class="token punctuation">(</span> 
      <span class="token punctuation">{</span> status: <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>,
      <span class="token punctuation">{</span> <span class="token string">&quot;size.uom&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token comment"># 返回数组中的项目特定数组元素，-1 表示最后一个元素</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> status: <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> item: <span class="token number">1</span>, status: <span class="token number">1</span>, instock: <span class="token punctuation">{</span> <span class="token variable">$slice</span><span class="token builtin class-name">:</span> -1 <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div><blockquote><p>对于包含数组的字段，MongoDB 提供以下用于操纵数组的投影运算符：<code>$elemMatch</code>、<code>$slice</code>、<code>$</code>。<code>$elemMatch</code>、<code>$slice</code> 和 <code>$</code>  是 projection 要包含在返回数组中的特定元素的唯一方法。 例如，您不能使用数组索引来投影特定的数组元素。 例如 <strong>{“ instock.0”: 1}</strong> 是不会返回数组的第一个元素的。</p></blockquote> <h4 id="_3-2-4-嵌入式文档查询"><a href="#_3-2-4-嵌入式文档查询" class="header-anchor">#</a> 3.2.4 嵌入式文档查询</h4> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.insertMany<span class="token punctuation">(</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> item: <span class="token string">&quot;journal&quot;</span>, instock: <span class="token punctuation">[</span> <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;A&quot;</span>, qty: <span class="token number">5</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;C&quot;</span>, qty: <span class="token number">15</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>,  
    <span class="token punctuation">{</span> item: <span class="token string">&quot;notebook&quot;</span>, instock: <span class="token punctuation">[</span> <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;C&quot;</span>, qty: <span class="token number">5</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>,
    <span class="token punctuation">{</span> item: <span class="token string">&quot;paper&quot;</span>, instock: <span class="token punctuation">[</span> <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;A&quot;</span>, qty: <span class="token number">60</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;B&quot;</span>, qty: <span class="token number">15</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>,
    <span class="token punctuation">{</span> item: <span class="token string">&quot;planner&quot;</span>, instock: <span class="token punctuation">[</span> <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;A&quot;</span>, qty: <span class="token number">40</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;B&quot;</span>, qty: <span class="token number">5</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>, 
    <span class="token punctuation">{</span> item: <span class="token string">&quot;postcard&quot;</span>, instock: <span class="token punctuation">[</span> <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;B&quot;</span>, qty: <span class="token number">15</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;C&quot;</span>, qty: <span class="token number">35</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>上面插入的结构中，<code>instock</code> 是一个数组，其中每一个元素都是一个 document。我们可以直接对数据里面的元素进行条件查询。</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> <span class="token string">&quot;instock&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;A&quot;</span>, qty: <span class="token number">5</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div><blockquote><p>整个嵌入式/嵌套文档上的相等匹配要求与指定文档（包括字段 <strong>顺序</strong>）完全匹配。 例如，以下查询与 <strong>inventory</strong> 中的任何文档都不匹配</p> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> <span class="token string">&quot;instock&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> qty: <span class="token number">5</span>, warehouse: <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div></blockquote> <h4 id="_3-2-5-数组查询"><a href="#_3-2-5-数组查询" class="header-anchor">#</a> 3.2.5 数组查询</h4> <blockquote><p>数据准备：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.insertMany<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span> item: <span class="token string">&quot;journal&quot;</span>, qty: <span class="token number">25</span>, tags: <span class="token punctuation">[</span><span class="token string">&quot;blank&quot;</span>, <span class="token string">&quot;red&quot;</span><span class="token punctuation">]</span>, dim_cm: <span class="token punctuation">[</span> <span class="token number">14</span>, <span class="token number">21</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>, 
    <span class="token punctuation">{</span> item: <span class="token string">&quot;notebook&quot;</span>, qty: <span class="token number">50</span>, tags: <span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span>, <span class="token string">&quot;blank&quot;</span><span class="token punctuation">]</span>, dim_cm: <span class="token punctuation">[</span> <span class="token number">14</span>, <span class="token number">21</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>,
    <span class="token punctuation">{</span> item: <span class="token string">&quot;paper&quot;</span>, qty: <span class="token number">100</span>, tags: <span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span>, <span class="token string">&quot;blank&quot;</span>, <span class="token string">&quot;plain&quot;</span><span class="token punctuation">]</span>, dim_cm: <span class="token punctuation">[</span> <span class="token number">14</span>, <span class="token number">21</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>,
    <span class="token punctuation">{</span> item: <span class="token string">&quot;planner&quot;</span>, qty: <span class="token number">75</span>, tags: <span class="token punctuation">[</span><span class="token string">&quot;blank&quot;</span>, <span class="token string">&quot;red&quot;</span><span class="token punctuation">]</span>, dim_cm: <span class="token punctuation">[</span> <span class="token number">22.85</span>, <span class="token number">30</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>,  
    <span class="token punctuation">{</span> item: <span class="token string">&quot;postcard&quot;</span>, qty: <span class="token number">45</span>, tags: <span class="token punctuation">[</span><span class="token string">&quot;blue&quot;</span><span class="token punctuation">]</span>, dim_cm: <span class="token punctuation">[</span> <span class="token number">10</span>, <span class="token number">15.25</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></blockquote> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># 查询 tags 值是按指定顺序恰好具有两个元素&quot;red&quot; 和&quot;blank&quot;的数组</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> tags: <span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span>, <span class="token string">&quot;blank&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>

<span class="token comment"># 查询一个同时包含元素“red”和“blank”的数组，而不考虑顺序或该数组中的其他元素，用 $all</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> tags: <span class="token punctuation">{</span> <span class="token variable">$all</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span>, <span class="token string">&quot;blank&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>

<span class="token comment"># 查询元素中的 tag 有 “red” 的数组</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> tags: <span class="token string">&quot;red&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>

<span class="token comment"># 查询数组 dim_cm 包含至少一个值大于25的元素的所有文档</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> dim_cm: <span class="token punctuation">{</span> <span class="token variable">$gt</span><span class="token builtin class-name">:</span> <span class="token number">25</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>

<span class="token comment"># 查询在 dim_cm 数组中包含至少一个同时大于 ($gt)22 和小于 ($lt) 30的元素的文档，用 $elemMatch</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> dim_cm: <span class="token punctuation">{</span> <span class="token variable">$elemMatch</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token variable">$gt</span><span class="token builtin class-name">:</span> <span class="token number">22</span>, <span class="token variable">$lt</span><span class="token builtin class-name">:</span> <span class="token number">30</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>

<span class="token comment"># 查询数组 dim_cm 中第 2 个元素大于 25 的所有文档，用数组下表</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> <span class="token string">&quot;dim_cm.1&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token variable">$gt</span><span class="token builtin class-name">:</span> <span class="token number">25</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>

<span class="token comment"># 数组 tags 具有 3 个元素的文档，用 $size</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> <span class="token string">&quot;tags&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token variable">$size</span><span class="token builtin class-name">:</span> <span class="token number">3</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div><h4 id="_3-2-6-空字段和不存在的字段查询"><a href="#_3-2-6-空字段和不存在的字段查询" class="header-anchor">#</a> 3.2.6 空字段和不存在的字段查询</h4> <ul><li><p>平等过滤器</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># {item：null} 查询匹配包含值是 null 的 item 字段或不包含 item 字段的文档</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> item: null <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div></li> <li><p>类型检查</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># {item：{$ type：10}} 查询只匹配包含 item 字段值为 null 的文档； 即 item 字段的值为 BSON Type 为 Null（类型编号 10）：</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> item <span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token variable">$type</span><span class="token builtin class-name">:</span> <span class="token number">10</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div></li> <li><p>存在检查</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># {item：{$ exists：false}} 查询与不包含 item 字段的文档匹配</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> item <span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token variable">$exists</span><span class="token builtin class-name">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div></li></ul> <h3 id="_3-3-更新文档"><a href="#_3-3-更新文档" class="header-anchor">#</a> 3.3 更新文档</h3> <ul><li><code>db.collection.updateOne(&lt;filter&gt;, &lt;update&gt;, &lt;options&gt;)</code>：更新一个，没有则创建</li> <li><code>db.collection.updateMany(&lt;filter&gt;, &lt;update&gt;, &lt;options&gt;)</code>：更新多个，没有则创建</li> <li><code>db.collection.replaceOne(&lt;filter&gt;, &lt;update&gt;, &lt;options&gt;)</code>：替换一个</li> <li><code>db.collection.update(&lt;filter&gt;, &lt;update&gt;, &lt;options&gt;)</code>：更新一个或多个或替换，默认单个</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>db.collection.update<span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>query<span class="token operator">&gt;</span>, <span class="token operator">&lt;</span>update<span class="token operator">&gt;</span>, <span class="token punctuation">{</span>
    upsert: <span class="token operator">&lt;</span>boolean<span class="token operator">&gt;</span>,
    multi: <span class="token operator">&lt;</span>boolean<span class="token operator">&gt;</span>,  <span class="token comment"># 是否更新多个</span>
    writeConcern: <span class="token operator">&lt;</span>document<span class="token operator">&gt;</span>,
    collation: <span class="token operator">&lt;</span>document<span class="token operator">&gt;</span>,
    arrayFilters: <span class="token punctuation">[</span> <span class="token operator">&lt;</span>filterdocument<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>, <span class="token punctuation">..</span>. <span class="token punctuation">]</span>,
    hint: <span class="token operator">&lt;</span>document<span class="token operator">|</span>string<span class="token operator">&gt;</span> <span class="token comment"># MongoDB 4.2 后可用</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div><p>更新示例：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.updateOne<span class="token punctuation">(</span>
   <span class="token punctuation">{</span> item: <span class="token string">&quot;paper&quot;</span> <span class="token punctuation">}</span>,
   <span class="token punctuation">{</span>
     <span class="token variable">$set</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;size.uom&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;cm&quot;</span>, status: <span class="token string">&quot;P&quot;</span> <span class="token punctuation">}</span>,
     <span class="token variable">$currentDate</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> lastModified: <span class="token boolean">true</span> <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div><ul><li><code>$set</code>：修改一个字段，如果该字段不存在，则创建该字段</li> <li><code>$currentDate</code>：将 <code>lastModified</code> 字段更改为当前时间值，如果该字段不存在，则创建</li></ul> <p>替换示例：</p> <ul><li>要替换 <code>_id</code> 字段以外的文档的全部内容，可以将一个全新的文档作为第二个参数传递给 <code>db.collection.replaceOne</code>。</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># 替换了 inventory 集合中的第一个文件，其中 item 为 &quot;paper&quot;</span>
db.inventory.replaceOne<span class="token punctuation">(</span>
   <span class="token punctuation">{</span> item: <span class="token string">&quot;paper&quot;</span> <span class="token punctuation">}</span>,
   <span class="token punctuation">{</span> item: <span class="token string">&quot;paper&quot;</span>, instock: <span class="token punctuation">[</span> <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;A&quot;</span>, qty: <span class="token number">60</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> warehouse: <span class="token string">&quot;B&quot;</span>, qty: <span class="token number">40</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">注意</p> <ul><li>替换
<ul><li>当替换一个文档时，替换文档必须只包含字段/值对，即不包括更新操作符表达式。</li> <li>替换文档可以具有与原始文档不同的字段。在替换文档中，由于 <code>_id</code> 字段是不可变的，因此可以省略 <code>_id</code> 字段。但是，如果你确实包含 <code>_id</code> 字段，则它必须与当前值具有相同的值。</li></ul></li> <li>原子性
<ul><li>MongoDB 中的所有写操作都是单个文档级别上的原子操作。</li></ul></li> <li>_id
<ul><li><code>_id</code> 值不可变，也无法将现有文档替换为具有不同 <code>_id</code> 值的文档</li></ul></li></ul></div> <h3 id="_3-4-删除文档"><a href="#_3-4-删除文档" class="header-anchor">#</a> 3.4 删除文档</h3> <ul><li><code>db.collection.deleteMany(&lt;filter&gt;)</code>：删除多个</li> <li><code>db.collection.deletOne(&lt;filter&gt;)</code>：删除单个</li> <li><code>db.collection.remover(&lt;filter&gt;, &lt;justone&gt;)</code>：删除单个或多个，用 <code>justone</code> 字段来指定是否删除单个</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>db.inventory.deleteOne<span class="token punctuation">(</span> <span class="token punctuation">{</span> status: <span class="token string">&quot;D&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div><!----></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">11/25/2021, 7:13:25 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/noteSite/backend/middleware/mongodb/02-mongodb-install.html" class="prev">
        二、MongoDB 单机部署
      </a></span> <span class="next"><a href="/noteSite/backend/middleware/mongodb/04-mongodb-aggregation.html">
        四、MongoDB 聚合
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/noteSite/assets/js/app.4a435a5c.js" defer></script><script src="/noteSite/assets/js/2.691adf44.js" defer></script><script src="/noteSite/assets/js/79.5d168739.js" defer></script>
  </body>
</html>
