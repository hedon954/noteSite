(window.webpackJsonp=window.webpackJsonp||[]).push([[99],{510:function(t,s,a){"use strict";a.r(s);var n=a(47),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"三、mongodb-crud"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、mongodb-crud"}},[t._v("#")]),t._v(" 三、MongoDB CRUD")]),t._v(" "),a("blockquote",[a("p",[t._v("参考：")]),t._v(" "),a("ul",[a("li",[t._v("https://docs.mongoing.com/mongodb-crud-operations")]),t._v(" "),a("li",[t._v("https://docs.mongodb.com/manual/crud/")])])]),t._v(" "),a("h2",{attrs:{id:"_1-数据库-database"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-数据库-database"}},[t._v("#")]),t._v(" 1. 数据库 database")]),t._v(" "),a("h3",{attrs:{id:"_1-1-创建数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-创建数据库"}},[t._v("#")]),t._v(" 1.1 创建数据库")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("use dbname")])])]),t._v(" "),a("p",[t._v("数据库不在则会自动创建。")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("数据库命名规则")]),t._v(" "),a("p",[t._v("数据库名可以是满足以下条件的任意 UTF-8 字符串：")]),t._v(" "),a("ul",[a("li",[t._v("不能是空字符串")]),t._v(" "),a("li",[t._v("不得含有 "),a("code",[t._v("''")]),t._v("（空格）、"),a("code",[t._v(".")]),t._v("、"),a("code",[t._v("$")]),t._v("、"),a("code",[t._v("/")]),t._v("、"),a("code",[t._v("\\")]),t._v(" 和 "),a("code",[t._v("\\0")]),t._v("（空字符）")]),t._v(" "),a("li",[t._v("应全部小写")]),t._v(" "),a("li",[t._v("最多 64 字节")])]),t._v(" "),a("p",[t._v("有一些数据库名是保留的，可以直接访问这些有特殊作用的数据库：")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("admin")]),t._v("：从权限的角度看，这是个 “root” 数据库。要是一个用户添加到这个数据库，这个用户自动继承所有数据库的权限。一些特定的服务器端命令也只能从这个数据库运行，比如列出所有的数据库或者关闭服务器。")]),t._v(" "),a("li",[a("strong",[t._v("local")]),t._v("：这个数据库永远不会被复制，可以用来存储限于本地单台服务器的任意集合。")]),t._v(" "),a("li",[a("strong",[t._v("config")]),t._v("：当 mongo 用于分片配置时，config 数据库在内部使用，用于保存分片的相关信息。")])])]),t._v(" "),a("h3",{attrs:{id:"_1-2-删除数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-删除数据库"}},[t._v("#")]),t._v(" 1.2 删除数据库")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("db.dropDatabase()")])])]),t._v(" "),a("p",[t._v("主要用来删除提交持久化的数据库。")]),t._v(" "),a("h3",{attrs:{id:"_1-3-查看数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-查看数据库"}},[t._v("#")]),t._v(" 1.3 查看数据库")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("show dbs")]),t._v("：查看所有数据库，只有当 db 里面有数据了，才会被持久化到磁盘当中，否则只在内存里面的话，用 show dbs 是查不到的。")]),t._v(" "),a("li",[a("code",[t._v("db")]),t._v("：查看当前使用的数据库。")])]),t._v(" "),a("p",[t._v("MongoDB 默认的数据库为 test，如果你没有选择数据库，集合将存放在 test 数据库中。")]),t._v(" "),a("h2",{attrs:{id:"_2-集合-collection"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-集合-collection"}},[t._v("#")]),t._v(" 2. 集合 collection")]),t._v(" "),a("h3",{attrs:{id:"_2-1-创建集合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-创建集合"}},[t._v("#")]),t._v(" 2.1 创建集合")]),t._v(" "),a("h4",{attrs:{id:"_2-1-1-显式创建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-1-显式创建"}},[t._v("#")]),t._v(" 2.1.1 显式创建")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("db.createCollection(name)")])])]),t._v(" "),a("h4",{attrs:{id:"_2-1-2-隐式创建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-2-隐式创建"}},[t._v("#")]),t._v(" 2.1.2 隐式创建")]),t._v(" "),a("ul",[a("li",[t._v("当向一个集合中插入一个文档的时候，如果集合不存在，则会自动创建集合。")])]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("集合命名规范")]),t._v(" "),a("ul",[a("li",[t._v('集合名不能是空字符串""。')]),t._v(" "),a("li",[t._v("集合名不能含有 \\0 字符（空字符），这个字符表示集合名的结尾。")]),t._v(" "),a("li",[t._v('集合名不能以 "system."开头，这是为系统集合保留的前缀。')]),t._v(" "),a("li",[t._v("用户创建的集合名字不能含有保留字符。有些驱动程序的确支持在集名里面包含，这是因为某些系统生成的集合中包含该字符。除非你要访问这种系统创建的集合，否则千万不要在名字里出现 $。")])])]),t._v(" "),a("h3",{attrs:{id:"_2-2-删除集合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-删除集合"}},[t._v("#")]),t._v(" 2.2 删除集合")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("db.collectionName.drop()")])])]),t._v(" "),a("p",[t._v("如果成功删除选定集合，则 drop() 方法返回 true，否则返回 false。")]),t._v(" "),a("h3",{attrs:{id:"_2-2-查看集合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-查看集合"}},[t._v("#")]),t._v(" 2.2 查看集合")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("show collections")])]),t._v(" "),a("li",[a("code",[t._v("show tables")])])]),t._v(" "),a("h2",{attrs:{id:"_3-文档-document"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-文档-document"}},[t._v("#")]),t._v(" 3. 文档 document")]),t._v(" "),a("h3",{attrs:{id:"_3-1-插入文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-插入文档"}},[t._v("#")]),t._v(" 3.1 插入文档")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("db.collection.insertOne()")]),t._v("：插入单个")]),t._v(" "),a("li",[a("code",[t._v("db.collection.insertMany()")]),t._v("：插入多个")]),t._v(" "),a("li",[a("code",[t._v("db.collection.insert()")]),t._v("：插入单个或多个")]),t._v(" "),a("li",[a("code",[t._v("db.collection.save()")]),t._v(": 插入，底层调用 insert")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("db.collection.insert"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("document or array of document"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\twriteConcern: "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("document"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(",  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 写关注，可选")]),t._v("\n\t\tordered: "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("boolean"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("         "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 是否按顺序插入，默认为 true")]),t._v("\n                                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# true：有一个文档出现错误，则停止插入，返回还没处理的剩余的文档")]),t._v("\n                                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# false：如果出错，则继续处理后面的文档")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("补充")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("创建或插入操作会将新文档添加到集合中。 如果该集合当前不存在，则插入操作将创建该集合。")])]),t._v(" "),a("li",[a("p",[t._v("在MongoDB中，插入操作针对单个集合。 MongoDB中的所有写操作都是单个文档级别的"),a("a",{attrs:{href:"https://docs.mongodb.com/master/core/write-operations-atomicity/",target:"_blank",rel:"noopener noreferrer"}},[t._v("原子"),a("OutboundLink")],1),t._v("操作。")]),t._v(" "),a("p",[t._v("In MongoDB, a write operation is "),a("a",{attrs:{href:"https://docs.mongodb.com/v5.0/reference/glossary/#std-term-atomic-operation",target:"_blank",rel:"noopener noreferrer"}},[t._v("atomic"),a("OutboundLink")],1),t._v(" on the level of a single document, even if the operation modifies multiple embedded documents "),a("em",[t._v("within")]),t._v(" a single document.")])]),t._v(" "),a("li",[a("p",[t._v("在 MongoDB 中，存储在集合中的每个文档都需要一个唯一的 "),a("code",[t._v("_id")]),t._v(" 字段作为主键。 如果插入的文档省略 "),a("code",[t._v("_id")]),t._v(" 字段，则 MongoDB 驱动程序会自动为 "),a("code",[t._v("_id")]),t._v(" 字段生成 "),a("code",[t._v("ObjectId")]),t._v("。")])]),t._v(" "),a("li",[a("p",[t._v("插入当前日期，用 "),a("code",[t._v("new Date()")]),t._v("。")])]),t._v(" "),a("li",[a("p",[t._v("MongoDB 中的数字，默认情况下是 "),a("code",[t._v("double")]),t._v(" 类型，如果要存整型，必须使用函数 "),a("code",[t._v("NumberInt(整型数字)")]),t._v("，否则取出来就有问题了。")])]),t._v(" "),a("li",[a("p",[t._v("如果某字段没值，可以赋值为 null，或不写该字段。")])])])]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("insertOne、insertMany、insert 的区别")]),t._v(" "),a("ol",[a("li",[t._v("三者返回的错误信息不一样；")]),t._v(" "),a("li",[t._v("insertOne、insertMany 不支持 db.collection.explain() 命令。")])])]),t._v(" "),a("h4",{attrs:{id:"_3-1-1-插入一个文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-1-插入一个文档"}},[t._v("#")]),t._v(" 3.1.1 插入一个文档")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db.hedon.insertOne"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" name: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hedon"')]),t._v(", age: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(", address: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"beijing"')]),t._v(", tags: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"student"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"software developer"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", body: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("weight: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("70")]),t._v(", height: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("199")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"acknowledged"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" true,\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"insertedId"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" ObjectId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"6115e5c33e8322a9d326c23f"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[a("code",[t._v("insertOne")]),t._v(" 返回一个文档，其中包含新插入的文档的 "),a("code",[t._v("_id")]),t._v(" 字段值。")]),t._v(" "),a("p",[t._v("查看刚刚插入的文档：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db.hedon.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hedon"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_id"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" ObjectId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"6115e5c33e8322a9d326c23f"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hedon"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"age"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"address"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"beijing"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tags"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"student"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"software developer"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"body"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"weight"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("70")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"height"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("199")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),a("ol",[a("li",[t._v("文档中的键值对是有序的。")]),t._v(" "),a("li",[t._v("文档中的值不仅可以是在双引号里面的字符串，还可以是其他几种数据类型（甚至可以是整个嵌入的文档）。")]),t._v(" "),a("li",[t._v("MongoDB 区分类型和大小写。")]),t._v(" "),a("li",[t._v("MongoDB 的文档不能有重复的键。")]),t._v(" "),a("li",[t._v("文档的键是字符串。除了少数例外情况，键可以使用任意 UTF-8 字符。")])]),t._v(" "),a("p",[t._v("文档键命名规范:")]),t._v(" "),a("ol",[a("li",[t._v("键不能含有 "),a("code",[t._v("\\0")]),t._v("（空字符），这个字符用来表示键的结尾；")]),t._v(" "),a("li",[a("code",[t._v(".")]),t._v(" 和 "),a("code",[t._v("$")]),t._v(" 有特别的意义，只有在特定环境下才能使用；")]),t._v(" "),a("li",[t._v("以下划线 "),a("code",[t._v('"_"')]),t._v(" 开头的键是保留的（不是严格要求的）。")])])]),t._v(" "),a("h4",{attrs:{id:"_3-1-2-插入多个文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-2-插入多个文档"}},[t._v("#")]),t._v(" 3.1.2 插入多个文档")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db.hedon.insertMany"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" name: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"jack"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" name: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"windy"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" name: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"wuyifan"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"acknowledged"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" true,\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"insertedIds"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n\t\tObjectId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"6115e6633e8322a9d326c240"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",\n\t\tObjectId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"6115e6633e8322a9d326c241"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",\n\t\tObjectId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"6115e6633e8322a9d326c242"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h4",{attrs:{id:"_3-1-3-主键"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-3-主键"}},[t._v("#")]),t._v(" 3.1.3 主键")]),t._v(" "),a("p",[a("strong",[t._v("ObjectId")])]),t._v(" "),a("p",[a("strong",[t._v("自定义主键")])]),t._v(" "),a("p",[a("strong",[t._v("复合主键")])]),t._v(" "),a("h3",{attrs:{id:"_3-2-查询文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-查询文档"}},[t._v("#")]),t._v(" 3.2 查询文档")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("db.collection.find(<query>, [projection])")])])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Parameter")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("query")]),t._v(" "),a("td",[t._v("document")]),t._v(" "),a("td",[t._v("可选。使用查询运算符指定选择筛选器。若要返回集合中的所有文档，请省略此参数或传递空文档 ( {} )。")])]),t._v(" "),a("tr",[a("td",[t._v("projection")]),t._v(" "),a("td",[t._v("document")]),t._v(" "),a("td",[t._v("可选。指定要在与查询筛选器匹配的文档中返回的字段（投影）。若要返回匹配文档中的所有字段， 请省略此参数。")])])])]),t._v(" "),a("blockquote",[a("p",[t._v("方便下面案例，请先插入数据：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("db.inventory.insertMany"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"journal"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"notebook"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),t._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.5")]),t._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"in"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"paper"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.5")]),t._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"in"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"planner"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("75")]),t._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("22.85")]),t._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"postcard"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("45")]),t._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15.25")]),t._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])]),t._v(" "),a("h4",{attrs:{id:"_3-2-1-查询所有"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-1-查询所有"}},[t._v("#")]),t._v(" 3.2.1 查询所有")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db.inventory."),a("span",{pre:!0,attrs:{class:"token function-name function"}},[t._v("find")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_id"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" ObjectId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"6115ec3e3e8322a9d326c243"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"item"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"journal"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"qty"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"size"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"h"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"w"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"uom"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"status"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_id"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" ObjectId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"6115ec3e3e8322a9d326c244"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"item"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"notebook"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"qty"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"size"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"h"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.5")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"w"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"uom"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"in"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"status"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_id"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" ObjectId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"6115ec3e3e8322a9d326c245"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"item"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"paper"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"qty"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"size"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"h"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.5")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"w"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"uom"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"in"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"status"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_id"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" ObjectId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"6115ec3e3e8322a9d326c246"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"item"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"planner"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"qty"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("75")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"size"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"h"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("22.85")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"w"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"uom"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"status"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_id"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" ObjectId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"6115ec3e3e8322a9d326c247"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"item"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"postcard"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"qty"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("45")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"size"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"h"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"w"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15.25")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"uom"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"status"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h4",{attrs:{id:"_3-2-2-条件查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-2-条件查询"}},[t._v("#")]),t._v(" 3.2.2 条件查询")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("EQUAL")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("db.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" status: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("GT/LT/GTE/LTE")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("db.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" qty: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$lt")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("IN")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("db.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" status: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$in")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("尽管可以使用 "),a("code",[t._v("$or")]),t._v(" 操作符表示此查询，但在对同一字段执行相等性检查时，请使用 "),a("code",[t._v("$in")]),t._v(" 操作符而不是 "),a("code",[t._v("$or")]),t._v(" 操作符，因为 "),a("code",[t._v("$in")]),t._v(" 可以走索引，查询效率更高。")])])]),t._v(" "),a("li",[a("p",[t._v("AND")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("db.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" status: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$lt")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("OR")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("db.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$or")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" status: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" qty: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$lt")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("AND & OR")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("db.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     status: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(",\n     "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$or")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" qty: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$lt")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"journal"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("REGEX")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("db.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     status: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(",\n     "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$or")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" qty: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$lt")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: /^p/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("MongoDB支持正则表达式 "),a("code",[t._v("$regex")]),t._v(" 查询来执行字符串模式匹配。")])])])]),t._v(" "),a("h4",{attrs:{id:"_3-2-3-投影查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-3-投影查询"}},[t._v("#")]),t._v(" 3.2.3 投影查询")]),t._v(" "),a("p",[t._v("默认情况下，MongoDB 中的查询返回匹配文档中的所有字段。 要限制 MongoDB 发送给应用程序的数据量，可以包含一个 "),a("code",[t._v("projection")]),t._v(" 文档以指定或限制要返回的字段。")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("fieldName: 1")]),t._v("：显示 "),a("code",[t._v("filedName")]),t._v(" 字段，"),a("code",[t._v("_id")]),t._v(" 字段默认为 1")]),t._v(" "),a("li",[a("code",[t._v("fieldName: 0")]),t._v("：不显示 "),a("code",[t._v("fieldName")]),t._v(" 字段")])]),t._v(" "),a("p",[t._v("如果 "),a("code",[t._v("projection")]),t._v(" 中只有 "),a("code",[t._v("0")]),t._v("，那就是排除掉指定的 "),a("code",[t._v("field")]),t._v("。")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 仅查询 _id, item, status")]),t._v("\ndb.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" status: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", status: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 仅查询 item, status")]),t._v("\ndb.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" status: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", status: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", _id: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 不要 status 和 instock 字段")]),t._v("\ndb.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" status: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" status: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(", instock: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 返回嵌入式文档中的特定字段")]),t._v("\ndb.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" status: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", status: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"size.uom"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 禁止嵌入文档中的特定字段")]),t._v("\ndb.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" \n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" status: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"size.uom"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 返回数组中的项目特定数组元素，-1 表示最后一个元素")]),t._v("\ndb.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" status: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", status: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", instock: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$slice")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" -1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("对于包含数组的字段，MongoDB 提供以下用于操纵数组的投影运算符："),a("code",[t._v("$elemMatch")]),t._v("、"),a("code",[t._v("$slice")]),t._v("、"),a("code",[t._v("$")]),t._v("。"),a("code",[t._v("$elemMatch")]),t._v("、"),a("code",[t._v("$slice")]),t._v(" 和 "),a("code",[t._v("$")]),t._v("  是 projection 要包含在返回数组中的特定元素的唯一方法。 例如，您不能使用数组索引来投影特定的数组元素。 例如 "),a("strong",[t._v("{“ instock.0”: 1}")]),t._v(" 是不会返回数组的第一个元素的。")])]),t._v(" "),a("h4",{attrs:{id:"_3-2-4-嵌入式文档查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-4-嵌入式文档查询"}},[t._v("#")]),t._v(" 3.2.4 嵌入式文档查询")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("db.inventory.insertMany"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"journal"')]),t._v(", instock: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" warehouse: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" warehouse: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"C"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",  \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"notebook"')]),t._v(", instock: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" warehouse: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"C"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"paper"')]),t._v(", instock: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" warehouse: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" warehouse: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"B"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"planner"')]),t._v(", instock: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" warehouse: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("40")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" warehouse: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"B"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"postcard"')]),t._v(", instock: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" warehouse: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"B"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" warehouse: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"C"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("35")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("ul",[a("li",[t._v("上面插入的结构中，"),a("code",[t._v("instock")]),t._v(" 是一个数组，其中每一个元素都是一个 document。我们可以直接对数据里面的元素进行条件查询。")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("db.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"instock"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" warehouse: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("整个嵌入式/嵌套文档上的相等匹配要求与指定文档（包括字段 "),a("strong",[t._v("顺序")]),t._v("）完全匹配。 例如，以下查询与 "),a("strong",[t._v("inventory")]),t._v(" 中的任何文档都不匹配")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("db.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"instock"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(", warehouse: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),a("h4",{attrs:{id:"_3-2-5-数组查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-5-数组查询"}},[t._v("#")]),t._v(" 3.2.5 数组查询")]),t._v(" "),a("blockquote",[a("p",[t._v("数据准备：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("db.inventory.insertMany"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"journal"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(", tags: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"blank"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"red"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", dim_cm: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"notebook"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),t._v(", tags: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"red"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"blank"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", dim_cm: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"paper"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v(", tags: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"red"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"blank"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"plain"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", dim_cm: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"planner"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("75")]),t._v(", tags: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"blank"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"red"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", dim_cm: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("22.85")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",  \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"postcard"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("45")]),t._v(", tags: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"blue"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", dim_cm: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15.25")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# 查询 tags 值是按指定顺序恰好具有两个元素"red" 和"blank"的数组')]),t._v("\ndb.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" tags: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"red"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"blank"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查询一个同时包含元素“red”和“blank”的数组，而不考虑顺序或该数组中的其他元素，用 $all")]),t._v("\ndb.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" tags: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$all")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"red"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"blank"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查询元素中的 tag 有 “red” 的数组")]),t._v("\ndb.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" tags: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"red"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查询数组 dim_cm 包含至少一个值大于25的元素的所有文档")]),t._v("\ndb.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" dim_cm: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$gt")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查询在 dim_cm 数组中包含至少一个同时大于 ($gt)22 和小于 ($lt) 30的元素的文档，用 $elemMatch")]),t._v("\ndb.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" dim_cm: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$elemMatch")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$gt")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$lt")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查询数组 dim_cm 中第 2 个元素大于 25 的所有文档，用数组下表")]),t._v("\ndb.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dim_cm.1"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$gt")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 数组 tags 具有 3 个元素的文档，用 $size")]),t._v("\ndb.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tags"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$size")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h4",{attrs:{id:"_3-2-6-空字段和不存在的字段查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-6-空字段和不存在的字段查询"}},[t._v("#")]),t._v(" 3.2.6 空字段和不存在的字段查询")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("平等过滤器")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# {item：null} 查询匹配包含值是 null 的 item 字段或不包含 item 字段的文档")]),t._v("\ndb.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: null "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("类型检查")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# {item：{$ type：10}} 查询只匹配包含 item 字段值为 null 的文档； 即 item 字段的值为 BSON Type 为 Null（类型编号 10）：")]),t._v("\ndb.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$type")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("存在检查")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# {item：{$ exists：false}} 查询与不包含 item 字段的文档匹配")]),t._v("\ndb.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$exists")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])]),t._v(" "),a("h3",{attrs:{id:"_3-3-更新文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-更新文档"}},[t._v("#")]),t._v(" 3.3 更新文档")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("db.collection.updateOne(<filter>, <update>, <options>)")]),t._v("：更新一个，没有则创建")]),t._v(" "),a("li",[a("code",[t._v("db.collection.updateMany(<filter>, <update>, <options>)")]),t._v("：更新多个，没有则创建")]),t._v(" "),a("li",[a("code",[t._v("db.collection.replaceOne(<filter>, <update>, <options>)")]),t._v("：替换一个")]),t._v(" "),a("li",[a("code",[t._v("db.collection.update(<filter>, <update>, <options>)")]),t._v("：更新一个或多个或替换，默认单个")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("db.collection.update"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("query"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("update"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    upsert: "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("boolean"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(",\n    multi: "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("boolean"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(",  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 是否更新多个")]),t._v("\n    writeConcern: "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("document"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(",\n    collation: "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("document"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(",\n    arrayFilters: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("filterdocument"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\n    hint: "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("document"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("string"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# MongoDB 4.2 后可用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("更新示例：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("db.inventory.updateOne"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"paper"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$set")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"size.uom"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"P"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n     "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$currentDate")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" lastModified: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ul",[a("li",[a("code",[t._v("$set")]),t._v("：修改一个字段，如果该字段不存在，则创建该字段")]),t._v(" "),a("li",[a("code",[t._v("$currentDate")]),t._v("：将 "),a("code",[t._v("lastModified")]),t._v(" 字段更改为当前时间值，如果该字段不存在，则创建")])]),t._v(" "),a("p",[t._v("替换示例：")]),t._v(" "),a("ul",[a("li",[t._v("要替换 "),a("code",[t._v("_id")]),t._v(" 字段以外的文档的全部内容，可以将一个全新的文档作为第二个参数传递给 "),a("code",[t._v("db.collection.replaceOne")]),t._v("。")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# 替换了 inventory 集合中的第一个文件，其中 item 为 "paper"')]),t._v("\ndb.inventory.replaceOne"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"paper"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"paper"')]),t._v(", instock: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" warehouse: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" warehouse: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"B"')]),t._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("40")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),a("ul",[a("li",[t._v("替换\n"),a("ul",[a("li",[t._v("当替换一个文档时，替换文档必须只包含字段/值对，即不包括更新操作符表达式。")]),t._v(" "),a("li",[t._v("替换文档可以具有与原始文档不同的字段。在替换文档中，由于 "),a("code",[t._v("_id")]),t._v(" 字段是不可变的，因此可以省略 "),a("code",[t._v("_id")]),t._v(" 字段。但是，如果你确实包含 "),a("code",[t._v("_id")]),t._v(" 字段，则它必须与当前值具有相同的值。")])])]),t._v(" "),a("li",[t._v("原子性\n"),a("ul",[a("li",[t._v("MongoDB 中的所有写操作都是单个文档级别上的原子操作。")])])]),t._v(" "),a("li",[t._v("_id\n"),a("ul",[a("li",[a("code",[t._v("_id")]),t._v(" 值不可变，也无法将现有文档替换为具有不同 "),a("code",[t._v("_id")]),t._v(" 值的文档")])])])])]),t._v(" "),a("h3",{attrs:{id:"_3-4-删除文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-删除文档"}},[t._v("#")]),t._v(" 3.4 删除文档")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("db.collection.deleteMany(<filter>)")]),t._v("：删除多个")]),t._v(" "),a("li",[a("code",[t._v("db.collection.deletOne(<filter>)")]),t._v("：删除单个")]),t._v(" "),a("li",[a("code",[t._v("db.collection.remover(<filter>, <justone>)")]),t._v("：删除单个或多个，用 "),a("code",[t._v("justone")]),t._v(" 字段来指定是否删除单个")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("db.inventory.deleteOne"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" status: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("Vssue")],1)}),[],!1,null,null,null);s.default=e.exports}}]);