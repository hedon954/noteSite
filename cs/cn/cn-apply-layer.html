<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>五、应用层 | Hedon</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/noteSite/favicon.ico">
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/noteSite/assets/css/0.styles.0f3b0cbd.css" as="style"><link rel="preload" href="/noteSite/assets/js/app.dbdfff04.js" as="script"><link rel="preload" href="/noteSite/assets/js/2.6ff1f0ac.js" as="script"><link rel="preload" href="/noteSite/assets/js/187.27815247.js" as="script"><link rel="prefetch" href="/noteSite/assets/js/10.628f2b18.js"><link rel="prefetch" href="/noteSite/assets/js/100.3d1a5c81.js"><link rel="prefetch" href="/noteSite/assets/js/101.d269e6bb.js"><link rel="prefetch" href="/noteSite/assets/js/102.ead2000c.js"><link rel="prefetch" href="/noteSite/assets/js/103.a3bf1dbd.js"><link rel="prefetch" href="/noteSite/assets/js/104.cfa69812.js"><link rel="prefetch" href="/noteSite/assets/js/105.e6169f7e.js"><link rel="prefetch" href="/noteSite/assets/js/106.29718338.js"><link rel="prefetch" href="/noteSite/assets/js/107.8bfccb65.js"><link rel="prefetch" href="/noteSite/assets/js/108.c2eb139a.js"><link rel="prefetch" href="/noteSite/assets/js/109.816344eb.js"><link rel="prefetch" href="/noteSite/assets/js/11.7b8bf963.js"><link rel="prefetch" href="/noteSite/assets/js/110.6cd92fd7.js"><link rel="prefetch" href="/noteSite/assets/js/111.bbec0142.js"><link rel="prefetch" href="/noteSite/assets/js/112.5bf42dbe.js"><link rel="prefetch" href="/noteSite/assets/js/113.35f9fa0e.js"><link rel="prefetch" href="/noteSite/assets/js/114.44381bfd.js"><link rel="prefetch" href="/noteSite/assets/js/115.2c76ad37.js"><link rel="prefetch" href="/noteSite/assets/js/116.3b4b18f5.js"><link rel="prefetch" href="/noteSite/assets/js/117.f69650c9.js"><link rel="prefetch" href="/noteSite/assets/js/118.1a38927a.js"><link rel="prefetch" href="/noteSite/assets/js/119.8db13744.js"><link rel="prefetch" href="/noteSite/assets/js/12.c34daa91.js"><link rel="prefetch" href="/noteSite/assets/js/120.7f41ecc8.js"><link rel="prefetch" href="/noteSite/assets/js/121.d218cf75.js"><link rel="prefetch" href="/noteSite/assets/js/122.57452c9e.js"><link rel="prefetch" href="/noteSite/assets/js/123.4bbf359c.js"><link rel="prefetch" href="/noteSite/assets/js/124.fa89b463.js"><link rel="prefetch" href="/noteSite/assets/js/125.0c941fd1.js"><link rel="prefetch" href="/noteSite/assets/js/126.add326fd.js"><link rel="prefetch" href="/noteSite/assets/js/127.6c2654a7.js"><link rel="prefetch" href="/noteSite/assets/js/128.ad6aa19e.js"><link rel="prefetch" href="/noteSite/assets/js/129.e15508ab.js"><link rel="prefetch" href="/noteSite/assets/js/13.d05dde15.js"><link rel="prefetch" href="/noteSite/assets/js/130.147ac01c.js"><link rel="prefetch" href="/noteSite/assets/js/131.e67594c7.js"><link rel="prefetch" href="/noteSite/assets/js/132.068e675f.js"><link rel="prefetch" href="/noteSite/assets/js/133.e33a1e92.js"><link rel="prefetch" href="/noteSite/assets/js/134.5dc0d37b.js"><link rel="prefetch" href="/noteSite/assets/js/135.8c747a2d.js"><link rel="prefetch" href="/noteSite/assets/js/136.05464e5e.js"><link rel="prefetch" href="/noteSite/assets/js/137.bbe63ed2.js"><link rel="prefetch" href="/noteSite/assets/js/138.4433c4b5.js"><link rel="prefetch" href="/noteSite/assets/js/139.813d6a4f.js"><link rel="prefetch" href="/noteSite/assets/js/14.6195d2f0.js"><link rel="prefetch" href="/noteSite/assets/js/140.9dbbb562.js"><link rel="prefetch" href="/noteSite/assets/js/141.c8c2d8ea.js"><link rel="prefetch" href="/noteSite/assets/js/142.fb6767fd.js"><link rel="prefetch" href="/noteSite/assets/js/143.6f3edcc3.js"><link rel="prefetch" href="/noteSite/assets/js/144.f0c1e248.js"><link rel="prefetch" href="/noteSite/assets/js/145.859c8c50.js"><link rel="prefetch" href="/noteSite/assets/js/146.78dd1b62.js"><link rel="prefetch" href="/noteSite/assets/js/147.849bcfcf.js"><link rel="prefetch" href="/noteSite/assets/js/148.e7b28083.js"><link rel="prefetch" href="/noteSite/assets/js/149.b87b7ab7.js"><link rel="prefetch" href="/noteSite/assets/js/15.ed2e2f3d.js"><link rel="prefetch" href="/noteSite/assets/js/150.abf1e862.js"><link rel="prefetch" href="/noteSite/assets/js/151.9da3ee27.js"><link rel="prefetch" href="/noteSite/assets/js/152.0b3941f8.js"><link rel="prefetch" href="/noteSite/assets/js/153.69581b97.js"><link rel="prefetch" href="/noteSite/assets/js/154.f9660ec4.js"><link rel="prefetch" href="/noteSite/assets/js/155.e89a8c61.js"><link rel="prefetch" href="/noteSite/assets/js/156.efe1b32e.js"><link rel="prefetch" href="/noteSite/assets/js/157.0836a9f6.js"><link rel="prefetch" href="/noteSite/assets/js/158.b0c1435f.js"><link rel="prefetch" href="/noteSite/assets/js/159.a764ccc7.js"><link rel="prefetch" href="/noteSite/assets/js/16.bbb3b0e4.js"><link rel="prefetch" href="/noteSite/assets/js/160.fb1465a5.js"><link rel="prefetch" href="/noteSite/assets/js/161.89984497.js"><link rel="prefetch" href="/noteSite/assets/js/162.6215f2be.js"><link rel="prefetch" href="/noteSite/assets/js/163.a3e3c4cd.js"><link rel="prefetch" href="/noteSite/assets/js/164.d7a86663.js"><link rel="prefetch" href="/noteSite/assets/js/165.2f17ea4e.js"><link rel="prefetch" href="/noteSite/assets/js/166.feb66be5.js"><link rel="prefetch" href="/noteSite/assets/js/167.68a92314.js"><link rel="prefetch" href="/noteSite/assets/js/168.24e93983.js"><link rel="prefetch" href="/noteSite/assets/js/169.ed317945.js"><link rel="prefetch" href="/noteSite/assets/js/17.8b015d56.js"><link rel="prefetch" href="/noteSite/assets/js/170.28453206.js"><link rel="prefetch" href="/noteSite/assets/js/171.81175a4a.js"><link rel="prefetch" href="/noteSite/assets/js/172.bb459e74.js"><link rel="prefetch" href="/noteSite/assets/js/173.5f1f3dd7.js"><link rel="prefetch" href="/noteSite/assets/js/174.ac394194.js"><link rel="prefetch" href="/noteSite/assets/js/175.4faba256.js"><link rel="prefetch" href="/noteSite/assets/js/176.3ba5c3f3.js"><link rel="prefetch" href="/noteSite/assets/js/177.88aad887.js"><link rel="prefetch" href="/noteSite/assets/js/178.bc0a14d5.js"><link rel="prefetch" href="/noteSite/assets/js/179.ef9b049a.js"><link rel="prefetch" href="/noteSite/assets/js/18.d9742110.js"><link rel="prefetch" href="/noteSite/assets/js/180.ebc68b15.js"><link rel="prefetch" href="/noteSite/assets/js/181.66e846fd.js"><link rel="prefetch" href="/noteSite/assets/js/182.5fb7062c.js"><link rel="prefetch" href="/noteSite/assets/js/183.202710af.js"><link rel="prefetch" href="/noteSite/assets/js/184.99a4476c.js"><link rel="prefetch" href="/noteSite/assets/js/185.68cc62f4.js"><link rel="prefetch" href="/noteSite/assets/js/186.708360d6.js"><link rel="prefetch" href="/noteSite/assets/js/188.8c740d90.js"><link rel="prefetch" href="/noteSite/assets/js/189.741c61a9.js"><link rel="prefetch" href="/noteSite/assets/js/19.811bf034.js"><link rel="prefetch" href="/noteSite/assets/js/190.d8b95ca2.js"><link rel="prefetch" href="/noteSite/assets/js/191.47d0ad44.js"><link rel="prefetch" href="/noteSite/assets/js/192.f305241b.js"><link rel="prefetch" href="/noteSite/assets/js/193.cd0ed807.js"><link rel="prefetch" href="/noteSite/assets/js/194.2d088087.js"><link rel="prefetch" href="/noteSite/assets/js/195.bb042bd0.js"><link rel="prefetch" href="/noteSite/assets/js/196.99a92d9a.js"><link rel="prefetch" href="/noteSite/assets/js/197.aafc2d63.js"><link rel="prefetch" href="/noteSite/assets/js/198.01d32971.js"><link rel="prefetch" href="/noteSite/assets/js/199.060f2286.js"><link rel="prefetch" href="/noteSite/assets/js/20.78824865.js"><link rel="prefetch" href="/noteSite/assets/js/200.3aea7d7e.js"><link rel="prefetch" href="/noteSite/assets/js/201.ca6479dd.js"><link rel="prefetch" href="/noteSite/assets/js/202.7e9e2a58.js"><link rel="prefetch" href="/noteSite/assets/js/203.c3222d2d.js"><link rel="prefetch" href="/noteSite/assets/js/204.ed0135d4.js"><link rel="prefetch" href="/noteSite/assets/js/205.c3ebd951.js"><link rel="prefetch" href="/noteSite/assets/js/206.7c51c243.js"><link rel="prefetch" href="/noteSite/assets/js/207.8727d2f0.js"><link rel="prefetch" href="/noteSite/assets/js/208.39e1cfd5.js"><link rel="prefetch" href="/noteSite/assets/js/209.9b566472.js"><link rel="prefetch" href="/noteSite/assets/js/21.3060b19d.js"><link rel="prefetch" href="/noteSite/assets/js/210.11558b76.js"><link rel="prefetch" href="/noteSite/assets/js/211.1583fc79.js"><link rel="prefetch" href="/noteSite/assets/js/212.a835c98a.js"><link rel="prefetch" href="/noteSite/assets/js/213.5ee1312e.js"><link rel="prefetch" href="/noteSite/assets/js/214.71ed8e9c.js"><link rel="prefetch" href="/noteSite/assets/js/215.1fe74f0b.js"><link rel="prefetch" href="/noteSite/assets/js/216.4641e8c7.js"><link rel="prefetch" href="/noteSite/assets/js/217.cf474399.js"><link rel="prefetch" href="/noteSite/assets/js/218.eda994ff.js"><link rel="prefetch" href="/noteSite/assets/js/219.ff310079.js"><link rel="prefetch" href="/noteSite/assets/js/22.f7b382c7.js"><link rel="prefetch" href="/noteSite/assets/js/220.538d10ec.js"><link rel="prefetch" href="/noteSite/assets/js/221.2dc4c8de.js"><link rel="prefetch" href="/noteSite/assets/js/222.ab254ffa.js"><link rel="prefetch" href="/noteSite/assets/js/223.fe2f1e30.js"><link rel="prefetch" href="/noteSite/assets/js/224.f07c05c9.js"><link rel="prefetch" href="/noteSite/assets/js/225.9b7e7d32.js"><link rel="prefetch" href="/noteSite/assets/js/226.29291757.js"><link rel="prefetch" href="/noteSite/assets/js/227.9cd87366.js"><link rel="prefetch" href="/noteSite/assets/js/228.504a771e.js"><link rel="prefetch" href="/noteSite/assets/js/229.28a58da8.js"><link rel="prefetch" href="/noteSite/assets/js/23.e59fce57.js"><link rel="prefetch" href="/noteSite/assets/js/230.68d8fa8b.js"><link rel="prefetch" href="/noteSite/assets/js/231.faa352cf.js"><link rel="prefetch" href="/noteSite/assets/js/232.0a1887b8.js"><link rel="prefetch" href="/noteSite/assets/js/233.d40e6b58.js"><link rel="prefetch" href="/noteSite/assets/js/234.bda5fd11.js"><link rel="prefetch" href="/noteSite/assets/js/235.b4359188.js"><link rel="prefetch" href="/noteSite/assets/js/236.3d8870c2.js"><link rel="prefetch" href="/noteSite/assets/js/237.f8fad403.js"><link rel="prefetch" href="/noteSite/assets/js/238.ab8fba20.js"><link rel="prefetch" href="/noteSite/assets/js/239.d747fd3f.js"><link rel="prefetch" href="/noteSite/assets/js/24.482618e6.js"><link rel="prefetch" href="/noteSite/assets/js/240.a6e05789.js"><link rel="prefetch" href="/noteSite/assets/js/241.b6267449.js"><link rel="prefetch" href="/noteSite/assets/js/242.7d3ce5a2.js"><link rel="prefetch" href="/noteSite/assets/js/243.a0d57af8.js"><link rel="prefetch" href="/noteSite/assets/js/244.f2bd666b.js"><link rel="prefetch" href="/noteSite/assets/js/245.6220f062.js"><link rel="prefetch" href="/noteSite/assets/js/246.1d519355.js"><link rel="prefetch" href="/noteSite/assets/js/247.276a07aa.js"><link rel="prefetch" href="/noteSite/assets/js/248.feeb5255.js"><link rel="prefetch" href="/noteSite/assets/js/249.9ab8b6b8.js"><link rel="prefetch" href="/noteSite/assets/js/25.df04ad1a.js"><link rel="prefetch" href="/noteSite/assets/js/250.48ce7623.js"><link rel="prefetch" href="/noteSite/assets/js/251.6dcc6986.js"><link rel="prefetch" href="/noteSite/assets/js/252.b4632174.js"><link rel="prefetch" href="/noteSite/assets/js/253.5e3f8399.js"><link rel="prefetch" href="/noteSite/assets/js/254.ddf0ec20.js"><link rel="prefetch" href="/noteSite/assets/js/255.f23c0ae2.js"><link rel="prefetch" href="/noteSite/assets/js/256.0681e869.js"><link rel="prefetch" href="/noteSite/assets/js/257.aeb10907.js"><link rel="prefetch" href="/noteSite/assets/js/258.4ca5da3a.js"><link rel="prefetch" href="/noteSite/assets/js/259.1fa4a27a.js"><link rel="prefetch" href="/noteSite/assets/js/26.4eb6fe37.js"><link rel="prefetch" href="/noteSite/assets/js/260.46f6c407.js"><link rel="prefetch" href="/noteSite/assets/js/261.a10138dd.js"><link rel="prefetch" href="/noteSite/assets/js/262.eebeade2.js"><link rel="prefetch" href="/noteSite/assets/js/263.ac3663de.js"><link rel="prefetch" href="/noteSite/assets/js/264.bbeaf4d4.js"><link rel="prefetch" href="/noteSite/assets/js/265.fa302e5b.js"><link rel="prefetch" href="/noteSite/assets/js/266.b9a1dc24.js"><link rel="prefetch" href="/noteSite/assets/js/267.71c1fe95.js"><link rel="prefetch" href="/noteSite/assets/js/268.9fbfc1bb.js"><link rel="prefetch" href="/noteSite/assets/js/269.38e73c65.js"><link rel="prefetch" href="/noteSite/assets/js/27.4f9dbcf8.js"><link rel="prefetch" href="/noteSite/assets/js/270.f15c0996.js"><link rel="prefetch" href="/noteSite/assets/js/271.b900cc61.js"><link rel="prefetch" href="/noteSite/assets/js/272.bfb985f0.js"><link rel="prefetch" href="/noteSite/assets/js/273.c554c143.js"><link rel="prefetch" href="/noteSite/assets/js/274.7a6c31f4.js"><link rel="prefetch" href="/noteSite/assets/js/275.553416a8.js"><link rel="prefetch" href="/noteSite/assets/js/276.5834daf3.js"><link rel="prefetch" href="/noteSite/assets/js/277.0927a885.js"><link rel="prefetch" href="/noteSite/assets/js/278.5f812080.js"><link rel="prefetch" href="/noteSite/assets/js/279.b6ef2ec7.js"><link rel="prefetch" href="/noteSite/assets/js/28.8963a888.js"><link rel="prefetch" href="/noteSite/assets/js/280.2ffdab51.js"><link rel="prefetch" href="/noteSite/assets/js/281.d8659dad.js"><link rel="prefetch" href="/noteSite/assets/js/282.8f696c52.js"><link rel="prefetch" href="/noteSite/assets/js/283.2d2139f4.js"><link rel="prefetch" href="/noteSite/assets/js/284.d87b6f43.js"><link rel="prefetch" href="/noteSite/assets/js/285.887b5cd5.js"><link rel="prefetch" href="/noteSite/assets/js/286.2c1e1093.js"><link rel="prefetch" href="/noteSite/assets/js/287.6cf6ebf2.js"><link rel="prefetch" href="/noteSite/assets/js/288.3e508f18.js"><link rel="prefetch" href="/noteSite/assets/js/289.16d6f14b.js"><link rel="prefetch" href="/noteSite/assets/js/29.6cba673a.js"><link rel="prefetch" href="/noteSite/assets/js/290.1c4098c2.js"><link rel="prefetch" href="/noteSite/assets/js/291.19187d83.js"><link rel="prefetch" href="/noteSite/assets/js/292.a6db7bd0.js"><link rel="prefetch" href="/noteSite/assets/js/293.7dee9d74.js"><link rel="prefetch" href="/noteSite/assets/js/294.9f9c93cb.js"><link rel="prefetch" href="/noteSite/assets/js/295.fdafb305.js"><link rel="prefetch" href="/noteSite/assets/js/296.780d5859.js"><link rel="prefetch" href="/noteSite/assets/js/297.6c3b39ec.js"><link rel="prefetch" href="/noteSite/assets/js/298.45411a92.js"><link rel="prefetch" href="/noteSite/assets/js/299.12dfdf18.js"><link rel="prefetch" href="/noteSite/assets/js/3.cf3dc5d9.js"><link rel="prefetch" href="/noteSite/assets/js/30.0be426ff.js"><link rel="prefetch" href="/noteSite/assets/js/300.645761ea.js"><link rel="prefetch" href="/noteSite/assets/js/301.0e7825c0.js"><link rel="prefetch" href="/noteSite/assets/js/302.aa67e66e.js"><link rel="prefetch" href="/noteSite/assets/js/303.76990d8c.js"><link rel="prefetch" href="/noteSite/assets/js/304.56c1c27f.js"><link rel="prefetch" href="/noteSite/assets/js/305.78809d01.js"><link rel="prefetch" href="/noteSite/assets/js/306.56755e50.js"><link rel="prefetch" href="/noteSite/assets/js/307.6c4e6d84.js"><link rel="prefetch" href="/noteSite/assets/js/308.ccc3ec08.js"><link rel="prefetch" href="/noteSite/assets/js/309.a54a52cb.js"><link rel="prefetch" href="/noteSite/assets/js/31.3affb8bf.js"><link rel="prefetch" href="/noteSite/assets/js/310.d99845e8.js"><link rel="prefetch" href="/noteSite/assets/js/32.9594ce12.js"><link rel="prefetch" href="/noteSite/assets/js/33.eb71398f.js"><link rel="prefetch" href="/noteSite/assets/js/34.85f8d0f4.js"><link rel="prefetch" href="/noteSite/assets/js/35.956398a7.js"><link rel="prefetch" href="/noteSite/assets/js/36.a2f9b5ef.js"><link rel="prefetch" href="/noteSite/assets/js/37.ed56e679.js"><link rel="prefetch" href="/noteSite/assets/js/38.caf7b4b1.js"><link rel="prefetch" href="/noteSite/assets/js/39.3235028f.js"><link rel="prefetch" href="/noteSite/assets/js/4.a61e4cea.js"><link rel="prefetch" href="/noteSite/assets/js/40.8a77435e.js"><link rel="prefetch" href="/noteSite/assets/js/41.bca6e7f2.js"><link rel="prefetch" href="/noteSite/assets/js/42.f1879a29.js"><link rel="prefetch" href="/noteSite/assets/js/43.90753c8e.js"><link rel="prefetch" href="/noteSite/assets/js/44.4385e348.js"><link rel="prefetch" href="/noteSite/assets/js/45.5b47dd8c.js"><link rel="prefetch" href="/noteSite/assets/js/46.60a0b3de.js"><link rel="prefetch" href="/noteSite/assets/js/47.d21f6e89.js"><link rel="prefetch" href="/noteSite/assets/js/48.ed1311a7.js"><link rel="prefetch" href="/noteSite/assets/js/49.3e5206df.js"><link rel="prefetch" href="/noteSite/assets/js/5.2bccd6df.js"><link rel="prefetch" href="/noteSite/assets/js/50.3588740e.js"><link rel="prefetch" href="/noteSite/assets/js/51.6d728c33.js"><link rel="prefetch" href="/noteSite/assets/js/52.9b50022b.js"><link rel="prefetch" href="/noteSite/assets/js/53.32be0296.js"><link rel="prefetch" href="/noteSite/assets/js/54.4faf0f1b.js"><link rel="prefetch" href="/noteSite/assets/js/55.81a03e44.js"><link rel="prefetch" href="/noteSite/assets/js/56.e8e5e0f5.js"><link rel="prefetch" href="/noteSite/assets/js/57.9b1edf79.js"><link rel="prefetch" href="/noteSite/assets/js/58.5acd6529.js"><link rel="prefetch" href="/noteSite/assets/js/59.b72530bd.js"><link rel="prefetch" href="/noteSite/assets/js/6.f3d86aa7.js"><link rel="prefetch" href="/noteSite/assets/js/60.42583b94.js"><link rel="prefetch" href="/noteSite/assets/js/61.d9896d98.js"><link rel="prefetch" href="/noteSite/assets/js/62.562266b6.js"><link rel="prefetch" href="/noteSite/assets/js/63.4651fe81.js"><link rel="prefetch" href="/noteSite/assets/js/64.685643f2.js"><link rel="prefetch" href="/noteSite/assets/js/65.445b3f90.js"><link rel="prefetch" href="/noteSite/assets/js/66.47ce1cb5.js"><link rel="prefetch" href="/noteSite/assets/js/67.d7cffd02.js"><link rel="prefetch" href="/noteSite/assets/js/68.940725b6.js"><link rel="prefetch" href="/noteSite/assets/js/69.870cf33a.js"><link rel="prefetch" href="/noteSite/assets/js/7.db572721.js"><link rel="prefetch" href="/noteSite/assets/js/70.d485e582.js"><link rel="prefetch" href="/noteSite/assets/js/71.69a8329a.js"><link rel="prefetch" href="/noteSite/assets/js/72.2e361b25.js"><link rel="prefetch" href="/noteSite/assets/js/73.147b232f.js"><link rel="prefetch" href="/noteSite/assets/js/74.60f5d21f.js"><link rel="prefetch" href="/noteSite/assets/js/75.eefa0a9c.js"><link rel="prefetch" href="/noteSite/assets/js/76.07dcfa69.js"><link rel="prefetch" href="/noteSite/assets/js/77.6252b11a.js"><link rel="prefetch" href="/noteSite/assets/js/78.d2ea2b75.js"><link rel="prefetch" href="/noteSite/assets/js/79.fe1c26df.js"><link rel="prefetch" href="/noteSite/assets/js/8.976ce270.js"><link rel="prefetch" href="/noteSite/assets/js/80.df5ed501.js"><link rel="prefetch" href="/noteSite/assets/js/81.fc934844.js"><link rel="prefetch" href="/noteSite/assets/js/82.d8c99980.js"><link rel="prefetch" href="/noteSite/assets/js/83.ada2c964.js"><link rel="prefetch" href="/noteSite/assets/js/84.e35c7e71.js"><link rel="prefetch" href="/noteSite/assets/js/85.36a1371e.js"><link rel="prefetch" href="/noteSite/assets/js/86.babee194.js"><link rel="prefetch" href="/noteSite/assets/js/87.004cd9a2.js"><link rel="prefetch" href="/noteSite/assets/js/88.e40df72b.js"><link rel="prefetch" href="/noteSite/assets/js/89.0bb511ab.js"><link rel="prefetch" href="/noteSite/assets/js/9.45d0682d.js"><link rel="prefetch" href="/noteSite/assets/js/90.8e90d077.js"><link rel="prefetch" href="/noteSite/assets/js/91.d7d74997.js"><link rel="prefetch" href="/noteSite/assets/js/92.8c5081db.js"><link rel="prefetch" href="/noteSite/assets/js/93.dccfa9f0.js"><link rel="prefetch" href="/noteSite/assets/js/94.daf40c65.js"><link rel="prefetch" href="/noteSite/assets/js/95.b2d3b27a.js"><link rel="prefetch" href="/noteSite/assets/js/96.3b03678b.js"><link rel="prefetch" href="/noteSite/assets/js/97.d4d392a2.js"><link rel="prefetch" href="/noteSite/assets/js/98.8440c347.js"><link rel="prefetch" href="/noteSite/assets/js/99.df8ef012.js">
    <link rel="stylesheet" href="/noteSite/assets/css/0.styles.0f3b0cbd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/noteSite/" class="home-link router-link-active"><img src="/noteSite/images/hedon.png" alt="Hedon" class="logo"> <span class="site-name can-hide">Hedon</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/noteSite/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/noteSite/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CS Menu" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="CS Menu" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/noteSite/cs/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/os/" class="nav-link">
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/cn/" class="nav-link router-link-active">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/component/" class="nav-link">
  计算机组成原理
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Backend Menu" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="Backend Menu" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/noteSite/backend/java/" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/golang/" class="nav-link">
  Golang
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/middleware/" class="nav-link">
  中间件
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/distribute/" class="nav-link">
  分布式
</a></li></ul></div></div><div class="nav-item"><a href="/noteSite/frontend/" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/noteSite/linux/" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/noteSite/mac/" class="nav-link">
  Mac
</a></div><div class="nav-item"><a href="/noteSite/leetcode/" class="nav-link">
  Leetcode
</a></div><div class="nav-item"><a href="/noteSite/paper/" class="nav-link">
  Paper
</a></div><div class="nav-item"><a href="https://github.com/hedon954/noteSite" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/noteSite/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/noteSite/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CS Menu" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="CS Menu" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/noteSite/cs/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/os/" class="nav-link">
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/cn/" class="nav-link router-link-active">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/cs/component/" class="nav-link">
  计算机组成原理
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Backend Menu" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="Backend Menu" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/noteSite/backend/java/" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/golang/" class="nav-link">
  Golang
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/middleware/" class="nav-link">
  中间件
</a></li><li class="dropdown-item"><!----> <a href="/noteSite/backend/distribute/" class="nav-link">
  分布式
</a></li></ul></div></div><div class="nav-item"><a href="/noteSite/frontend/" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/noteSite/linux/" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/noteSite/mac/" class="nav-link">
  Mac
</a></div><div class="nav-item"><a href="/noteSite/leetcode/" class="nav-link">
  Leetcode
</a></div><div class="nav-item"><a href="/noteSite/paper/" class="nav-link">
  Paper
</a></div><div class="nav-item"><a href="https://github.com/hedon954/noteSite" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>计算机网络</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/noteSite/cs/cn/cn-total.html" class="sidebar-link">一、计算机网络模型</a></li><li><a href="/noteSite/cs/cn/cn-link-layer.html" class="sidebar-link">二、链路层</a></li><li><a href="/noteSite/cs/cn/cn-network-layer.html" class="sidebar-link">三、网络层</a></li><li><a href="/noteSite/cs/cn/cn-transfer-layer.html" class="sidebar-link">四、传输层</a></li><li><a href="/noteSite/cs/cn/cn-apply-layer.html" aria-current="page" class="active sidebar-link">五、应用层</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#_1-dns" class="sidebar-link">1. DNS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#域名" class="sidebar-link">域名</a></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#原理" class="sidebar-link">原理</a></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#查询方式" class="sidebar-link">查询方式</a></li></ul></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#_2-dhcp" class="sidebar-link">2. DHCP</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#简介-2" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#特点" class="sidebar-link">特点</a></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#分配" class="sidebar-link">分配</a></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#原理-2" class="sidebar-link">原理</a></li></ul></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#_3-http" class="sidebar-link">3. HTTP</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#简介-3" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#特点-2" class="sidebar-link">特点</a></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#请求结构" class="sidebar-link">请求结构</a></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#响应结构" class="sidebar-link">响应结构</a></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#状态码" class="sidebar-link">状态码</a></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#工作原理" class="sidebar-link">工作原理</a></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#请求方式" class="sidebar-link">请求方式</a></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#cookie" class="sidebar-link">Cookie</a></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#http1-0-与-http1-1-的区别" class="sidebar-link">HTTP1.0 与 HTTP1.1 的区别</a></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#http1-0-与-http2-0-的区别" class="sidebar-link">HTTP1.0 与 HTTP2.0 的区别</a></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#如何知道-http-发送的请求结束" class="sidebar-link">如何知道 HTTP 发送的请求结束</a></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#session" class="sidebar-link">Session</a></li></ul></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#_4-https" class="sidebar-link">4. HTTPS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#简介-6" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#ssl-tsl" class="sidebar-link">SSL/TSL</a></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#https-数据传输流程" class="sidebar-link">HTTPS 数据传输流程</a></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#https-加密具体分析" class="sidebar-link">HTTPS 加密具体分析</a></li></ul></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#_5-socket" class="sidebar-link">5. Socket</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#简介-7" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#tcp" class="sidebar-link">TCP</a></li><li class="sidebar-sub-header"><a href="/noteSite/cs/cn/cn-apply-layer.html#udp" class="sidebar-link">UDP</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>面试题</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="五、应用层"><a href="#五、应用层" class="header-anchor">#</a> 五、应用层</h1> <h2 id="_1-dns"><a href="#_1-dns" class="header-anchor">#</a> 1. DNS</h2> <h3 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h3> <p>DNS（Domain Name System，域名系统）是用于将域名转为 IP 地址的协议。</p> <h3 id="域名"><a href="#域名" class="header-anchor">#</a> 域名</h3> <h4 id="顶级域"><a href="#顶级域" class="header-anchor">#</a> 顶级域</h4> <p>国家</p> <ul><li>cn：中国</li> <li>us：美国</li> <li>uk：英国</li> <li>ca：加拿大</li></ul> <p>通用：</p> <ul><li>com：商业机构</li> <li>net：网络服务机构</li> <li>gov：政府</li> <li>org：非营利性组织</li></ul> <h4 id="二级域"><a href="#二级域" class="header-anchor">#</a> 二级域</h4> <ul><li>aliyun</li> <li>taobao</li> <li>baidu</li> <li>google</li></ul> <h3 id="原理"><a href="#原理" class="header-anchor">#</a> 原理</h3> <blockquote><p>参考：https://zhuanlan.zhihu.com/p/79350395</p></blockquote> <img src="https://tva1.sinaimg.cn/large/008i3skNly1gt3mx01iwgj30u013rwh4.jpg" alt="img" style="zoom:50%;"> <ol><li>浏览器输入地址</li> <li>然后浏览器这个进程去调操作系统某个库里的 gethostbyname 函数(例如，Linux GNU glibc标准库的 gethostbyname 函数)</li> <li>然后这个函数通过网卡给 DNS 服务器发 UDP 请求</li> <li>接收结果</li> <li>然后将结果给返回给浏览器</li></ol> <p>特殊：</p> <ul><li>(1) 我们在用 Chrome 浏览器的时候，其实会先去浏览器的 DNS 缓存里头查询，DNS 缓存中没有，再去调用 gethostbyname 函数</li> <li>(2) gethostbyname 函数在试图进行 DNS 解析之前首先检查域名是否在本地 Hosts 里，如果没找到再去 DNS 服务器上查。</li></ul> <div class="custom-block tip"><p class="custom-block-title">UDP 在哪里使用？ TCP 在哪里使用？</p> <ol><li>gethostbyname 函数通过网卡发送请求给 DNS 服务器解析域名的时候使用 UDP。</li> <li>区域传送的时候使用 TCP
DNS 的规范规定了 2 种类型的 DNS 服务器，一个叫主 DNS 服务器，一个叫辅助 DNS 服务器（其实就是一份备份）。在一个区中主 DNS 服务器从自己本机的数据文件中读取该区的 DNS 数据信息，而辅助 DNS 服务器则从区的主 DNS 服务器中读取该区的 DNS 数据信息。当一个辅助 DNS 服务器启动时，它需要与主 DNS 服务器通信，并加载数据信息，这就叫做区传送（zone transfer）。 这种情况下，使用 TCP 协议。</li></ol> <h4 id="dns-在域名解析上是用-udp-还是-tcp"><a href="#dns-在域名解析上是用-udp-还是-tcp" class="header-anchor">#</a> DNS 在域名解析上是用 UDP 还是 TCP？</h4> <p>UDP。</p> <h4 id="域名解析为什么要用-udp"><a href="#域名解析为什么要用-udp" class="header-anchor">#</a> 域名解析为什么要用 UDP？</h4> <p>因为 UDP 快！UDP 的 DNS 协议只要一个请求、一个应答就好了。而使用基于 TCP 的 DNS 协议要三次握手、发送数据以及应答、四次挥手。但是 UDP 协议传输内容不能超过 512 字节。不过客户端向 DNS 服务器查询域名，一般返回的内容都不超过 512 字节，用 UDP 传输即可。</p> <h4 id="区域复制为什么要用-tcp"><a href="#区域复制为什么要用-tcp" class="header-anchor">#</a> 区域复制为什么要用 TCP？</h4> <p>因为 TCP 协议可靠性好！你要从区域的主 DNS 上复制内容，必须保证可靠性。同时 TCP 协议传输的内容大，UDP 最大只能传 512 字节，同步的数据很可能会大于 512 字节。</p> <h4 id="为什么-udp-最大只能传-512-字节"><a href="#为什么-udp-最大只能传-512-字节" class="header-anchor">#</a> 为什么 UDP 最大只能传 512 字节？</h4> <ul><li>纠正：UDP 最大不止传 512 字节。
以太网帧在局域网中的 MTU 是 1500byte，但是在非局域网环境，如：internet 下的时候，MTU 是各个路由器进行一个配置的。所以，通常路由器默认的 MTU 为576字节。所以，为了适应网络环境，DNS 协议在返回的数据报大于 512 的时候，就转化为了 TCP 协议。</li></ul> <h4 id="udp-的最大传输长度讨论"><a href="#udp-的最大传输长度讨论" class="header-anchor">#</a> UDP 的最大传输长度讨论</h4> <p>UDP 允许传输的最大长度理论上 2^16 - udp head - iphead（ 65507 字节 = 65535 - 20 - 8）</p> <p>但是实际上 UDP 数据报的数据区最大长度为1472（1500-20-8）字节，理由如下：</p> <ol><li><p>首先,我们知道,TCP/IP 通常被认为是一个四层协议系统，包括链路层、网络层、运输层和应用层。</p></li> <li><p>UDP 属于运输层,下面我们由下至上一步一步来看：<br>
以太网(Ethernet)数据帧的长度必须在 46-1500 字节之间,这是由以太网的物理特性决定的。这个 1500 字节被称为链路层的 MTU(最大传输单元)。
但这并不是指链路层的长度被限制在 1500 字节，其实这这个 MTU 指的是链路层的数据区。 并不包括链路层的首部和尾部的 18 个字节。 所以，事实上，这个 1500 字节就是网络层 IP 数据报的长度限制。 因为 IP 数据报的首部为 20 字节，所以 IP 数据报的数据区长度最大为 1480 字节。<br>
而这个 1480 字节就是用来放 TCP 传来的 TCP 报文段或 UDP 传来的 UDP 数据报的。 又因为 UDP 数据报的首部 8 字节，所以 UDP 数据报的数据区最大长度为 1472 字节。这个 1472 字节就是我们可以使用的字节数。</p></li> <li><p>进行 Internet 编程时则不同，因为 Internet 上的路由器可能会将 MTU 设为不同的值。<br>
如果我们假定 MTU 为 1500 来发送数据的，而途经的某个网络的 MTU 值小于 1500 字节，那么系统将会使用一系列的机制来调整 MTU 值，使数据报能够顺利到达目的地，这样就会做许多不必要的操作。鉴于 Internet 上的标准 MTU 值为 576 字节，建议在进行 Internet 的 UDP 编程时，最好将 UDP 的数据长度控件在 548 字节(576-8-20)以内。</p></li></ol></div> <h3 id="查询方式"><a href="#查询方式" class="header-anchor">#</a> 查询方式</h3> <h4 id="dns递归查询"><a href="#dns递归查询" class="header-anchor">#</a> DNS递归查询</h4> <img src="https://tva1.sinaimg.cn/large/008i3skNly1gt3mx4okh8j314c0p4abx.jpg" alt="image-20210402103254465" style="zoom:33%;"> <h4 id="dns迭代查询"><a href="#dns迭代查询" class="header-anchor">#</a> DNS迭代查询</h4> <img src="https://tva1.sinaimg.cn/large/008i3skNly1gt3mx4aq6lj315w0potba.jpg" alt="image-20210402103438687" style="zoom:33%;"> <h2 id="_2-dhcp"><a href="#_2-dhcp" class="header-anchor">#</a> 2. DHCP</h2> <h3 id="简介-2"><a href="#简介-2" class="header-anchor">#</a> 简介</h3> <p>DHCP（Dynamic Host Configuration Protocol，动态主机设置协议）通常被应用在大型的局域网络环境中，主要作用是集中的管理、分配 IP 地址，使网络环境中的主机动态的获得 IP 地址、Gateway 地址、DNS 服务器地址等信息，并能够提升地址的使用率。</p> <ul><li>即插即用联网</li></ul> <h3 id="特点"><a href="#特点" class="header-anchor">#</a> 特点</h3> <ul><li>DHCP 是一个局域网协议。</li> <li>DHCP 是应用 UDP 协议的应用层协议。</li></ul> <h3 id="分配"><a href="#分配" class="header-anchor">#</a> 分配</h3> <h4 id="自动分配方式"><a href="#自动分配方式" class="header-anchor">#</a> 自动分配方式</h4> <blockquote><p>DHCP 服务器为主机指定一个永久性的 IP 地址，一旦 DHCP 客户端第一次成功从 DHCP 服务器端租用到IP地址后，就可以永久性的使用该地址。</p></blockquote> <h4 id="动态分配方式"><a href="#动态分配方式" class="header-anchor">#</a> 动态分配方式</h4> <blockquote><p>DHCP 服务器给主机指定一个具有时间限制的IP地址，时间到期或主机明确表示放弃该地址时，该地址可以被其他主机使用。</p></blockquote> <h4 id="手工分配方式"><a href="#手工分配方式" class="header-anchor">#</a> 手工分配方式</h4> <blockquote><p>客户端的 IP 地址是由网络管理员指定的，DHCP 服务器只是将指定的 IP 地址告诉客户端主机。</p></blockquote> <h3 id="原理-2"><a href="#原理-2" class="header-anchor">#</a> 原理</h3> <p>DHCP 协议采用 UDP 作为传输协议，主机发送请求消息到 <code>DHCP 服务器的 67 号</code>端口，DHCP 服务器回应应答消息给<code>主机的 68 号</code>端口。详细的交互过程如下图：</p> <p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gt3mx0z52yj30dq087q3b.jpg" alt="img"></p> <p>1、DHCP Client 以广播的方式发出 <code>DHCP Discover</code> 报文。</p> <p>2、所有的 DHCP Server 都能够接收到 DHCP Client 发送的 DHCP Discover 报文，所有的 DHCP Server 都会给出响应，向 DHCP Client 发送一个 <code>DHCP Offer</code> 报文。</p> <blockquote><p>DHCP Offer 报文中 “Your(Client) IP Address” 字段就是 DHCP Server 能够提供给 DHCP Client 使用的IP地址，且 DHCP Server 会将自己的 IP 地址放在 “option” 字段中以便 DHCP Client 区分不同的 DHCP Server。DHCP Server 在发出此报文后会存在一个已分配IP地址的纪录。</p></blockquote> <p>3、DHCP Client 只能处理其中的一个 DHCP Offer 报文，一般的原则是 DHCP Client 处理<code>最先收到</code>的 DHCP Offer 报文。</p> <p>​	 DHCP Client 会发出一个广播的 <code>DHCP Request</code> 报文，在选项字段中会加入选中的 DHCP Server 的 IP 地址和需要的 IP 地址。</p> <p>4、DHCP Server 收到 DHCP Request 报文后，判断选项字段中的 IP 地址是否与自己的地址相同。</p> <ul><li>如果不相同，DHCP Server 不做任何处理只清除相应 IP 地址分配记录；</li> <li>如果相同，DHCP Server 就会向 DHCP Client 响应一个 <code>DHCP ACK</code> 报文，并在选项字段中增加 IP 地址的使用租期信息。</li></ul> <p>5、DHCP Client 接收到 DHCP ACK 报文后，检查 DHCP Server 分配的 IP 地址是否能够使用。</p> <ul><li>如果可以使用，则 DHCP Client 成功获得 IP 地址并根据 IP 地址使用租期自动启动续延过程；</li> <li>如果 DHCP Client 发现分配的 IP 地址已经被使用，则 DHCP Client 向 DHCPServer 发出 <code>DHCP Decline</code> 报文，通知 DHCP Server 禁用这个 IP 地址，然后 DHCP Client 开始新的地址申请过程。</li></ul> <p>6、DHCP Client 在成功获取 IP 地址后，随时可以通过发送 <code>DHCP Release</code> 报文释放自己的IP地址，DHCP Server 收到 DHCP Release 报文后，会回收相应的IP地址并重新分配。</p> <h2 id="_3-http"><a href="#_3-http" class="header-anchor">#</a> 3. HTTP</h2> <h3 id="简介-3"><a href="#简介-3" class="header-anchor">#</a> 简介</h3> <p>HTTP（Hypertext Transfer Protocol，超文本传输协议）是用于从万维网服务器传输超文本到本地浏览器的传送协议。</p> <h3 id="特点-2"><a href="#特点-2" class="header-anchor">#</a> 特点</h3> <ul><li><strong>简单快速</strong>：客户向服务器请求服务时，只需传送请求方法和路径。请求方法常用的有GET、HEAD、POST。每种方法规定了客户与服务器联系的类型不同。由于HTTP协议简单，使得HTTP服务器的程序规模小，因而通信速度很快。</li> <li><strong>灵活</strong>：HTTP允许传输任意类型的数据对象。正在传输的类型由 Content-Type 加以标记。</li> <li><strong>无连接</strong>：限制每次连接只处理一个请求。服务器处理完客户的请求，并收到客户的应答后，即断开连接。采用这种方式可以节省传输时间。</li> <li><strong>无状态</strong>：HTTP协议是无状态协议。无状态是指协议对于事务处理没有记忆能力。缺少状态意味着如果后续处理需要前面的信息，则它必须重传，这样可能导致每次连接传送的数据量增大。另一方面，在服务器不需要先前信息时它的应答就较快。</li> <li><strong>支持 B/S 及 C/S 模式</strong></li></ul> <div class="custom-block tip"><p class="custom-block-title">请简述 B/S 和 C/S 的区别？</p> <p>B/S 是浏览器/服务器的英文缩写，是一种通过浏览器访问服务器端数据的软件形式，其特点是用户不用在本地安装软件，只要有一个浏览器即可使用产品，而且用户不用关心软件的升级更新等问题。到由于受限于网络等因素，这种模式的系统访问速度较慢。</p> <p>C/S 则是客户端/服务器的英文缩写，这类软件的使用者需要在本地电脑安装客户端程序，就像 QQ。其特点就是访问速度快，界面优雅。但一旦软件有更新，用户需要手动下载，较为不便。而且在没有安装客户端的电脑上，用户无法使用系统。</p> <ol><li><p>硬件环境不同</p> <p>C/S 一般建立在小范围里的网络环境，局域网之间在通过专门服务器提供链接和数据交换服务。
B/S 建立在广域网之上的，不必是专门的网络硬件环境，比如：电话上网，租用设备，信息自己管理有比 C/S 更强的适应范围，一般只要有操作系统和浏览器就行。</p></li> <li><p>对安全要求不同</p> <p>C/S 一般建立在抓用的网络上，小范围里的网络环境，局域网之间在通过专门服务器提供链接和数据交换服务。
B/S 建立在广域网之上的，不必是专门的网络硬件环境，比如：电话上网，租用设备，信息自己管理有比 C/S 更强的适应范围，一般只要有操作系统和浏览器就行</p></li></ol> <p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gt3mwzbf23j31ii0beabc.jpg" alt="image-20210323102219235"></p></div> <h3 id="请求结构"><a href="#请求结构" class="header-anchor">#</a> 请求结构</h3> <p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gt3mx3s5a2j30eg053t8u.jpg" alt="img"></p> <h3 id="响应结构"><a href="#响应结构" class="header-anchor">#</a> 响应结构</h3> <p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gt3mx3b1enj30hh087jrw.jpg" alt="这里写图片描述"></p> <h3 id="状态码"><a href="#状态码" class="header-anchor">#</a> 状态码</h3> <ul><li>1xx 消息——请求已被服务器接收，继续处理</li> <li>2xx 成功——请求已成功被服务器接收、理解、并接受</li> <li>3xx 重定向——需要后续操作才能完成这一请求</li> <li>4xx 请求错误——请求含有词法错误或者无法被执行</li> <li>5xx 服务器错误——服务器在处理某个正确请求时发生错误</li></ul> <p>常见状态码</p> <ul><li>200 OK：正常返回信息</li> <li>301：当前资源已经被删除了，重定向到另外一个位置，后面还是需要重定向。</li> <li>302：当前资源暂时不可用，先重定向到另外一个位置，后面可能不需要重定向。</li> <li>400 Bad Request：客户端请求有语法错误，不能为服务器所理解</li> <li>401 Unauthorized：请求未经授权，这个状态码必须和 WWW-Authenticate 报头域一起使用（没认证）</li> <li>403 Forbidden：服务器收到请求，但是拒绝提供服务（认证了但是没权限）</li> <li>404 Not Found：请求资源不存在，一般是 URL 输错了</li> <li>500 Internal Server Error：服务器发生不可预期的错误</li> <li>503 Server Unavailable：服务器当前不能处理客户端的请求，一段时间后可能恢复正常</li></ul> <h3 id="工作原理"><a href="#工作原理" class="header-anchor">#</a> 工作原理</h3> <p>HTTP 协议定义 Web 客户端如何从 Web 服务器请求 Web 页面，以及服务器如何把 Web 页面传送给客户端。HTTP 协议采用了<code>请求/响应</code>模型。客户端向服务器发送一个请求报文，请求报文包含请求的方法、URL、协议版本、请求头部和请求数据。服务器以一个状态行作为响应，响应的内容包括协议的版本、成功或者错误代码、服务器信息、响应头部和响应数据。</p> <p>以下是 HTTP 请求/响应的步骤：</p> <ol><li><p>客户端连接到 Web 服务器
一个 HTTP 客户端，通常是浏览器，与 Web 服务器的 HTTP 端口（默认为 80 ）建立一个 TCP 套接字连接。例如，<a href="http://www.baidu.com/" target="_blank" rel="noopener noreferrer">http://www.baidu.com<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p></li> <li><p>发送 HTTP 请求
通过 TCP 套接字，客户端向 Web 服务器发送一个文本的请求报文，一个请求报文由请求行、请求头部、空行和请求数据 4 部分组成。</p></li> <li><p>服务器接受请求并返回 HTTP 响应
Web 服务器解析请求，定位请求资源。服务器将资源复本写到 TCP 套接字，由客户端读取。一个响应由状态行、响应头部、空行和响应数据 4 部分组成。</p></li> <li><p>释放连接 TCP 连接
若 connection 模式为 close，则服务器主动关闭 TCP 连接，客户端被动关闭连接，释放 TCP 连接；</p> <p>若 connection 模式为 keepalive，则该连接会保持一段时间，在该时间内可以继续接收请求;</p></li> <li><p>客户端浏览器解析 HTML 内容
客户端浏览器首先解析状态行，查看表明请求是否成功的状态代码。然后解析每一个响应头，响应头告知以下为若干字节的 HTML 文档和文档的字符集。客户端浏览器读取响应数据 HTML，根据 HTML 的语法对其进行格式化，并在浏览器窗口中显示。</p></li></ol> <div class="custom-block tip"><p class="custom-block-title">在浏览器地址栏键入URL，按下回车之后会经历以下流程：</p> <ol><li>浏览器向 DNS 服务器请求解析该 URL 中的域名所对应的 IP 地址;</li> <li>解析出 IP 地址后，根据该 IP 地址和默认端口 80，和服务器建立TCP连接;</li> <li>浏览器发出读取文件(URL 中域名后面部分对应的文件)的HTTP 请求，该请求报文作为 TCP 三次握手的第三个报文的数据发送给服务器;</li> <li>服务器对浏览器请求作出响应，并把对应的 html 文本发送给浏览器;</li> <li>释放 TCP 连接;</li> <li>浏览器将该 html 文本并显示内容;</li></ol></div> <h3 id="请求方式"><a href="#请求方式" class="header-anchor">#</a> 请求方式</h3> <ul><li>GET</li> <li>POST</li> <li>DELETE</li> <li>PUT</li> <li>BATCH</li></ul> <div class="custom-block tip"><p class="custom-block-title">GET 请求和 POST 请求的区别：</p> <ol><li>HTTP 报文层面：GET 将请求信息放在 URL， POST 放在报文体中。</li> <li>数据库层面：GET 符合幂等性和安全性（GET 是做查询操作），POST 不符合（POST 是修改）。</li> <li>其他层面：GET 可以被缓存、被存储，而 POST 不行。</li> <li>数据长度方面：GET 因为请求信息放在 URL，URL 具有长度限制，所以 GET 请求长度有限，而 POST 没有限制。</li> <li>GET 产生一个 TCP 数据包；POST 产生两个 TCP 数据包
对于 GET 方式的请求，浏览器会把 http header 和 data 一并发送出去，服务器响应 200（返回数据）；
而对于 POST，浏览器先发送 header，服务器响应 100 continue，浏览器再发送 data，服务器响应 200 ok（返回数据）。</li> <li>安全性方面：GET 安全性非常低，POST 安全性较高。 但是如果没有加密，他们安全级别都是一样的，随便一个监听器都可以把所有的数据监听到。</li></ol></div> <h3 id="cookie"><a href="#cookie" class="header-anchor">#</a> Cookie</h3> <h4 id="简介-4"><a href="#简介-4" class="header-anchor">#</a> 简介</h4> <p>Cookie 是由服务器发送给客户端的特殊信息，以文本的形式存放在客户端。</p> <p>客户端再次请求时，会把  Cookie 回发。</p> <p>服务器接收到后，会解析 Cookie 生成与客户端相对应的内容。</p> <h4 id="cookie-的设置以及发送过程"><a href="#cookie-的设置以及发送过程" class="header-anchor">#</a> Cookie 的设置以及发送过程</h4> <img src="https://tva1.sinaimg.cn/large/008i3skNly1gt3mx0hl42j30z40hq755.jpg" alt="image-20210111011025310" style="zoom:50%;"> <div class="custom-block tip"><p class="custom-block-title">cookie 和 session 的区别？</p> <ol><li>cookie 数据存放在客户的浏览器上，session 数据放在服务器上；</li> <li>cookie 不是很安全，别人可以分析存放在本地的 cookie 并进行 cookie 欺骗，如果主要考虑到安全应当使用 session；</li> <li>session 会在一定时间内保存在服务器上。当访问增多，会比较占用你服务器的性能，如果主要考虑到减轻服务器性能方面，应当使用 cookie；</li> <li>单个 cookie 在客户端的限制是 3K，就是说一个站点在客户端存放的 cookie 不能 3K；而 session 则存储与服务端，浏览器对其没有限制。所以将登陆信息等重要信息存放为 session；其他信息如果需要保留可以放在 cookie 中。</li></ol></div> <div class="custom-block tip"><p class="custom-block-title">cookie、session 和 token 的区别？</p> <p>session 和 oauth token并不矛盾，作为身份认证  token 安全性比 session 好，因为每个请求都有签名还能防止监听以及重放攻击，而session 就必须靠链路层来保障通讯安全了。</p> <p>如果你需要实现有状态的会话，仍然可以增加 session 来在服务器端保存一些状态</p> <p>App 通常用 RESTful api 跟 server 打交道。REST 是 stateless 的，也就是 App 不需要像 browser 那样用 cookie 来保存 session。因此用session token 来标示自己就够了，session/state 由 api server 的逻辑处理。 如果你的后端不是 stateless 的 rest api, 那么你可能需要在app 里保存session。可以在app里嵌入 webkit，用一个隐藏的 browser 来管理 cookie session。</p> <p>Session 是一种 HTTP 存储机制，目的是为无状态的 HTTP 提供的持久机制。所谓 Session 认证只是简单的把 User 信息存储到 Session 里，因为 SID 的不可预测性，暂且认为是安全的。这是一种认证手段。</p> <p>而 Token ，如果指的是 OAuth Token 或类似的机制的话，提供的是<strong>认证</strong>和<strong>授权</strong> ，认证是针对用户，授权是针对 App 。其目的是让某 App 有权利访问某用的信息。这里的 Token 是唯一的。不可以转移到其它 App上，也不可以转到其它用户上。</p> <p>转过来说 Session 。Session 只提供一种简单的认证，即有此 SID，即认为有此 User 的全部权利。是需要严格保密的，这个数据应该只保存在站方，不应该共享给其它网站或者第三方 App。</p> <p>所以简单来说，如果你的用户数据可能需要和第三方共享，或者允许第三方调用 API 接口，用 Token 。如果永远只是自己的网站，自己的 App，用什么就无所谓了。</p> <p>Token 就是令牌，比如你授权（登录）一个程序时，他就是个依据，判断你是否已经授权该软件；Cookie 就是写在客户端的一个 txt 文件，里面包括你登录信息之类的，这样你下次在登录某个网站，就会自动调用 cookie 自动登录用户名；session 和 cookie差不多，只是session 是写在服务器端的文件，也需要在客户端写入 cookie 文件，但是文件里是你的浏览器编号。Session的状态是存储在服务器端，客户端只有 session id；而 Token 的状态是存储在客户端。</p> <div class="language-markdown extra-class"><pre class="language-markdown"><code><span class="token title important"><span class="token punctuation">#</span> 简单点说</span>
Cookie 和 Token 都是放在客户端的，Cookie 只是一种存储信息的东西，而 Token 是可以定制化的存储用户的信息，协助 OAuth2 进行认证和授权等操作。
Session 是放在服务器端的，它可以保存服务器的一些状态。
事实上我们使用 Token 来实现认证授权功能的时候一般是将 token 存放在 cookie，或者将 token 存放在 session。
</code></pre></div></div> <h3 id="http1-0-与-http1-1-的区别"><a href="#http1-0-与-http1-1-的区别" class="header-anchor">#</a> HTTP1.0 与 HTTP1.1 的区别</h3> <p><strong>① 持久与非持久</strong></p> <p>HTTP 1.0 规定浏览器与服务器只保持短暂的连接，浏览器的每次请求都需要与服务器建立一个 TCP 连接，服务器完成请求处理后立即断开 TCP 连接，服务器不跟踪每个客户也不记录过去的请求。</p> <p>HTTP 1.1 则支持持久连接 Persistent Connection, 并且默认使用 persistent connection。在同一个 TCP 的连接中可以传送多个 HTTP 请求和响应。多个请求和响应可以重叠，多个请求和响应可以同时进行。</p> <p>（但服务器端必须按照接收到客户端请求的先后顺序依次回送响应结果，以保证客户端能够区分出每次请求的响应内容。</p> <p><strong>② HTTP 1.1 增加 host 字段</strong></p> <p>在 HTTP1.0 中认为每台服务器都绑定一个唯一的 IP 地址，因此，请求消息中的 URL 并没有传递主机名（hostname）。但随着虚拟主机技术的发展，在一台物理服务器上可以存在多个虚拟主机（Multi-homed Web Servers），并且它们共享一个 IP 地址。</p> <p>HTTP1.1 的请求消息和响应消息都应支持 Host 头域，且请求消息中如果没有 Host 头域会报告一个错误（400 Bad Request）。此外，服务器应该接受以绝对路径标记的资源请求。</p> <h3 id="http1-0-与-http2-0-的区别"><a href="#http1-0-与-http2-0-的区别" class="header-anchor">#</a> HTTP1.0 与 HTTP2.0 的区别</h3> <p>① 相比于 HTTP/1.X 的文本（字符串）传送， HTTP/2.0 采用二进制传送。客户端和服务器传输数据时把数据分成帧，帧组成了数据流，流具有流 ID 标识和优先级，通过优先级以及流依赖能够一定程度上解决关键请求被阻塞的问题。</p> <p>② HTTP/2.0 支持多路复用。因为流 ID 的存在， 通过同一个 HTTP 请求可以实现多个 HTTP 请求传输，客户端和服务器可以通过流 ID 来标识究竟是哪个流从而定位到是哪个 HTTP 请求。</p> <p>③ HTTP/2.0 头部压缩。HTTP/2.0 通过 gzip 和 compress 压缩头部然后再发送，同时通信双方会维护一张头信息表，所有字段都记录在这张表中，在每次 HTTP 传输时只需要传头字段在表中的索引即可，大大减小了重传次数和数据量。</p> <p>④ HTTP/2.0 支持服务器推送。 服务器在客户端未经请求许可的情况下，可预先向客户端推送需要的内容，客户端在退出服务时可通过发送复位相关的请求来取消服务端的推送。</p> <h3 id="如何知道-http-发送的请求结束"><a href="#如何知道-http-发送的请求结束" class="header-anchor">#</a> 如何知道 HTTP 发送的请求结束</h3> <p>① 如果是短连接，没有启用 keepalive，则可以通过是否关闭了连接来判断是否传输结束，即在读取时可判断 read() != -1。</p> <p>② 如果是长连接的话，先把 header 直到 <code>\r\n\r\n</code> 整个地收下来。</p> <p>然后看 Content-length 是否有，如果有了，那就读取 Content-length 长度的字节数据，读完就结束了。</p> <p>如果没有 Content-length，那么 x 类型为Transfer-Encoding: chunked 说明响应数据的长度不固定，就读到 <code>\r\n0\r\n</code> 表示结束。</p> <p>补充：<strong>头结束符定义</strong></p> <p>包含这 <code>&quot;\r\n\r\n&quot;</code> 四个字节是指头结束</p> <ul><li>如果头数据里包含Content-Length: x 就读取x字节数据，知道http响应数据的长度为x</li> <li>如果头数据里不包含Content-Length: x 类型为 Transfer-Encoding: chunked 说明响应数据的长度不固定，结束符以 <code>&quot;\r\n0\r\n&quot;</code> 这 5 个字节为结束符。</li></ul> <h3 id="session"><a href="#session" class="header-anchor">#</a> Session</h3> <h4 id="简介-5"><a href="#简介-5" class="header-anchor">#</a> 简介</h4> <p>Session 是服务器端的机制，在服务器上保存的信息。</p> <p>解析客户端请求并操作 session id，按需保存状态信息。</p> <h4 id="实现"><a href="#实现" class="header-anchor">#</a> 实现</h4> <ul><li>使用 Cookie 来实现</li> <li>使用 URL 回写来实现</li></ul> <img src="https://tva1.sinaimg.cn/large/008i3skNly1gt3mx2t4dfj30za0cq0u2.jpg" alt="image-20210111011314265" style="zoom:50%;"> <h2 id="_4-https"><a href="#_4-https" class="header-anchor">#</a> 4. HTTPS</h2> <img src="https://tva1.sinaimg.cn/large/008i3skNly1gt3mx588pzj31by0ikgno.jpg" alt="image-20210111012026484" style="zoom:33%;"> <h3 id="简介-6"><a href="#简介-6" class="header-anchor">#</a> 简介</h3> <p>HTTPS （Hyper Text Transfer Protocol over SecureSocket Layer，超文本传输安全协议）是以安全为目标的 HTTP 通道，在HTTP的基础上通过传输加密和身份认证保证了传输过程的安全性。</p> <h3 id="ssl-tsl"><a href="#ssl-tsl" class="header-anchor">#</a> SSL/TSL</h3> <p>SSL（Security Sockets Layer，安全套接层）是为网络通信提供安全及数据完整性的一种安全协议。</p> <p>SSL 是操作系统对外的 API，SSL 3.0 后更名为 TSL。</p> <p>SSL 采用身份验证和数据加密保证网络通信的安全和数据的完整性。</p> <h3 id="https-数据传输流程"><a href="#https-数据传输流程" class="header-anchor">#</a> HTTPS 数据传输流程</h3> <ul><li>浏览器将支持的加密算法信息发送给服务器。</li> <li>服务器选择一套浏览器支持的加密算法，以证书的形式回发浏览器。</li> <li>浏览器验证证书合法性，并结合证书公钥加密信息发送给服务器。</li> <li>服务器使用私钥解密信息，验证哈希，加密响应信息回发浏览器。</li> <li>浏览器解密响应信息，并对消息进行验真，之后进行加密交互数据。</li></ul> <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvdpvbnghgj60wa0u077z02.jpg" alt="image-20210406113715688"></p> <p>①证书验证阶段</p> <ol><li>浏览器发起 HTTPS 请求</li> <li>服务端返回 HTTPS 证书</li> <li>客户端验证证书是否合法，如果不合法则提示告警</li></ol> <p>②数据传输阶段</p> <ol><li>当证书验证合法后，在本地生成随机数</li> <li>通过公钥加密随机数，并把加密后的随机数传输到服务端</li> <li>服务端通过私钥对随机数进行解密</li> <li>服务端通过客户端传入的随机数构造对称加密算法，对返回结果内容进行加密后传输</li></ol> <div class="custom-block tip"><p class="custom-block-title">为什么数据传输是用对称加密？</p> <p>首先，非对称加密的加解密效率是非常低的，而 HTTP 的应用场景中通常端与端之间存在大量的交互，非对称加密的效率是无法接受的；</p> <p>另外，在 HTTPS 的场景中只有服务端保存了私钥，一对公私钥只能实现单向的加解密，所以 HTTPS 中内容传输加密采取的是对称加密，而不是非对称加密。</p></div> <div class="custom-block tip"><p class="custom-block-title">HTTP 和 HTTPS 的区别</p> <ol><li>HTTPS 协议需要到 CA （Certificate Authority，证书颁发机构）申请证书，一般免费证书较少，因而需要一定费用。</li> <li>HTTP 是超文本传输协议，信息是明文传输，HTTPS 则是具有安全性的 SSL 加密传输协议。</li> <li>HTTP 和 HTTPS 使用的是完全不同的连接方式，用的端口也不一样，前者是80，后者是443。</li> <li>HTTP 的连接很简单，是无状态的。HTTPS 协议是由 SSL+HTTP 协议构建的可进行加密传输、身份认证的网络协议，比 HTTP 协议安全。(无状态的意思是其数据包的发送、传输和接收都是相互独立的。无连接的意思是指通信双方都不长久的维持对方的任何信息。)</li></ol></div> <h3 id="https-加密具体分析"><a href="#https-加密具体分析" class="header-anchor">#</a> HTTPS 加密具体分析</h3> <div class="custom-block tip"><p class="custom-block-title">总结</p> <ul><li><p>阶段一</p> <p>无加密：不可；</p></li> <li><p>阶段二</p> <p>对称加密：密钥泄露，数据全泄露；</p></li> <li><p>阶段三</p> <p>非对称加密：客户端 -&gt; 服务端安全解决，服务端 -&gt; 客户端安全没有解决；</p></li> <li><p>阶段四</p> <p>证书验证非对称，数据传输对称：公钥和随机数可能被窃取，key 暴露，数据不安全；</p></li> <li><p>阶段五</p> <p>CA 辅助：加密公钥，保证 key 不泄露，安全。</p></li></ul></div> <blockquote><p>参考：http://www.itcast.cn/news/20200729/1516328866.shtml</p></blockquote> <h4 id="不加密"><a href="#不加密" class="header-anchor">#</a> 不加密</h4> <p>有关于加密，我们首先来看一下不加密的情况，一般在计算机中，不加密我们成为'裸奔'。如果数据不加密，则很容易被黑客窃取到。如下图所示：</p> <img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvdpxfmjnmj60dj0d4dg002.jpg" alt="1594805804748_https01.jpg" style="zoom:50%;"> <h4 id="对称加密"><a href="#对称加密" class="header-anchor">#</a> 对称加密</h4> <p>所以针对这样的情况，我们应该在数据传输的过程中进行对应的加密，那么问题来了，我们应该选择哪种加密方式呢?我们知道:常见的加密方式有对称加密和非对称加密之分，例如我们这里选择<strong>对称加密</strong>的形式。则如下图所示：</p> <img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvdpxedfawj60iw0m1mxs02.jpg" alt="1594805818673_https02.jpg" style="zoom:50%;"> <p>我们可以把 data 数据，配合秘钥，进行 f() 函数运算，进而得到密文：XXX，再把 XXX 传递到服务器端，从而使数据的传输进行加密，但是这样也面临一些对应的问题，我们知道，对称加密的秘钥是由后端生成的，但是该<strong>秘钥往往只有一个</strong>，因为后端不可能为每一个人设置一个秘钥，否则后端存储的秘钥就太多了。既然秘钥只有一个，那么前端想要解密就需要获取该秘钥。这也就是不安全的地方了。因为黑客也可以伪装成良民(普通的客户端)，拿取到对应的秘钥，从而对获取的数据进行解密处理。所以对称加密的方式其实是不安全的。虽然进行了加密但是黑客可以很容易就进行解密。</p> <h4 id="非对称加密"><a href="#非对称加密" class="header-anchor">#</a> 非对称加密</h4> <p>对称加密这么不安全，那么非对称加密呢？是不是非常安全。接下来让我们一起来看一下:</p> <img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvdpxg420gj60iw0k8wfg02.jpg" alt="1594805843908_https03.jpg" style="zoom:50%;"> <p>从上图我们可以知道，使用非对称加密有两种加密方式：</p> <ul><li><code>公钥加密，私钥解密</code></li> <li><code>私钥加密，公钥解密</code></li></ul> <p>一开始服务端生成一对公私钥(pk，sk)。我们要想进行密文通讯，需要客户端获取对应的公钥(pk)。所以客户端会发送请求，请求公钥。客户端获取到 pk 后，会把数据放到 f() 方法中进行对应的加密，所用的秘钥就是刚刚获取的 pk。加密后得到的 XXX 就是密文。所以我们可以把数据传输给服务器端。</p> <p>这个时候，如果黑客截取了对应的 XXX 数据，黑客将没法获取对应的明文数据，因为他没有获取对应的私钥 (sk)。</p> <p>但是非对称加密的缺点来了：<strong>如果服务端想要给客户端传递数据</strong>，也需要加密该怎么办呢？如果使用私钥加密，把加密的字段 YYY 传输给客户端，看似没有问题，但是细细想一下，我们就会知道黑客也是可以充当良民从而获取公钥(pk)的。也就是说，只要是使用私钥(sk)加密的方法，黑客都可以对其进行解密。</p> <p><font color="red">所以：非对称加密解决了客户端-&gt;服务器数据的安全性，但是没有解决服务器-&gt;客户端的安全性。</font></p> <p>总结发现：单独使用对称加密，不安全，单独使用非对称加密，也不安全。那么应该怎么解决呢?</p> <h4 id="证书验证用非对称-数据传输用对称"><a href="#证书验证用非对称-数据传输用对称" class="header-anchor">#</a> 证书验证用非对称，数据传输用对称</h4> <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvdpxf3nrjj60iw0ghq3m02.jpg" alt="1594805870201_https04.jpg"></p> <p>通过上面的图片，我们知道，先通过请求，获取服务端的 pk，拿到之后，我们可以在客户端随机产生一个 key，然后通过 f(pk，key)=XXX 的方式，把 XXX 传输给服务端，这样服务端就可以通过私钥 (sk) 对 XXX 进行解密，从而得到 key。以后我们就可以通过 key，作为秘钥，进行对称加密了。</p> <p>这样的方式是非常棒的。通过这样的方式我们会觉得数据是非常安全的。</p> <p>但是真的安全吗?</p> <p>其实是不对的，如果我们设想一下。黑客如果从最开始就对我们的通讯进行了监听。那么我们获取公钥的过程也会被监听到。而我们知道，非对称加密的公钥(pk)，黑客也是可以获取的。<strong>所以一旦公钥泄露</strong>。key 就会泄露，key 泄露，则后面的全部对称加密都称不上是安全的。所以后面很安全，但是如何保证 pk 的传输也是安全的就至关重要了。</p> <h4 id="ca-辅助"><a href="#ca-辅助" class="header-anchor">#</a> CA 辅助</h4> <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvdpxgi9gpj60iw0dz75502.jpg" alt="1594805912331_https05.jpg"></p> <p><code>CA机构</code>是一种信用机构。主要靠信用赚钱，一般来说都是全球的大型机构。这类机构也会有自己的公钥(cpk)和私钥(csk)，可以使用 csk 对于 pk 公钥进行加密，从而得到证书，我们可以把证书传递给前端，让前端利用浏览器内部自带的公钥(cpk)对证书进行解密，如果解密成功，则可以获取到 pk，随后再利用 pk 对前端生成的 key 进行加密。重复之前的步骤。</p> <div class="custom-block tip"><p class="custom-block-title">为什么需要 CA 认证机构颁发证书？</p> <blockquote><p><code>CA</code>使用私钥对证书进行了数字签名，防止中间人进行篡改。</p></blockquote> <p>HTTP 协议被认为不安全是因为传输过程容易被监听者勾线监听、伪造服务器，而 HTTPS 协议主要解决的便是网络传输的安全性问题。</p> <p>首先我们假设不存在认证机构，任何人都可以制作证书，这带来的安全风险便是经典的“中间人攻击”问题。</p> <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvdpya36egj60u40cw75602.jpg" alt="img"></p> <p>如上图所以，过程原理如下：</p> <ul><li>1）本地请求被劫持（如 DNS 劫持等），所有请求均发送到中间人的服务器；</li> <li>2）中间人服务器返回中间人自己的证书；</li> <li>3）客户端创建随机数，通过中间人证书的公钥对随机数加密后传送给中间人，然后凭随机数构造对称加密对传输内容进行加密传输；</li> <li>4）中间人因为拥有客户端的随机数，可以通过对称加密算法进行内容解密；</li> <li>5）中间人以客户端的请求内容再向正规网站发起请求；</li> <li>6）因为中间人与服务器的通信过程是合法的，正规网站通过建立的安全通道返回加密后的数据；</li> <li>7）中间人凭借与正规网站建立的对称加密算法对内容进行解密；</li> <li>8）中间人通过与客户端建立的对称加密算法对正规内容返回的数据进行加密传输；</li> <li>9）客户端通过与中间人建立的对称加密算法对返回结果数据进行解密。</li></ul> <p>由于缺少对证书的验证，所以客户端虽然发起的是 HTTPS 请求，但客户端完全不知道自己的网络已被拦截，传输内容被中间人全部窃取。</p></div> <h2 id="_5-socket"><a href="#_5-socket" class="header-anchor">#</a> 5. Socket</h2> <h3 id="简介-7"><a href="#简介-7" class="header-anchor">#</a> 简介</h3> <p>Socket 是 BSD UNIX 的进程通信机制，通常也称作”套接字”，用于描述 IP 地址和端口，是一个通信链的句柄。Socket 可以理解为 TCP/IP 网络的 API，它定义了许多函数或例程，程序员可以用它们来开发 TCP/IP 网络上的应用程序。电脑上运行的应用程序通常通过”套接字”向网络发出请求或者应答网络请求。</p> <h3 id="tcp"><a href="#tcp" class="header-anchor">#</a> TCP</h3> <h4 id="应用1"><a href="#应用1" class="header-anchor">#</a> [应用1]</h4> <blockquote><p>服务网接收客户端发过来的信息。</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * 服务端
 */</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">server</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  
  <span class="token class-name">ServerSocket</span> ss <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token class-name">Socket</span> socket <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token class-name">InputStream</span> is <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token class-name">ByteArrayOutputStream</span> baos <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  
  <span class="token keyword">try</span><span class="token punctuation">{</span>
    	ss <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerSocket</span><span class="token punctuation">(</span><span class="token number">8899</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token comment">//获取连接</span>
  		socket <span class="token operator">=</span> ss<span class="token punctuation">.</span><span class="token function">accpet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token comment">//输入流</span>
  		is <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token comment">//ByteArrayOutputStream 可以不用考虑长度</span>
  		baos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    	<span class="token keyword">int</span> len<span class="token punctuation">;</span>
    	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>len <span class="token operator">=</span> is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        	baos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    	<span class="token comment">//输出</span>
    	<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>baos<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
  <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    	e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token keyword">finally</span><span class="token punctuation">{</span>
    	<span class="token keyword">if</span><span class="token punctuation">(</span>baos<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        	<span class="token keyword">try</span><span class="token punctuation">{</span>
            	baos<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            	e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    	<span class="token keyword">if</span><span class="token punctuation">(</span>is<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        	<span class="token keyword">try</span><span class="token punctuation">{</span>
            	is<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            	e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    	<span class="token keyword">if</span><span class="token punctuation">(</span>socket<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        	<span class="token keyword">try</span><span class="token punctuation">{</span>
            	socket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            	e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    	<span class="token keyword">if</span><span class="token punctuation">(</span>ss<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        	<span class="token keyword">try</span><span class="token punctuation">{</span>
             ss<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            	e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
	* 客户端
	*/</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">client</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  	<span class="token class-name">Socket</span> socket <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  	<span class="token class-name">OutputStream</span> os <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  	<span class="token keyword">try</span><span class="token punctuation">{</span>
      	<span class="token class-name">InetAddress</span> inet <span class="token operator">=</span> <span class="token class-name">InetAddress</span><span class="token punctuation">.</span><span class="token function">getByName</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  			socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Socket</span><span class="token punctuation">(</span>inet<span class="token punctuation">,</span><span class="token number">8899</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      	<span class="token comment">//获取输出流</span>
      	os <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      	os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;我是客户端mm&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
      	e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">finally</span><span class="token punctuation">{</span>
      	<span class="token comment">//关闭资源</span>
      	<span class="token keyword">if</span><span class="token punctuation">(</span>os<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          	<span class="token keyword">try</span><span class="token punctuation">{</span>
              	os<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
              	e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      	<span class="token keyword">if</span><span class="token punctuation">(</span>socket<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          	<span class="token keyword">try</span><span class="token punctuation">{</span>
              	socket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
              	e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="应用2"><a href="#应用2" class="header-anchor">#</a> [应用2]</h4> <blockquote><p>客户端发送文件给服务端，服务端保存文件到本地。</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token comment">/**
     * 服务端
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">server</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

        <span class="token class-name">ServerSocket</span> ss <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">Socket</span> socket <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">InputStream</span> is <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">FileOutputStream</span> fos <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span><span class="token punctuation">{</span>
          	<span class="token comment">//1. 建立服务端 socket</span>
            ss <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerSocket</span><span class="token punctuation">(</span><span class="token number">8899</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          	<span class="token comment">//2. 监听客户端 socket</span>
            socket <span class="token operator">=</span> ss<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          	<span class="token comment">//3. 获取输入流</span>
            is <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          	<span class="token comment">//4. 建立输出流</span>
            fos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;本地保存路径&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token comment">//5. 输出</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> len<span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>len<span class="token operator">=</span>is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                fos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{</span>
          	<span class="token comment">//6. 关闭资源</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>fos<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    fos<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>is<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    is<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>socket<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    socket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ss<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    ss<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code>		<span class="token comment">/**
     * 客户端
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">client</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Socket</span> socket <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">OutputStream</span> os <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">FileInputStream</span> fis <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">InetAddress</span> inet <span class="token operator">=</span> <span class="token class-name">InetAddress</span><span class="token punctuation">.</span><span class="token function">getByName</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          	<span class="token comment">//1. 建立socket，连接服务器的8899端口</span>
            socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Socket</span><span class="token punctuation">(</span>inet<span class="token punctuation">,</span><span class="token number">8899</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          	<span class="token comment">//2. 获取输出流</span>
            os <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          	<span class="token comment">//3. 建立输入流</span>
            fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;要发送的文件路径&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          	<span class="token comment">//4. 输入数据并发送出去</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> len<span class="token punctuation">;</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>len <span class="token operator">=</span> fis<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{</span>
          	<span class="token comment">//5. 关闭资源</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>fis<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">try</span><span class="token punctuation">{</span>
                    fis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>os<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">try</span><span class="token punctuation">{</span>
                    os<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>socket<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    socket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><h4 id="应用3"><a href="#应用3" class="header-anchor">#</a> [应用3]</h4> <blockquote><p>从客户端发送文件给服务端，服务端保存到本地，并返回“发送成功”给客户端，并关闭相应的连接。</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code>		<span class="token comment">/**
     * 服务端
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">server</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

        <span class="token class-name">ServerSocket</span> ss <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">Socket</span> socket <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">InputStream</span> is <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">FileOutputStream</span> fos <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">OutputStream</span> os <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">//1. 建立服务端 socket</span>
            ss <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerSocket</span><span class="token punctuation">(</span><span class="token number">9090</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//2. 监听客户端 socket</span>
            socket <span class="token operator">=</span> ss<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//3. 获取输入流</span>
            is <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//4. 建立输出流</span>
            fos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;receiveFile.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//5. 保存文件</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> len<span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>len<span class="token operator">=</span>is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                fos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">//6. 回复信息</span>
            os <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;收到文件!&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>os<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    os<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>fos<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    fos<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>is<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    is<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>socket<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    socket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ss<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    ss<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code>		<span class="token comment">/**
     * 客户端
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">client</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

        <span class="token class-name">Socket</span> socket <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">OutputStream</span> os <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">FileInputStream</span> fis <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">InputStream</span> is <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">ByteArrayOutputStream</span> baos <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">//1. 建立 socket</span>
            <span class="token class-name">InetAddress</span> inet <span class="token operator">=</span> <span class="token class-name">InetAddress</span><span class="token punctuation">.</span><span class="token function">getByName</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Socket</span><span class="token punctuation">(</span>inet<span class="token punctuation">,</span><span class="token number">9090</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//2. 建立输出流</span>
            os <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//3. 建立输入流，输入文件</span>
            fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;/Users/hedon-/Downloads/IMG_0058.JPG&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//4. 传输文件</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> len<span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>len<span class="token operator">=</span>fis<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">//5. 表明文件传输完成（服务端是一个read操作，会阻塞，需要明确说明已经传输完成）</span>
            socket<span class="token punctuation">.</span><span class="token function">shutdownOutput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//6. 接收服务端反馈</span>
            is <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            baos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buffer2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>len <span class="token operator">=</span> is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buffer2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                baos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>baos<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>baos<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    baos<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>is<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    is<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>fis<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    fis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>os<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    os<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>socket<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    socket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><h3 id="udp"><a href="#udp" class="header-anchor">#</a> UDP</h3> <div class="language-java extra-class"><pre class="language-java"><code>		<span class="token comment">/**
     * 发送端
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">//1. socket 对象</span>
        <span class="token class-name">DatagramSocket</span> socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DatagramSocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2. 数据包</span>
        <span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token string">&quot;我是UDP方式发送的导弹~&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">InetAddress</span> inet <span class="token operator">=</span> <span class="token class-name">InetAddress</span><span class="token punctuation">.</span><span class="token function">getByName</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">DatagramPacket</span> packet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DatagramPacket</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>data<span class="token punctuation">.</span>length<span class="token punctuation">,</span>inet<span class="token punctuation">,</span><span class="token number">9090</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//3. 发送数据报</span>
        socket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>packet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//4. 关闭资源</span>
        socket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code>		<span class="token comment">/**
     * 接收端
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receiver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">{</span>
        <span class="token comment">//1. socket 对象，需要指定监听的端口号</span>
        <span class="token class-name">DatagramSocket</span> socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DatagramSocket</span><span class="token punctuation">(</span><span class="token number">9090</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2. 接收数据</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name">DatagramPacket</span> packet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DatagramPacket</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>buffer<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
        socket<span class="token punctuation">.</span><span class="token function">receive</span><span class="token punctuation">(</span>packet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//3. 打印数据</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>packet<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>packet<span class="token punctuation">.</span><span class="token function">getLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//4. 关闭 socket</span>
        socket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><!----></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">10/13/2021, 3:48:35 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/noteSite/cs/cn/cn-transfer-layer.html" class="prev">
        四、传输层
      </a></span> <span class="next"><a href="/noteSite/cs/cn/interview/net.html">
        面试题丨网络层
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/noteSite/assets/js/app.dbdfff04.js" defer></script><script src="/noteSite/assets/js/2.6ff1f0ac.js" defer></script><script src="/noteSite/assets/js/187.27815247.js" defer></script>
  </body>
</html>
